<wxs module="utils">
module.exports.includes = function(arr, item) {
  return arr && arr.indexOf(item) > -1;
}
</wxs>


<view class="container data-v-6c9a4f44">
    <view class="{{['content', 'data-v-6c9a4f44', aw && 'bg-black']}}">
    
    <!-- FAST MODE RESULT (Rewritten Standard Implementation) -->
    <view wx:if="{{QUICK_RESULT}}" class="stage-container bg-gray data-v-6c9a4f44">
        <!-- Header Actions -->
         <view class="nav-bar-custom data-v-6c9a4f44" style="padding: 24rpx; background: #fff; display: flex; justify-content: flex-end;">
            <!-- Actions if needed -->
        </view>
        
        <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44" style="padding: 32rpx; padding-bottom: 220rpx; flex-direction: column;">
            <view class="result-card data-v-6c9a4f44" style="background: #fff; padding: 32rpx; border-radius: 24rpx; margin-bottom: 24rpx; box-shadow: 0 4rpx 16rpx rgba(0,0,0,0.08);">
                <view class="card-header data-v-6c9a4f44" style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 24rpx;">
                    <view style="display:flex; flex-direction:column;">
                        <text class="student-name data-v-6c9a4f44" style="font-size: 36rpx; font-weight: 700; color: #111827;">{{singleName || '识别结果'}}</text>
                        <text wx:if="{{singlePerf}}" style="font-size: 24rpx; color: #059669; margin-top: 8rpx;">{{singlePerf}}</text>
                    </view>
                    <view class="actions data-v-6c9a4f44" style="display: flex; gap: 32rpx;">
                        <view class="icon-wrap data-v-6c9a4f44" bindtap="copySingleResult" style="padding: 16rpx;">
                            <text class="uni-icon uni-icon-paperclip data-v-6c9a4f44" style="font-size: 40rpx; color: #9ca3af;">📋</text>
                        </view>
                    </view>
                </view>
                <text class="card-body data-v-6c9a4f44" style="font-size: 28rpx; color: #4b5563; line-height: 1.6; display: block; white-space: pre-wrap;" user-select>{{singleResult || '生成内容为空 (Debug: Check Storage/Params)'}}</text>
                <view style="margin-top:20rpx; padding:10rpx; background:#eee; font-size:20rpx; color:#999;" wx:if="{{!singleResult}}">
                    Debug Info: name={{singleName}} perf={{singlePerf}} resLen={{singleResult.length}}
                </view>
            </view>
        </scroll-view>
        
        <view class="fixed-footer row data-v-6c9a4f44" style="padding: 24rpx; background: #fff;">
            <button class="btn-primary flex-1 data-v-6c9a4f44" bindtap="initStage" style="background: #22c55e; color: #fff; border-radius: 16rpx; border: 0;">完成 / 返回</button>
        </view>
    </view>


<view wx:if="{{REPORT_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">行政报告起草</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #059669; margin-top: 8rpx; display: block;">数据驱动 | 工作亮点 | 规范表达</text>
        </view>
        <text class="section-title data-v-6c9a4f44" style="color: #059669;">✍️ 任务信息</text>
        
        <view class="form-group data-v-6c9a4f44">
             <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">报告主题</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 2024年度德育工作总结" value="{{rep_subject}}" bindinput="{{rep_onSubject}}"/>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             
             <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">报告时间范围</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 2024年1月-12月" value="{{rep_time}}" bindinput="{{rep_onTime}}"/>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">上级关注重点</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 师德师风建设成效" value="{{rep_focus}}" bindinput="{{rep_onFocus}}"/>
            </view>

             <text class="label data-v-6c9a4f44" style="margin-top: 32rpx; display: block; font-weight: 600;">核心数据 (至少填3项):</text>
             
             <view class="row-2 data-v-6c9a4f44" style="margin-top: 16rpx;">
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">- 活动场次</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 培训15场" value="{{rep_sessions}}" bindinput="{{rep_onSessions}}"/>
                </view>
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">- 覆盖人数</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 教师300人次" value="{{rep_people}}" bindinput="{{rep_onPeople}}"/>
                </view>
             </view>

             <view class="row-2 data-v-6c9a4f44" style="margin-top: 24rpx;">
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">- 完成进度</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 完成率100%" value="{{rep_progress}}" bindinput="{{rep_onProgress}}"/>
                </view>
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">- 成果产出</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 公开课5节" value="{{rep_output}}" bindinput="{{rep_onOutput}}"/>
                </view>
             </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">- 师生反响/典型案例</text>
                <input class="input data-v-6c9a4f44" placeholder="简述一个典型例子..." value="{{rep_feedback}}" bindinput="{{rep_onFeedback}}"/>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">- 其他</text>
                <input class="input data-v-6c9a4f44" placeholder="" value="{{rep_other}}" bindinput="{{rep_onOther}}"/>
            </view>

        </view>
        <view style="height: 120rpx;"></view>
    </scroll-view>
     <view class="fixed-footer data-v-6c9a4f44">
        <button class="btn-primary data-v-6c9a4f44" style="background-color: #059669;" bindtap="{{rep_generate}}">生成报告</button>
    </view>
</view><view wx:if="{{a}}" class="stage-container bg-white data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;"><text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">通用校本课程开发</text><text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #9ca3af; margin-top: 8rpx; display: block;">R-T-C-F 专业模型驱动</text></view><text class="section-title data-v-6c9a4f44">✍️ 填写课程关键信息</text><view class="form-group data-v-6c9a4f44"><view class="row-2 data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">学科名称</text><input class="input data-v-6c9a4f44" placeholder="如: 语文" value="{{b}}" bindinput="{{c}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">学校类型</text><input class="input data-v-6c9a4f44" placeholder="如: 县域高中" value="{{d}}" bindinput="{{e}}"/></view></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">课程主题</text><input class="input data-v-6c9a4f44" placeholder="如: 寻找家乡的非遗记忆" value="{{f}}" bindinput="{{g}}"/></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">C - 课程约束条件</text><view class="row-2 data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">课程对象</text><input class="input data-v-6c9a4f44" placeholder="如: 高一全体" value="{{h}}" bindinput="{{i}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">课程时长</text><input class="input data-v-6c9a4f44" placeholder="如: 18课时" value="{{j}}" bindinput="{{k}}"/></view></view><view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx"><text class="label data-v-6c9a4f44">地方特色 / 资源</text><input class="input data-v-6c9a4f44" placeholder="如: 本地有剪纸艺术、竹编手工艺" value="{{l}}" bindinput="{{m}}"/></view><view class="row-2 data-v-6c9a4f44" style="margin-top:20rpx"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">实践形式</text><input class="input data-v-6c9a4f44" placeholder="如: 动手制作" value="{{n}}" bindinput="{{o}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">预期成果</text><input class="input data-v-6c9a4f44" placeholder="如: 举办作品展" value="{{p}}" bindinput="{{q}}"/></view></view></view><view class="advanced-section data-v-6c9a4f44"><view class="toggle-btn data-v-6c9a4f44" bindtap="{{t}}"><text class="data-v-6c9a4f44" style="color: #16a34a;">{{r}}</text><text class="{{['data-v-6c9a4f44', 'arrow', s]}}" style="color: #16a34a;">▼</text></view><view wx:if="{{v}}" class="advanced-content fade-in data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">融合学科</text><input class="input data-v-6c9a4f44" placeholder="如: 历史 + 信息技术" value="{{w}}" bindinput="{{x}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">已有资源支持</text><input class="input data-v-6c9a4f44" placeholder="如: 只有普通教室，无网络" value="{{y}}" bindinput="{{z}}"/></view></view></view></view></scroll-view><view class="fixed-footer data-v-6c9a4f44"><button class="btn-primary data-v-6c9a4f44" bindtap="{{A}}" loading="{{C}}">开始生成课程方案</button></view></view><view wx:if="{{D}}" class="stage-container bg-gray data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="result-card data-v-6c9a4f44"><view class="result-header data-v-6c9a4f44"><view class="icon-box-green data-v-6c9a4f44"><text class="data-v-6c9a4f44">📖</text></view><view class="data-v-6c9a4f44"><text class="result-title data-v-6c9a4f44">{{E}}</text><text class="result-sub data-v-6c9a4f44">{{F}} · {{G}} · {{H}}</text></view></view><text class="result-body data-v-6c9a4f44">{{I}}</text></view><view class="check-card data-v-6c9a4f44"><view class="check-title data-v-6c9a4f44"><text class="data-v-6c9a4f44">✨</text> 可行性自查</view><view class="check-list data-v-6c9a4f44"><text class="check-item data-v-6c9a4f44">• 第一周必须包含“AI伦理与规范”内容</text><text class="check-item data-v-6c9a4f4f44">• 确认{{J}}的安全预案</text><text class="check-item data-v-6c9a4f44">• 检查基础版资源是否已到位</text></view></view></scroll-view><view class="fixed-footer row data-v-6c9a4f44"><button class="btn-outline flex-1 data-v-6c9a4f44" bindtap="{{K}}">修改需求</button><button class="btn-primary flex-2 data-v-6c9a4f44">复制全文</button></view></view><view wx:if="{{L}}" class="stage-container bg-white data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="prep-banner-green data-v-6c9a4f44"><view class="banner-content data-v-6c9a4f44"><text class="banner-title data-v-6c9a4f44">🌳 小树推荐你去网页版继续备课</text><text class="banner-desc data-v-6c9a4f44">网页版支持多文件上传、实时预览、Word 导出，适合完整备课流程</text><button class="btn-white-green data-v-6c9a4f44" bindtap="{{M}}">💻 打开网页体验全流程 ➔</button></view></view><view class="section-box data-v-6c9a4f44"><text class="section-title-sm data-v-6c9a4f44">在小程序继续备课任务 (共4步)</text><text class="section-sub data-v-6c9a4f44">每一步都可单独完成，也可以按顺序完整备课</text></view><view class="step-list data-v-6c9a4f44"><view class="step-card data-v-6c9a4f44"><text class="step-num data-v-6c9a4f44">01</text><view class="step-info data-v-6c9a4f44"><text class="step-title data-v-6c9a4f44">教学内容剖析</text><text class="step-desc data-v-6c9a4f44">分析教材结构，提炼重点与难点</text></view><button class="btn-step-action data-v-6c9a4f44" bindtap="{{deepAnalysis}}">立即使用 ></button></view><view class="step-card data-v-6c9a4f44"><text class="step-num data-v-6c9a4f44">02</text><view class="step-info data-v-6c9a4f44"><text class="step-title data-v-6c9a4f44">教学目标与方法设计</text><text class="step-desc data-v-6c9a4f44">生成教学目标与教学活动方案</text></view><button class="btn-step-action data-v-6c9a4f44" bindtap="{{handleDesign}}">开始设计 ></button></view><view class="step-card data-v-6c9a4f44"><text class="step-num data-v-6c9a4f44">03</text><view class="step-info data-v-6c9a4f44"><text class="step-title data-v-6c9a4f44">课件制作美化</text><text class="step-desc data-v-6c9a4f44">快速生成美观课件和配色建议</text></view><button class="btn-step-action data-v-6c9a4f44" bindtap="{{handlePPT}}">一键美化 ></button></view><view class="step-card data-v-6c9a4f44"><text class="step-num data-v-6c9a4f44">04</text><view class="step-info data-v-6c9a4f44"><text class="step-title data-v-6c9a4f44">教案撰写与完善</text><text class="step-desc data-v-6c9a4f44">导出标准化教案文档</text></view><button class="btn-step-action data-v-6c9a4f44" bindtap="{{handleLessonPlan}}">生成教案 ></button></view></view></scroll-view></view>

<view wx:if="{{PPT_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">课件制作美化</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #059669; margin-top: 8rpx; display: block;">美学设计 | 内容结构化 | 创新亮点</text>
        </view>
        <text class="section-title data-v-6c9a4f44" style="color: #059669;">✍️ 任务信息</text>
        
        <view class="form-group data-v-6c9a4f44">
             <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">课题名称</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 函数的单调性" value="{{ppt_subject}}" bindinput="{{ppt_onSubject}}"/>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">C (约束)</text>
             <view class="row-2 data-v-6c9a4f44">
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">学科</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 高中数学" value="{{ppt_grade}}" bindinput="{{ppt_onGrade}}"/>
                </view>
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">页数</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 20页" value="{{ppt_pages}}" bindinput="{{ppt_onPages}}"/>
                </view>
             </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                 <text class="label data-v-6c9a4f44">教学内容</text>
                 <view class="analysis-card data-v-6c9a4f44" style="background: #f9fafb; border-radius: 16rpx; padding: 24rpx; border: 2rpx solid #f3f4f6;">
                    <view class="card-header data-v-6c9a4f44" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24rpx;">
                        <text class="card-title data-v-6c9a4f44" style="font-size: 28rpx; color: #374151; font-weight: 500;">本课主要内容</text>
                        <button class="btn-xs-outline data-v-6c9a4f44" style="color: #059669; border-color: #d1fae5; background: #fff; margin: 0; font-size: 24rpx; padding: 8rpx 24rpx; line-height: 1.5;" bindtap="{{ppt_viewHistory}}" data-field="ppt_content">🔍 查看历史结果</button>
                    </view>
                    <textarea class="textarea data-v-6c9a4f44" style="height: 200rpx; background: #fff; border-color: #e5e7eb; width: 100%; box-sizing: border-box; padding: 20rpx;" placeholder="简述主要内容，或从历史记录导入..." value="{{ppt_content}}" bindinput="{{ppt_onContent}}"/>
                 </view>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">设计要点</text>
            
            <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">封面/导入页设计思路</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 用生活中常见的波形图引入" value="{{ppt_cover}}" bindinput="{{ppt_onCover}}"/>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">重难点页面 (每页≤5个要点)</text>
                 <view class="analysis-card data-v-6c9a4f44" style="background: #f9fafb; border-radius: 16rpx; padding: 24rpx; border: 2rpx solid #f3f4f6;">
                    <view class="card-header data-v-6c9a4f44" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24rpx;">
                        <text class="card-title data-v-6c9a4f44" style="font-size: 28rpx; color: #374151; font-weight: 500;">重难点设计</text>
                        <button class="btn-xs-outline data-v-6c9a4f44" style="color: #059669; border-color: #d1fae5; background: #fff; margin: 0; font-size: 24rpx; padding: 8rpx 24rpx; line-height: 1.5;" bindtap="{{ppt_viewHistory}}" data-field="ppt_kp">🔍 查看历史结果</button>
                    </view>
                    <textarea class="textarea data-v-6c9a4f44" style="height: 160rpx; background: #fff; border-color: #e5e7eb; width: 100%; box-sizing: border-box; padding: 20rpx;" placeholder="描述重难点页面的布局或内容..." value="{{ppt_kp}}" bindinput="{{ppt_onKp}}"/>
                 </view>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">互动/练习环节</text>
                <input class="input data-v-6c9a4f44" placeholder="至多1个环节设计" value="{{ppt_int}}" bindinput="{{ppt_onInt}}"/>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">内容创新 (2-3个)</text>
            <view class="input-wrap data-v-6c9a4f44">
                <input class="input data-v-6c9a4f44" placeholder="创新点1: 如用类比法讲解抽象概念" value="{{ppt_inn1}}" bindinput="{{ppt_onInn1}}"/>
            </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 16rpx;">
                <input class="input data-v-6c9a4f44" placeholder="创新点2: 如用案例串联知识点" value="{{ppt_inn2}}" bindinput="{{ppt_onInn2}}"/>
            </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 16rpx;">
                <input class="input data-v-6c9a4f44" placeholder="创新点3 (可选)" value="{{ppt_inn3}}" bindinput="{{ppt_onInn3}}"/>
            </view>
        </view>
        
        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">呈现方式 (多媒体/板书)</text>
            <view class="pills-column data-v-6c9a4f44" style="display: flex; flex-direction: column; gap: 16rpx; margin-top: 16rpx;">
                <view class="pill-option data-v-6c9a4f44" bindtap="{{ppt_setPres}}" data-val="多媒体为主" style="padding: 24rpx; border-radius: 16rpx; font-size: 26rpx; border: 2rpx solid transparent; {{ppt_presMode=='多媒体为主' ? 'background: #ecfdf5; border-color: #059669; color: #047857;' : 'background: #f9fafb; color: #4b5563;'}}">
                    <text class="bold data-v-6c9a4f44">多媒体为主 + 板书辅助</text>
                </view>
                <view class="pill-option data-v-6c9a4f44" bindtap="{{ppt_setPres}}" data-val="板书为主" style="padding: 24rpx; border-radius: 16rpx; font-size: 26rpx; border: 2rpx solid transparent; {{ppt_presMode=='板书为主' ? 'background: #ecfdf5; border-color: #059669; color: #047857;' : 'background: #f9fafb; color: #4b5563;'}}">
                    <text class="bold data-v-6c9a4f44">板书为主 + 多媒体辅助</text>
                </view>
                 <view class="pill-option data-v-6c9a4f44" bindtap="{{ppt_setPres}}" data-val="纯板书" style="padding: 24rpx; border-radius: 16rpx; font-size: 26rpx; border: 2rpx solid transparent; {{ppt_presMode=='纯板书' ? 'background: #ecfdf5; border-color: #059669; color: #047857;' : 'background: #f9fafb; color: #4b5563;'}}">
                    <text class="bold data-v-6c9a4f44">纯板书设计</text>
                </view>
            </view>
        </view>

         <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">风格</text>
             <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; flex-wrap: wrap; margin-top: 16rpx;">
                <view class="pill-option data-v-6c9a4f44" bindtap="{{ppt_setStyle}}" data-val="简洁大方" style="padding: 16rpx 32rpx; border-radius: 99rpx; font-size: 26rpx; {{ppt_style=='简洁大方' ? 'background: #059669; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">简洁大方</view>
                <view class="pill-option data-v-6c9a4f44" bindtap="{{ppt_setStyle}}" data-val="活泼生动" style="padding: 16rpx 32rpx; border-radius: 99rpx; font-size: 26rpx; {{ppt_style=='活泼生动' ? 'background: #059669; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">活泼生动</view>
                <view class="pill-option data-v-6c9a4f44" bindtap="{{ppt_setStyle}}" data-val="学术严谨" style="padding: 16rpx 32rpx; border-radius: 99rpx; font-size: 26rpx; {{ppt_style=='学术严谨' ? 'background: #059669; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">学术严谨</view>
             </view>
        </view>

        <view style="height: 120rpx;"></view>
    </scroll-view>
     <view class="fixed-footer data-v-6c9a4f44">
        <button class="btn-primary data-v-6c9a4f44" style="background-color: #059669;" bindtap="{{ppt_generate}}">生成课件方案</button>
    </view>
</view><view wx:if="{{LESSON_PLAN_INPUT}}" class="stage-container bg-white data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;"><text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">教案撰写与完善</text><text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #059669; margin-top: 8rpx; display: block;">标准化格式 | 教学流程 | 课后反思</text></view><text class="section-title data-v-6c9a4f44" style="color: #059669;">✍️ 填写教案信息</text><view class="form-group data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">课题名称</text><input class="input data-v-6c9a4f44" placeholder="如: 函数的单调性" value="{{lp_subject}}" bindinput="{{lp_onSubject}}"/></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">C (约束)</text><view class="row-2 data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">年级班级</text><input class="input data-v-6c9a4f44" placeholder="如: 高一3班" value="{{lp_class}}" bindinput="{{lp_onClass}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">教学时长</text><input class="input data-v-6c9a4f44" placeholder="数字 (分钟)" value="{{lp_duration}}" bindinput="{{lp_onDuration}}"/></view></view><view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;"><text class="label data-v-6c9a4f44">教学设计要点</text><view class="analysis-card data-v-6c9a4f44" style="background: #f9fafb; border-radius: 16rpx; padding: 24rpx; border: 2rpx solid #f3f4f6;"><view class="card-header data-v-6c9a4f44" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24rpx;"><text class="card-title data-v-6c9a4f44" style="font-size: 28rpx; color: #374151; font-weight: 500;">简述本课重点和难点</text><button class="btn-xs-outline data-v-6c9a4f44" style="color: #059669; border-color: #d1fae5; background: #fff; margin: 0; font-size: 24rpx; padding: 8rpx 24rpx; line-height: 1.5;" bindtap="{{lp_viewHistory}}" data-field="lp_kp">🔍 查看历史结果</button></view><textarea class="textarea data-v-6c9a4f44" style="height: 160rpx; background: #fff; border-color: #e5e7eb; width: 100%; box-sizing: border-box; padding: 20rpx;" placeholder="描述教学重点、难点..." value="{{lp_kp}}" bindinput="{{lp_onKp}}"/></view></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">课型 (单选)</text><view class="pills-row data-v-6c9a4f44" style="display: flex; flex-wrap: wrap; gap: 16rpx; margin-top: 16rpx;"><view bindtap="{{lp_setType}}" data-val="新授课" class="pill-item {{lp_type=='新授课'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{lp_type=='新授课'?'#10b981':'#f3f4f6'}}; color: {{lp_type=='新授课'?'#fff':'#374151'}}; font-size: 26rpx;">新授课</view><view bindtap="{{lp_setType}}" data-val="复习课" class="pill-item {{lp_type=='复习课'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{lp_type=='复习课'?'#10b981':'#f3f4f6'}}; color: {{lp_type=='复习课'?'#fff':'#374151'}}; font-size: 26rpx;">复习课</view><view bindtap="{{lp_setType}}" data-val="练习课" class="pill-item {{lp_type=='练习课'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{lp_type=='练习课'?'#10b981':'#f3f4f6'}}; color: {{lp_type=='练习课'?'#fff':'#374151'}}; font-size: 26rpx;">练习课</view><view bindtap="{{lp_setType}}" data-val="实验课" class="pill-item {{lp_type=='实验课'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{lp_type=='实验课'?'#10b981':'#f3f4f6'}}; color: {{lp_type=='实验课'?'#fff':'#374151'}}; font-size: 26rpx;">实验课</view><view bindtap="{{lp_setType}}" data-val="活动课" class="pill-item {{lp_type=='活动课'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{lp_type=='活动课'?'#10b981':'#f3f4f6'}}; color: {{lp_type=='活动课'?'#fff':'#374151'}}; font-size: 26rpx;">活动课</view></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">教案格式 (单选)</text><view class="pills-row data-v-6c9a4f44" style="display: flex; flex-wrap: wrap; gap: 16rpx; margin-top: 16rpx;"><view bindtap="{{lp_setFormat}}" data-val="表格式" class="pill-item {{lp_format=='表格式'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{lp_format=='表格式'?'#10b981':'#f3f4f6'}}; color: {{lp_format=='表格式'?'#fff':'#374151'}}; font-size: 26rpx;">表格式</view><view bindtap="{{lp_setFormat}}" data-val="文本式" class="pill-item {{lp_format=='文本式'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{lp_format=='文本式'?'#10b981':'#f3f4f6'}}; color: {{lp_format=='文本式'?'#fff':'#374151'}}; font-size: 26rpx;">文本式</view></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">板书输出 (单选)</text><view class="pills-row data-v-6c9a4f44" style="display: flex; flex-wrap: wrap; gap: 16rpx; margin-top: 16rpx;"><view bindtap="{{lp_setBb}}" data-val="板书设计" class="pill-item {{lp_bb=='板书设计'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{lp_bb=='板书设计'?'#10b981':'#f3f4f6'}}; color: {{lp_bb=='板书设计'?'#fff':'#374151'}}; font-size: 26rpx;">板书设计</view><view bindtap="{{lp_setBb}}" data-val="思维导图" class="pill-item {{lp_bb=='思维导图'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{lp_bb=='思维导图'?'#10b981':'#f3f4f6'}}; color: {{lp_bb=='思维导图'?'#fff':'#374151'}}; font-size: 26rpx;">思维导图</view></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">作业类型 (单选)</text><view class="pills-row data-v-6c9a4f44" style="display: flex; flex-wrap: wrap; gap: 16rpx; margin-top: 16rpx;"><view bindtap="{{lp_setHw}}" data-val="作业布置" class="pill-item {{lp_hw=='作业布置'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{lp_hw=='作业布置'?'#10b981':'#f3f4f6'}}; color: {{lp_hw=='作业布置'?'#fff':'#374151'}}; font-size: 26rpx;">作业布置</view><view bindtap="{{lp_setHw}}" data-val="拓展活动" class="pill-item {{lp_hw=='拓展活动'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{lp_hw=='拓展活动'?'#10b981':'#f3f4f6'}}; color: {{lp_hw=='拓展活动'?'#fff':'#374151'}}; font-size: 26rpx;">拓展活动</view></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">语言风格 (单选)</text><view class="pills-row data-v-6c9a4f44" style="display: flex; flex-wrap: wrap; gap: 16rpx; margin-top: 16rpx;"><view bindtap="{{lp_setStyle}}" data-val="规范严谨" class="pill-item {{lp_style=='规范严谨'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{lp_style=='规范严谨'?'#10b981':'#f3f4f6'}}; color: {{lp_style=='规范严谨'?'#fff':'#374151'}}; font-size: 26rpx;">规范严谨</view><view bindtap="{{lp_setStyle}}" data-val="生动活泼" class="pill-item {{lp_style=='生动活泼'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{lp_style=='生动活泼'?'#10b981':'#f3f4f6'}}; color: {{lp_style=='生动活泼'?'#fff':'#374151'}}; font-size: 26rpx;">生动活泼</view></view></view><view style="height: 120rpx;"></view></scroll-view><view class="fixed-footer data-v-6c9a4f44"><button class="btn-primary data-v-6c9a4f44" style="background-color: #059669;" bindtap="{{lp_generate}}">生成教案文档</button></view></view><view wx:if="{{N}}" class="stage-container bg-white center-xy data-v-6c9a4f44"><view class="icon-circle-lg bounce data-v-6c9a4f44"><text class="icon-lg data-v-6c9a4f44">📋</text></view><text class="big-title data-v-6c9a4f44">在电脑上获得完整体验</text><text class="center-desc data-v-6c9a4f44">备课场景支持多文件上传、教案排版和PPT导出。\n请复制下方链接，在电脑浏览器打开。</text><view class="link-box data-v-6c9a4f44"><text class="link-text data-v-6c9a4f44">https://xiaoshu.ai/web</text><button class="btn-copy data-v-6c9a4f44" bindtap="{{O}}">复制</button></view><text class="hint-gray data-v-6c9a4f44">💬 提示：已复制链接，请发送给微信"文件传输助手"</text><view class="fixed-footer-static data-v-6c9a4f44"><button class="btn-green-full data-v-6c9a4f44" bindtap="{{P}}">我已在电脑上完成</button></view></view><view wx:if="{{Q}}" class="stage-container bg-gray data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="mode-header data-v-6c9a4f44"><view class="icon-tree-circle data-v-6c9a4f44"><text class="data-v-6c9a4f44">🌳</text></view><view class="data-v-6c9a4f44"><text class="mode-title data-v-6c9a4f44">小树陪你写评语</text><text class="mode-sub data-v-6c9a4f44">今天想怎么用?</text></view></view><view class="card-list data-v-6c9a4f44"><view class="mode-card data-v-6c9a4f44" bindtap="{{R}}"><view class="badge-gray data-v-6c9a4f44">临时补写</view><view class="card-content-row data-v-6c9a4f44"><view class="data-v-6c9a4f44"><text class="card-desc-gray data-v-6c9a4f44">给1个学生写评语，约1分钟</text><text class="btn-text-simple data-v-6c9a4f44">选这个 →</text></view></view></view><view class="mode-card border-green data-v-6c9a4f44" bindtap="{{S}}"><view class="badge-green data-v-6c9a4f44">⭐️ 推荐</view><view class="card-content-col data-v-6c9a4f44"><text class="card-main-text data-v-6c9a4f44">支持拍照/上传Excel，3分钟搞定全班</text><view class="info-box-gray data-v-6c9a4f44"><text class="info-item data-v-6c9a4f44">适合：期末、月度评价</text><text class="info-item data-v-6c9a4f44">历史：12月5日生成过42人</text></view><button class="btn-primary-green data-v-6c9a4f44">选这个 →</button></view></view></view><view class="tip-box-blue data-v-6c9a4f44"><text class="tip-icon data-v-6c9a4f44">💡</text><view class="data-v-6c9a4f44"><text class="tip-title data-v-6c9a4f44">小树的建议</text><text class="tip-body data-v-6c9a4f44">现在是期末季，建议使用批量模式一次搞定全班~</text></view></view></scroll-view></view><view wx:if="{{TS}}" class="stage-container bg-gray data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="mode-header data-v-6c9a4f44"><text class="page-title data-v-6c9a4f44">选择出题工具</text></view><view class="assistant-card-green data-v-6c9a4f44"><view class="asst-icon-box data-v-6c9a4f44"><text class="asst-icon data-v-6c9a4f44">❔</text></view><view class="data-v-6c9a4f44"><text class="asst-title data-v-6c9a4f44">小树出题助手</text><text class="asst-desc data-v-6c9a4f44">不仅能出题，还能帮你改题、评卷。你想先做什么?</text></view></view>        <view class="tool-list data-v-6c9a4f44"><view class="tool-card data-v-6c9a4f44" bindtap="handleQuickQuiz" hover-class="btn-hover">
            <view class="row-center data-v-6c9a4f44">
                <text class="tool-icon data-v-6c9a4f44">⚡️</text>
                <view class="col-left data-v-6c9a4f44">
                    <text class="tool-title data-v-6c9a4f44">快速课堂出题</text>
                    <text class="tool-sub data-v-6c9a4f44">基于知识点快速生成练习</text>
                </view>
            </view>
            <button class="btn-xs-outline data-v-6c9a4f44" style="color: #9333ea; border-color: #d8b4fe;">去出题</button>
        </view>
        <view class="tool-card data-v-6c9a4f44" bindtap="handlePaperAssess" hover-class="btn-hover">
            <view class="row-center data-v-6c9a4f44">
                <text class="tool-icon data-v-6c9a4f44">📄</text>
                <view class="col-left data-v-6c9a4f44">
                    <text class="tool-title data-v-6c9a4f44">试卷质量评估</text>
                    <text class="tool-sub data-v-6c9a4f44">上传试卷智能分析质量与改进建议</text>
                </view>
            </view>
            <button class="btn-xs-outline data-v-6c9a4f44" style="color: #9333ea; border-color: #d8b4fe;">去评估</button>
        </view>
        <view class="tool-card data-v-6c9a4f44" bindtap="handleAdaptation" hover-class="btn-hover">
            <view class="row-center data-v-6c9a4f44">
                <text class="tool-icon data-v-6c9a4f44">🔄</text>
                <view class="col-left data-v-6c9a4f44">
                    <text class="tool-title data-v-6c9a4f44">题目改编优化</text>
                    <text class="tool-sub data-v-6c9a4f44">让旧题焕发新生，支持教材适配、情境本土化</text>
                </view>
            </view>
            <button class="btn-xs-outline data-v-6c9a4f44" style="color: #4f46e5; border-color: #818cf8;">去改编</button>
        </view>
        <view class="tool-card data-v-6c9a4f44" bindtap="handleMistakeTraining" hover-class="btn-hover">
            <view class="row-center data-v-6c9a4f44">
                <text class="tool-icon data-v-6c9a4f44">📒</text>
                <view class="col-left data-v-6c9a4f44">
                    <text class="tool-title data-v-6c9a4f44">错题强化训练</text>
                    <text class="tool-sub data-v-6c9a4f44">基于错题生成针对性变式训练</text>
                </view>
            </view>
            <button class="btn-xs-outline data-v-6c9a4f44" style="color: #4f46e5; border-color: #818cf8;">去训练</button>
        </view>
    </view>
    </scroll-view>
</view>

<view wx:if="{{ST}}" class="stage-container bg-gray data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="mode-header data-v-6c9a4f44"><text class="page-title data-v-6c9a4f44">解题思路与答案</text></view><view class="assistant-card-orange data-v-6c9a4f44"><view class="asst-icon-box-orange data-v-6c9a4f44"><text class="asst-icon-orange data-v-6c9a4f44">💡</text></view><view class="data-v-6c9a4f44"><text class="asst-title-orange data-v-6c9a4f44">小树解题助手</text><text class="asst-desc-orange data-v-6c9a4f44">拍照或输入题目，我帮你生成多维度解析。</text></view></view><view class="tool-list data-v-6c9a4f44"><view class="tool-card data-v-6c9a4f44"><view class="row-center data-v-6c9a4f44"><text class="tool-icon data-v-6c9a4f44">📝</text><view class="col-left data-v-6c9a4f44"><text class="tool-title data-v-6c9a4f44">标准答案生成</text><text class="tool-sub data-v-6c9a4f44">生成规范、详细的步骤解析</text></view></view><button class="btn-xs-outline-orange data-v-6c9a4f44" bindtap="{{sol_std}}">生成答案 ></button></view><view class="tool-card data-v-6c9a4f44"><view class="row-center data-v-6c9a4f44"><text class="tool-icon data-v-6c9a4f44">⚠️</text><view class="col-left data-v-6c9a4f44"><text class="tool-title data-v-6c9a4f44">关键点与易错点</text><text class="tool-sub data-v-6c9a4f44">标注考点，预警常见错误</text></view></view><button class="btn-xs-outline-orange data-v-6c9a4f44" bindtap="{{sol_mistake}}">查看重点 ></button></view><view class="tool-card data-v-6c9a4f44"><view class="row-center data-v-6c9a4f44"><text class="tool-icon data-v-6c9a4f44">🛣️</text><view class="col-left data-v-6c9a4f44"><text class="tool-title data-v-6c9a4f44">多种解法探索</text><text class="tool-sub data-v-6c9a4f44">提供不同思路，拓展思维</text></view></view><button class="btn-xs-outline-orange data-v-6c9a4f44" bindtap="{{sol_multi}}">探索解法 ></button></view><view class="tool-card data-v-6c9a4f44"><view class="row-center data-v-6c9a4f44"><text class="tool-icon data-v-6c9a4f44">🔄</text><view class="col-left data-v-6c9a4f44"><text class="tool-title data-v-6c9a4f44">变式题扩展</text><text class="tool-sub data-v-6c9a4f44">举一反三，生成同类练习</text></view></view><button class="btn-xs-outline-orange data-v-6c9a4f44" bindtap="{{sol_var}}">生成变式 ></button></view></view></scroll-view></view>

<view wx:if="{{AT}}" class="stage-container bg-gray data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="mode-header data-v-6c9a4f44"><text class="page-title data-v-6c9a4f44">行政工作</text></view><view class="assistant-card-blue data-v-6c9a4f44"><view class="asst-icon-box-blue data-v-6c9a4f44"><text class="asst-icon-blue data-v-6c9a4f44">📂</text></view><view class="data-v-6c9a4f44"><text class="asst-title-blue data-v-6c9a4f44">小树行政助手</text><text class="asst-desc-blue data-v-6c9a4f44">输入关键信息，快速生成高质量公文。</text></view></view><view class="tool-list data-v-6c9a4f44"><view class="tool-card data-v-6c9a4f44"><view class="row-center data-v-6c9a4f44"><text class="tool-icon data-v-6c9a4f44">📢</text><view class="col-left data-v-6c9a4f44"><text class="tool-title data-v-6c9a4f44">学校公众号文案撰写</text><text class="tool-sub data-v-6c9a4f44">输入活动信息，生成吸睛推文</text></view></view><button class="btn-xs-outline-blue data-v-6c9a4f44" bindtap="{{handleOfficial}}">生成文案 ></button></view><view class="tool-card data-v-6c9a4f44"><view class="row-center data-v-6c9a4f44"><text class="tool-icon data-v-6c9a4f44">📄</text><view class="col-left data-v-6c9a4f44"><text class="tool-title data-v-6c9a4f44">行政报告起草</text><text class="tool-sub data-v-6c9a4f44">生成工作计划、总结汇报材料</text></view></view><button class="btn-xs-outline-blue data-v-6c9a4f44" bindtap="{{handleReport}}">起草报告 ></button></view><view class="tool-card data-v-6c9a4f44"><view class="row-center data-v-6c9a4f44"><text class="tool-icon data-v-6c9a4f44">📝</text><view class="col-left data-v-6c9a4f44"><text class="tool-title data-v-6c9a4f44">活动总结文案生成</text><text class="tool-sub data-v-6c9a4f44">一键生成活动回顾与成效总结</text></view></view><button class="btn-xs-outline-blue data-v-6c9a4f44" bindtap="{{handleSummary}}">生成总结 ></button></view></view></scroll-view></view>


<view wx:if="{{SUMMARY_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
    <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
        <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">活动总结文案生成</text>
        <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #2563eb; margin-top: 8rpx; display: block;">精准总结活动</text>
    </view>

    <view class="section-box data-v-6c9a4f44" style="padding: 32rpx 32rpx 0; display: flex; align-items: center;">
        <text class="section-icon data-v-6c9a4f44" style="font-size: 32rpx; margin-right: 12rpx;">✍️</text>
        <text class="section-title data-v-6c9a4f44" style="font-size: 32rpx; font-weight: 700; color: #2563eb;">核心信息</text>
    </view>

        <view class="form-group data-v-6c9a4f44" style="padding: 16rpx 32rpx;">
            <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">活动名称</text>
                <input class="input data-v-6c9a4f44" placeholder="" value="{{sum_actName}}" bindinput="{{sum_onActName}}"/>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx">
                <text class="label data-v-6c9a4f44">活动主题</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 十八而志，责任与成长" value="{{sum_theme}}" bindinput="{{sum_onTheme}}"/>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx">
                <text class="label data-v-6c9a4f44">举办时间/地点</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 2024年10月15日下午2:30-4:00, 学校礼堂" value="{{sum_timeLoc}}" bindinput="{{sum_onTimeLoc}}"/>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx">
                <text class="label data-v-6c9a4f44">参与对象</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 高三年级520名学生" value="{{sum_part}}" bindinput="{{sum_onPart}}"/>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx">
                <text class="label data-v-6c9a4f44">活动目标</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 让家长见证孩子成长" value="{{sum_obj}}" bindinput="{{sum_onObj}}"/>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx">
                <text class="label data-v-6c9a4f44">活动形式</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 仪式教育+互动体验" value="{{sum_fmt}}" bindinput="{{sum_onFmt}}"/>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx">
                <text class="label data-v-6c9a4f44">核心流程</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 1.开场致辞 2.成人仪式 3.互动环节" value="{{sum_flow}}" bindinput="{{sum_onFlow}}"/>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx">
                <text class="label data-v-6c9a4f44">核心数据</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 520名学生全部参与, 收到家长反馈80余条" value="{{sum_data}}" bindinput="{{sum_onData}}"/>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44" style="padding: 0 32rpx;">
            <text class="divider-label data-v-6c9a4f44" style="color: #6b7280; background: #f3f4f6; display: inline-block; padding: 4rpx 12rpx; border-radius: 8rpx;">选填</text>
            
            <view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx">
                <text class="label data-v-6c9a4f44">关键词</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 责任、感恩、传承" value="{{sum_kw}}" bindinput="{{sum_onKw}}"/>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx">
                <text class="label data-v-6c9a4f44">特别要求</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 写得感人催泪一点" value="{{sum_spec}}" bindinput="{{sum_onSpec}}"/>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44" style="padding: 0 32rpx 32rpx; margin-bottom: 200rpx;">
            <text class="divider-label data-v-6c9a4f44" style="color: #2563eb; background: #eff6ff; display: inline-block; padding: 4rpx 12rpx; border-radius: 8rpx;">总结用途 (保留1项)</text>

            <view class="option-card data-v-6c9a4f44 {{sum_usage === 'A' ? 'option-card-green' : ''}}" style="padding: 24rpx; margin-bottom: 16rpx;" bindtap="{{sum_setUsage}}" data-val="A">
                <view style="display:flex; justify-content:space-between; align-items:center;">
                    <text style="font-size: 28rpx; color: #374151; font-weight: 700;">A. 对外宣传 (公众号/网站)</text>
                    <icon wx:if="{{sum_usage === 'A'}}" type="success_no_circle" size="16" color="#16a34a"/>
                </view>
            </view>
            
            <view class="option-card data-v-6c9a4f44 {{sum_usage === 'B' ? 'option-card-green' : ''}}" style="padding: 24rpx; margin-bottom: 16rpx;" bindtap="{{sum_setUsage}}" data-val="B">
                <view style="display:flex; justify-content:space-between; align-items:center;">
                    <text style="font-size: 28rpx; color: #374151; font-weight: 700;">B. 经验总结 (内部分享)</text>
                    <icon wx:if="{{sum_usage === 'B'}}" type="success_no_circle" size="16" color="#16a34a"/>
                </view>
            </view>

            <view class="option-card data-v-6c9a4f44 {{sum_usage === 'C' ? 'option-card-green' : ''}}" style="padding: 24rpx; margin-bottom: 16rpx;" bindtap="{{sum_setUsage}}" data-val="C">
                <view style="display:flex; justify-content:space-between; align-items:center;">
                    <text style="font-size: 28rpx; color: #374151; font-weight: 700;">C. 正式存档 (上报材料)</text>
                    <icon wx:if="{{sum_usage === 'C'}}" type="success_no_circle" size="16" color="#16a34a"/>
                </view>
            </view>

             <view class="option-card data-v-6c9a4f44 {{sum_usage === 'D' ? 'option-card-green' : ''}}" style="padding: 24rpx; margin-bottom: 16rpx;" bindtap="{{sum_setUsage}}" data-val="D">
                <view style="display:flex; justify-content:space-between; align-items:center;">
                    <text style="font-size: 28rpx; color: #374151; font-weight: 700;">D. 家长通报 (家校沟通)</text>
                    <icon wx:if="{{sum_usage === 'D'}}" type="success_no_circle" size="16" color="#16a34a"/>
                </view>
            </view>

        </view>

        <view style="height: 200rpx;"></view>
    </scroll-view>
    <view class="fixed-footer data-v-6c9a4f44">
        <button class="btn-green-full data-v-6c9a4f44" bindtap="{{sum_generate}}">生成活动总结</button>
        <text class="footer-hint data-v-6c9a4f44">AI 生成内容仅供参考</text>
    </view>
</view>
<view wx:if="{{PL}}" class="stage-container bg-white data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="prep-banner-purple data-v-6c9a4f44"><view class="banner-content data-v-6c9a4f44"><text class="banner-title data-v-6c9a4f44">🏆 公开课比赛指南</text><text class="banner-desc data-v-6c9a4f44">小树将用“课程设计”与“说课文稿”两个专业模板，帮你打造优质公开课。</text><button class="btn-white-purple data-v-6c9a4f44" bindtap="{{M}}">💻 打开网页体验全流程 ➔</button></view></view><view class="section-box data-v-6c9a4f44"><text class="section-title-sm data-v-6c9a4f44">提示词模板 (2个, 有先后顺序)</text></view><view class="step-list data-v-6c9a4f44"><view class="step-card data-v-6c9a4f44"><text class="step-num-purple data-v-6c9a4f44">01</text><view class="step-info data-v-6c9a4f44"><text class="step-title data-v-6c9a4f44">课程设计</text><text class="step-desc data-v-6c9a4f44">新课标导向，生成创新教学设计</text></view><button class="btn-step-action-purple data-v-6c9a4f44" bindtap="{{handlePLDesign}}">立即生成 ></button></view><view class="step-card data-v-6c9a4f44"><text class="step-num-purple data-v-6c9a4f44">02</text><view class="step-info data-v-6c9a4f44"><text class="step-title data-v-6c9a4f44">说课文稿准备</text><text class="step-desc data-v-6c9a4f44">需基于模板1的输出，生成说课稿</text></view><button class="btn-step-action-purple data-v-6c9a4f44" bindtap="{{handlePLLecture}}">获取文稿 ></button></view></view></scroll-view></view>
<view wx:if="{{PL_DESIGN_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">公开课比赛-课程设计</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #7c3aed; margin-top: 8rpx; display: block;">新课标导向 | 创新设计 | 深度互动</text>
        </view>
        <text class="section-title data-v-6c9a4f44" style="color: #7c3aed;">✍️ 任务信息</text>
        
        <view class="form-group data-v-6c9a4f44">
             <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">比赛级别</text>
                <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;">
                     <view bindtap="{{pl_setLevel}}" data-val="市级" class="pill-item {{pl_level=='市级'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{pl_level=='市级'?'#7c3aed':'#f3f4f6'}}; color: {{pl_level=='市级'?'#fff':'#374151'}}; font-size: 26rpx;">市级</view>
                     <view bindtap="{{pl_setLevel}}" data-val="省级" class="pill-item {{pl_level=='省级'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{pl_level=='省级'?'#7c3aed':'#f3f4f6'}}; color: {{pl_level=='省级'?'#fff':'#374151'}}; font-size: 26rpx;">省级</view>
                     <view bindtap="{{pl_setLevel}}" data-val="校级" class="pill-item {{pl_level=='校级'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{pl_level=='校级'?'#7c3aed':'#f3f4f6'}}; color: {{pl_level=='校级'?'#fff':'#374151'}}; font-size: 26rpx;">校级</view>
                </view>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">基本信息</text>
             <view class="input-wrap data-v-6c9a4f44" style="margin-bottom: 24rpx;">
                <text class="label data-v-6c9a4f44">学科</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 数学" value="{{plDesignData.subject}}" bindinput="{{pl_onSubject}}"/>
            </view>
             <view class="row-2 data-v-6c9a4f44">
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">年级</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 高一" value="{{pl_grade}}" bindinput="{{pl_onGrade}}"/>
                </view>
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">教材版本</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 人教版" value="{{pl_version}}" bindinput="{{pl_onVersion}}"/>
                </view>
             </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">课题名称</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 函数的单调性" value="{{pl_topic}}" bindinput="{{pl_onTopic}}"/>
            </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">班级学情</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 40人, 基础中等, 气氛活跃" value="{{pl_class}}" bindinput="{{pl_onClass}}"/>
            </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">比赛特殊要求</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 同课异构、大单元视角、情境创设" value="{{pl_compReq}}" bindinput="{{pl_onCompReq}}"/>
            </view>
        </view>
        
        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">课时 (单选)</text>
            <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;">
                 <view bindtap="{{pl_setDuration}}" data-val="40分钟" class="pill-item {{pl_duration=='40分钟'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{pl_duration=='40分钟'?'#7c3aed':'#f3f4f6'}}; color: {{pl_duration=='40分钟'?'#fff':'#374151'}}; font-size: 26rpx;">40分钟</view>
                 <view bindtap="{{pl_setDuration}}" data-val="45分钟" class="pill-item {{pl_duration=='45分钟'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{pl_duration=='45分钟'?'#7c3aed':'#f3f4f6'}}; color: {{pl_duration=='45分钟'?'#fff':'#374151'}}; font-size: 26rpx;">45分钟</view>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">教材内容 / 核心知识点</text>
            <view class="content-toggle-row data-v-6c9a4f44" style="display: flex; gap: 24rpx; margin-top: 24rpx; margin-bottom: 24rpx;">
                <view class="toggle-option data-v-6c9a4f44" bindtap="{{pl_setType}}" data-val="file" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{pl_contentType=='file' ? '#7c3aed' : '#e5e7eb'}}; background: {{pl_contentType=='file' ? '#f5f3ff' : '#fff'}};">
                    <text class="icon data-v-6c9a4f44">📄</text><text class="text data-v-6c9a4f44">上传文件</text>
                </view>
                <view class="toggle-option data-v-6c9a4f44" bindtap="{{pl_setType}}" data-val="manual" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{pl_contentType=='manual' ? '#7c3aed' : '#e5e7eb'}}; background: {{pl_contentType=='manual' ? '#f5f3ff' : '#fff'}};">
                    <text class="icon data-v-6c9a4f44">✍️</text><text class="text data-v-6c9a4f44">手动输入</text>
                </view>
            </view>
            <view wx:if="{{pl_contentType=='file'}}" class="upload-area data-v-6c9a4f44" bindtap="{{pl_upload}}" style="border: 2rpx dashed #a78bfa; border-radius: 16rpx; padding: 48rpx; text-align: center; background: #f5f3ff;">
                <text class="icon-lg data-v-6c9a4f44" style="font-size: 64rpx; display: block; margin-bottom: 16rpx;">{{utils.includes(pl_content, '[已上传文件]') ? '✅' : '☁️'}}</text>
                <text class="upload-title data-v-6c9a4f44" style="color: #6d28d9; font-weight: 500;">{{utils.includes(pl_content, '[已上传文件]') ? pl_content : '点击上传教材/导学案/课件'}}</text>
                <text wx:if="{{!utils.includes(pl_content, '[已上传文件]')}}" class="upload-sub data-v-6c9a4f44" style="color: #9ca3af; font-size: 24rpx; margin-top: 8rpx; display: block;">支持 Word / PDF / 图片</text>
            </view>
            <view wx:if="{{pl_contentType=='manual'}}" class="manual-area data-v-6c9a4f44">
                <textarea class="textarea data-v-6c9a4f44" style="height: 240rpx; background: #fff; border-color: #e5e7eb;" placeholder="粘贴核心知识点、重点文段或公式..." value="{{pl_content}}" bindinput="{{pl_onContent}}"/>
            </view>
        </view>

        <view class="advanced-section data-v-6c9a4f44" style="margin-top: 32rpx; padding: 24rpx; background: #f9fafb; border-radius: 16rpx;">
            <view class="toggle-btn data-v-6c9a4f44" bindtap="{{pl_toggleAdv}}" style="display: flex; justify-content: space-between; align-items: center;">
                <text class="section-title-sm data-v-6c9a4f44" style="color: #7c3aed; margin-bottom: 0; display: block;">高级选项 (选填)</text>
                <text class="{{['data-v-6c9a4f44', 'arrow', pl_isAdv ? 'rotate-180' : '']}}" style="color: #9ca3af; transform: rotate({{pl_isAdv?180:0}}deg); transition: all 0.3s;">▼</text>
            </view>
            <view wx:if="{{pl_isAdv}}" class="advanced-content fade-in data-v-6c9a4f44" style="margin-top: 24rpx;">
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">预设亮点</text>
                    <input class="input data-v-6c9a4f44" placeholder="你最想展示的教学创新点" value="{{pl_highlights}}" bindinput="{{pl_onHighlights}}"/>
                </view>
                <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                    <text class="label data-v-6c9a4f44">教学理念</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: PBL项目式学习/深度学习" value="{{pl_philosophy}}" bindinput="{{pl_onPhilosophy}}"/>
                </view>
                <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                    <text class="label data-v-6c9a4f44">技术工具</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 希沃白板计时器/雨课堂" value="{{pl_tools}}" bindinput="{{pl_onTools}}"/>
                </view>
             </view>
        </view>
        
        <view style="height: 120rpx;"></view>
    </scroll-view>
     <view class="fixed-footer data-v-6c9a4f44">
        <button class="btn-primary data-v-6c9a4f44" style="background-color: #7c3aed;" bindtap="{{pl_generate}}">生成教学方案</button>
    </view>
</view>
<view wx:if="{{PL_LECTURE_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">说课文稿准备</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #7c3aed; margin-top: 8rpx; display: block;">新课标导向 | 创新设计 | 深度互动</text>
        </view>

        <text class="section-title data-v-6c9a4f44" style="color: #7c3aed;">✍️ 课程信息</text>
        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">基本信息</text>
             <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">课题</text>
                <input class="input data-v-6c9a4f44" placeholder="课题名称及学科" value="{{lec_topic}}" bindinput="{{lec_onTopic}}"/>
            </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">核心亮点</text>
                <textarea class="textarea data-v-6c9a4f44" style="height: 120rpx; background: #fff; border-color: #e5e7eb;" placeholder="如: 基于PBL的真实情境创设/学生AI助教工具的使用" value="{{lec_highlights}}" bindinput="{{lec_onHighlights}}"/>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">教学设计</text>
            <view class="content-toggle-row data-v-6c9a4f44" style="display: flex; gap: 24rpx; margin-top: 24rpx; margin-bottom: 24rpx;">
                <view class="toggle-option data-v-6c9a4f44" bindtap="{{lec_setType}}" data-val="file" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{lec_contentType=='file' ? '#7c3aed' : '#e5e7eb'}}; background: {{lec_contentType=='file' ? '#f5f3ff' : '#fff'}};">
                    <text class="icon data-v-6c9a4f44">📄</text><text class="text data-v-6c9a4f44">上传文件</text>
                </view>
                <view class="toggle-option data-v-6c9a4f44" bindtap="{{lec_setType}}" data-val="manual" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{lec_contentType=='manual' ? '#7c3aed' : '#e5e7eb'}}; background: {{lec_contentType=='manual' ? '#f5f3ff' : '#fff'}};">
                    <text class="icon data-v-6c9a4f44">✍️</text><text class="text data-v-6c9a4f44">手动输入</text>
                </view>
            </view>
            <view wx:if="{{lec_contentType=='file'}}" class="upload-area data-v-6c9a4f44" bindtap="{{lec_upload}}" style="border: 2rpx dashed #a78bfa; border-radius: 16rpx; padding: 48rpx; text-align: center; background: #f5f3ff;">
                <text class="icon-lg data-v-6c9a4f44" style="font-size: 64rpx; display: block; margin-bottom: 16rpx;">{{utils.includes(lec_content, '[已上传文件]') ? '✅' : '☁️'}}</text>
                <text class="upload-title data-v-6c9a4f44" style="color: #6d28d9; font-weight: 500;">{{utils.includes(lec_content, '[已上传文件]') ? lec_content : '点击上传教学设计文件'}}</text>
            </view>
            <view wx:if="{{lec_contentType=='manual'}}" class="manual-area data-v-6c9a4f44">
                <textarea class="textarea data-v-6c9a4f44" style="height: 240rpx; background: #fff; border-color: #e5e7eb;" placeholder="粘贴核心内容..." value="{{lec_content}}" bindinput="{{lec_onContent}}"/>
            </view>
        </view>

        <view class="footer-action data-v-6c9a4f44" style="padding: 32rpx;">
            <button class="btn-primary data-v-6c9a4f44" bindtap="{{lec_generate}}" style="background-color: #7c3aed;">生成说课文稿</button>
        </view>
        <view style="height: 120rpx;"></view>
    </scroll-view>
</view>
<view wx:if="{{RP}}" class="stage-container bg-white data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="prep-banner-teal data-v-6c9a4f44"><view class="banner-content data-v-6c9a4f44"><text class="banner-title data-v-6c9a4f44">📝 教学研究论文撰写指南</text><text class="banner-desc data-v-6c9a4f44">小树将用5个专业步骤，帮你完成高质量教学研究论文。</text><button class="btn-white-teal data-v-6c9a4f44" bindtap="{{M}}">💻 打开网页体验全流程 ➔</button></view></view><view class="section-box data-v-6c9a4f44"><text class="section-title-sm data-v-6c9a4f44">提示词模板 (5个, 连续步骤)</text></view><view class="step-list data-v-6c9a4f44"><view class="step-card data-v-6c9a4f44"><text class="step-num-teal data-v-6c9a4f44">01</text><view class="step-info data-v-6c9a4f44"><text class="step-title data-v-6c9a4f44">课题思路生成</text><text class="step-desc data-v-6c9a4f44">挖掘研究价值，确定选题方向</text></view><button class="btn-step-action-teal data-v-6c9a4f44" bindtap="{{handleRPTopic}}">立即生成 ></button></view><view class="step-card data-v-6c9a4f44"><text class="step-num-teal data-v-6c9a4f44">02</text><view class="step-info data-v-6c9a4f44"><text class="step-title data-v-6c9a4f44">文献综述与热点分析</text><text class="step-desc data-v-6c9a4f44">分析研究现状，对标学界热点</text></view><button class="btn-step-action-teal data-v-6c9a4f44" bindtap="{{handleRPReview}}">分析热点 ></button></view><view class="step-card data-v-6c9a4f44"><text class="step-num-teal data-v-6c9a4f44">03</text><view class="step-info data-v-6c9a4f44"><text class="step-title data-v-6c9a4f44">研究方法设计</text><text class="step-desc data-v-6c9a4f44">设计科学严谨的研究路径</text></view><button class="btn-step-action-teal data-v-6c9a4f44" bindtap="{{handleRPMethod}}">设计方法 ></button></view><view class="step-card data-v-6c9a4f44"><text class="step-num-teal data-v-6c9a4f44">04</text><view class="step-info data-v-6c9a4f44"><text class="step-title data-v-6c9a4f44">研究数据分析</text><text class="step-desc data-v-6c9a4f44">解读数据，提炼核心结论</text></view><button class="btn-step-action-teal data-v-6c9a4f44" bindtap="{{handleRPData}}">开始分析 ></button></view><view class="step-card data-v-6c9a4f44"><text class="step-num-teal data-v-6c9a4f44">05</text><view class="step-info data-v-6c9a4f44"><text class="step-title data-v-6c9a4f44">论文框架与写作建议</text><text class="step-desc data-v-6c9a4f44">构建逻辑框架，提供写作指导</text></view><button class="btn-step-action-teal data-v-6c9a4f44" bindtap="{{handleRPFramework}}">生成框架 ></button></view></view></scroll-view></view>
<view wx:if="{{RP_TOPIC_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">课题思路生成</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #0d9488; margin-top: 8rpx; display: block;">挖掘研究价值，确定选题方向</text>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">✍️ 任务信息</text>
             <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">研究主题或教学问题</text>
                <textarea class="textarea data-v-6c9a4f44" style="height: 120rpx; background: #fff; border-color: #e5e7eb;" placeholder="如: 如何提高学生数学学习兴趣" value="{{rp_topic}}" bindinput="{{rp_onTopic}}"/>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">基本信息</text>
             <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">学科背景</text>
                <input class="input data-v-6c9a4f44" placeholder="任教学科" value="{{rp_subject}}" bindinput="{{rp_onSubject}}"/>
            </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">教学环境</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 城市重点中学/乡镇普通高中" value="{{rp_school}}" bindinput="{{rp_onSchool}}"/>
            </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">研究时长</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 一学期/一学年" value="{{rp_duration}}" bindinput="{{rp_onDuration}}"/>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">研究方向角度</text>
             <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; flex-wrap: wrap; margin-top: 24rpx;">
                  <view bindtap="{{rp_toggleAngle}}" data-val="理论角度" class="pill-item {{utils.includes(rp_angles, '理论角度')?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{utils.includes(rp_angles, '理论角度')?'#0d9488':'#f3f4f6'}}; color: {{utils.includes(rp_angles, '理论角度')?'#fff':'#374151'}}; font-size: 26rpx; border: 2rpx solid {{utils.includes(rp_angles, '理论角度')?'#0d9488':'#e5e7eb'}};">理论角度</view>
                  <view bindtap="{{rp_toggleAngle}}" data-val="实践角度" class="pill-item {{utils.includes(rp_angles, '实践角度')?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{utils.includes(rp_angles, '实践角度')?'#0d9488':'#f3f4f6'}}; color: {{utils.includes(rp_angles, '实践角度')?'#fff':'#374151'}}; font-size: 26rpx; border: 2rpx solid {{utils.includes(rp_angles, '实践角度')?'#0d9488':'#e5e7eb'}};">实践角度</view>
                  <view bindtap="{{rp_toggleAngle}}" data-val="创新角度" class="pill-item {{utils.includes(rp_angles, '创新角度')?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{utils.includes(rp_angles, '创新角度')?'#0d9488':'#f3f4f6'}}; color: {{utils.includes(rp_angles, '创新角度')?'#fff':'#374151'}}; font-size: 26rpx; border: 2rpx solid {{utils.includes(rp_angles, '创新角度')?'#0d9488':'#e5e7eb'}};">创新角度</view>
             </view>
        </view>

        <view class="footer-action data-v-6c9a4f44" style="padding: 32rpx;">
            <button class="btn-primary data-v-6c9a4f44" bindtap="{{rp_generate}}" style="background-color: #0d9488;">生成课题思路</button>
        </view>
        <view style="height: 120rpx;"></view>
    </scroll-view>
</view>
<view wx:if="{{RP_REVIEW_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">文献综述与热点分析</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #0d9488; margin-top: 8rpx; display: block;">分析研究现状 | 对标学界热点 | 挖掘创新机会</text>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">基本信息</text>
             <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">学科背景</text>
                <input class="input data-v-6c9a4f44" placeholder="任教学科" value="{{rp_rev_subject}}" bindinput="{{rp_rev_onSubject}}"/>
            </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">研究主题</text>
                <input class="input data-v-6c9a4f44" placeholder="研究课题或方向" value="{{rp_rev_topic}}" bindinput="{{rp_rev_onTopic}}"/>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">时间范围 (单选)</text>
             <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;">
                  <view bindtap="{{rp_rev_setTime}}" data-val="近一年" class="pill-item {{rp_rev_time=='近一年'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_rev_time=='近一年'?'#0d9488':'#f3f4f6'}}; color: {{rp_rev_time=='近一年'?'#fff':'#374151'}}; font-size: 26rpx;">近一年</view>
                  <view bindtap="{{rp_rev_setTime}}" data-val="近三年" class="pill-item {{rp_rev_time=='近三年'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_rev_time=='近三年'?'#0d9488':'#f3f4f6'}}; color: {{rp_rev_time=='近三年'?'#fff':'#374151'}}; font-size: 26rpx;">近三年</view>
                  <view bindtap="{{rp_rev_setTime}}" data-val="近五年" class="pill-item {{rp_rev_time=='近五年'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_rev_time=='近五年'?'#0d9488':'#f3f4f6'}}; color: {{rp_rev_time=='近五年'?'#fff':'#374151'}}; font-size: 26rpx;">近五年</view>
             </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">地域范围 (单选)</text>
             <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;">
                  <view bindtap="{{rp_rev_setRegion}}" data-val="国内研究" class="pill-item {{rp_rev_region=='国内研究'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_rev_region=='国内研究'?'#0d9488':'#f3f4f6'}}; color: {{rp_rev_region=='国内研究'?'#fff':'#374151'}}; font-size: 26rpx;">国内研究</view>
                  <view bindtap="{{rp_rev_setRegion}}" data-val="国际前沿" class="pill-item {{rp_rev_region=='国际前沿'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_rev_region=='国际前沿'?'#0d9488':'#f3f4f6'}}; color: {{rp_rev_region=='国际前沿'?'#fff':'#374151'}}; font-size: 26rpx;">国际前沿</view>
                  <view bindtap="{{rp_rev_setRegion}}" data-val="省内动态" class="pill-item {{rp_rev_region=='省内动态'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_rev_region=='省内动态'?'#0d9488':'#f3f4f6'}}; color: {{rp_rev_region=='省内动态'?'#fff':'#374151'}}; font-size: 26rpx;">省内动态</view>
             </view>
        </view>
        
        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">政策背景 (单选)</text>
             <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;">
                  <view bindtap="{{rp_rev_setPolicy}}" data-val="新课程改革" class="pill-item {{rp_rev_policy=='新课程改革'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_rev_policy=='新课程改革'?'#0d9488':'#f3f4f6'}}; color: {{rp_rev_policy=='新课程改革'?'#fff':'#374151'}}; font-size: 26rpx;">新课程改革</view>
                  <view bindtap="{{rp_rev_setPolicy}}" data-val="双减政策" class="pill-item {{rp_rev_policy=='双减政策'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_rev_policy=='双减政策'?'#0d9488':'#f3f4f6'}}; color: {{rp_rev_policy=='双减政策'?'#fff':'#374151'}}; font-size: 26rpx;">双减政策</view>
                  <view bindtap="{{rp_rev_setPolicy}}" data-val="核心素养" class="pill-item {{rp_rev_policy=='核心素养'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_rev_policy=='核心素养'?'#0d9488':'#f3f4f6'}}; color: {{rp_rev_policy=='核心素养'?'#fff':'#374151'}}; font-size: 26rpx;">核心素养</view>
             </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">关注重点 (单选)</text>
             <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;">
                  <view bindtap="{{rp_rev_setFocus}}" data-val="实践应用" class="pill-item {{rp_rev_focus=='实践应用'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_rev_focus=='实践应用'?'#0d9488':'#f3f4f6'}}; color: {{rp_rev_focus=='实践应用'?'#fff':'#374151'}}; font-size: 26rpx;">实践应用</view>
                  <view bindtap="{{rp_rev_setFocus}}" data-val="理论创新" class="pill-item {{rp_rev_focus=='理论创新'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_rev_focus=='理论创新'?'#0d9488':'#f3f4f6'}}; color: {{rp_rev_focus=='理论创新'?'#fff':'#374151'}}; font-size: 26rpx;">理论创新</view>
                  <view bindtap="{{rp_rev_setFocus}}" data-val="技术融合" class="pill-item {{rp_rev_focus=='技术融合'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_rev_focus=='技术融合'?'#0d9488':'#f3f4f6'}}; color: {{rp_rev_focus=='技术融合'?'#fff':'#374151'}}; font-size: 26rpx;">技术融合</view>
             </view>
        </view>

        <view class="footer-action data-v-6c9a4f44" style="padding: 32rpx;">
            <button class="btn-primary data-v-6c9a4f44" bindtap="{{rp_rev_generate}}" style="background-color: #0d9488;">开始分析热点</button>
        </view>
        <view style="height: 120rpx;"></view>
    </scroll-view>
</view>
<view wx:if="{{RP_METHOD_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">研究方法设计</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #0d9488; margin-top: 8rpx; display: block;">设计科学严谨的研究路径 | 匹配最优分析范式</text>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <view class="row-between data-v-6c9a4f44" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24rpx;">
                <text class="divider-label data-v-6c9a4f44" style="margin-bottom: 0;">研究问题</text>
                <view style="display: flex; align-items: center; gap: 16rpx;">
                     <button class="btn-xs-outline data-v-6c9a4f44" style="color: #0d9488; border-color: #ccfbf1; background: #fff; margin: 0; font-size: 24rpx; padding: 8rpx 24rpx; line-height: 1.5;" bindtap="{{rp_viewTopicHistory}}">🔍 查看步骤1结果</button>
                     <view class="toggle-switch data-v-6c9a4f44" style="display: flex; background: #f3f4f6; border-radius: 32rpx; padding: 4rpx;">
                        <view bindtap="{{rp_meth_setType}}" data-type="manual" class="switch-item {{rp_meth_type=='manual'?'active':''}}" style="padding: 8rpx 24rpx; border-radius: 28rpx; font-size: 24rpx; color: {{rp_meth_type=='manual'?'#0d9488':'#6b7280'}}; background: {{rp_meth_type=='manual'?'#fff':''}}; box-shadow: {{rp_meth_type=='manual'?'0 2rpx 4rpx rgba(0,0,0,0.05)':''}};">手动录入</view>
                        <view bindtap="{{rp_meth_setType}}" data-type="upload" class="switch-item {{rp_meth_type=='upload'?'active':''}}" style="padding: 8rpx 24rpx; border-radius: 28rpx; font-size: 24rpx; color: {{rp_meth_type=='upload'?'#0d9488':'#6b7280'}}; background: {{rp_meth_type=='upload'?'#fff':''}}; box-shadow: {{rp_meth_type=='upload'?'0 2rpx 4rpx rgba(0,0,0,0.05)':''}};">拍照/上传</view>
                     </view>
                </view>
             </view>
             
             <block wx:if="{{rp_meth_type === 'manual'}}">
                 <view class="input-wrap data-v-6c9a4f44">
                    <textarea class="textarea data-v-6c9a4f44" placeholder="【粘贴或上传第一步生成的具体研究问题】" value="{{rp_meth_problem}}" bindinput="{{rp_meth_onProblem}}" style="height: 240rpx;"></textarea>
                </view>
             </block>
             <block wx:else>
                 <view class="upload-box data-v-6c9a4f44" bindtap="{{rp_meth_upload}}" style="height: 240rpx; border: 2rpx dashed #e5e7eb; border-radius: 16rpx; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #f9fafb;">
                    <text style="font-size: 48rpx;">📷</text>
                    <text style="font-size: 26rpx; color: #6b7280; margin-top: 16rpx;">点击拍摄或上传研究问题</text>
                 </view>
                 <view wx:if="{{rp_meth_problem}}" style="margin-top: 16rpx; display: flex; align-items: center; gap: 16rpx;">
                     <text style="color: #0d9488;">✅ 已上传</text>
                     <text style="color: #374151; font-size: 24rpx; flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{rp_meth_problem}}</text>
                 </view>
             </block>
        </view>

        <view class="footer-action data-v-6c9a4f44" style="padding: 32rpx;">
            <button class="btn-primary data-v-6c9a4f44" bindtap="{{rp_meth_generate}}" style="background-color: #0d9488;">生成研究方法</button>
        </view>
        <view style="height: 120rpx;"></view>
    </scroll-view>
</view>

<!-- RP Step 4: Data Analysis Input -->
<view wx:if="{{RP_DATA_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <!-- Header -->
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">研究数据分析</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #0d9488; margin-top: 8rpx; display: block;">导入多源数据 | 智能量化/质性分析</text>
        </view>

        <!-- Data File Upload -->
        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">数据文件</text>
            <block wx:if="{{!rp_data_file}}">
                <view class="upload-box data-v-6c9a4f44" bindtap="{{rp_data_upload}}" style="height: 240rpx; border: 2rpx dashed #e5e7eb; border-radius: 16rpx; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #f9fafb;">
                    <text style="font-size: 48rpx;">📂</text>
                    <text style="font-size: 26rpx; color: #6b7280; margin-top: 16rpx;">点击上传数据文件 (Excel/CSV/PDF)</text>
                </view>
            </block>
            <block wx:else>
                <view class="upload-box data-v-6c9a4f44" bindtap="{{rp_data_upload}}" style="height: 240rpx; border: 2rpx solid #ccfbf1; border-radius: 16rpx; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #f0fdfa;">
                    <text style="font-size: 48rpx;">📄</text>
                    <text style="color: #0d9488; margin-top: 16rpx; font-weight: 600;">{{rp_data_file}}</text>
                    <text style="color: #0f766e; font-size: 24rpx; margin-top: 8rpx;">点击可重新上传</text>
                </view>
            </block>
        </view>

        <!-- Data Type Selection -->
        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">数据类型 (单选)</text>
             <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;">
                <view class="pill-item {{rp_data_type=='量化数据'?'active':''}}" bindtap="{{rp_data_setType}}" data-val="量化数据" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_data_type=='量化数据'?'#0d9488':'#f3f4f6'}}; color: {{rp_data_type=='量化数据'?'#fff':'#374151'}}; font-size: 26rpx;">量化数据</view>
                <view class="pill-item {{rp_data_type=='质性文本'?'active':''}}" bindtap="{{rp_data_setType}}" data-val="质性文本" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_data_type=='质性文本'?'#0d9488':'#f3f4f6'}}; color: {{rp_data_type=='质性文本'?'#fff':'#374151'}}; font-size: 26rpx;">质性文本</view>
             </view>
        </view>

        <!-- Footer Action -->
        <view class="footer-action data-v-6c9a4f44" style="padding: 32rpx;">
            <button class="btn-primary data-v-6c9a4f44" bindtap="{{rp_data_generate}}" style="background-color: #0d9488;">开始分析</button>
        </view>
        <view style="height: 120rpx;"></view>
    </scroll-view>
</view>
<!-- RP Step 5: Framework Input -->
<view wx:if="{{RP_FRAMEWORK_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <!-- Header -->
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">论文框架与写作建议</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #0d9488; margin-top: 8rpx; display: block;">构建逻辑框架 | 提供写作指导</text>
        </view>

        <!-- Input Fields -->
        <view class="divider-box data-v-6c9a4f44">
             <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">论文题目</text>
                <input class="input data-v-6c9a4f44" placeholder="【论文题目】" value="{{rp_fra_title}}" bindinput="{{rp_fra_onTitle}}" style="background: #fff; border-color: #e5e7eb;"/>
            </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">字数要求</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 5000-15000" value="{{rp_fra_wordCount}}" bindinput="{{rp_fra_onWordCount}}" style="background: #fff; border-color: #e5e7eb;"/>
            </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">研究对象</text>
                <input class="input data-v-6c9a4f44" placeholder="【研究对象, 如: 高一学生】" value="{{rp_fra_subject}}" bindinput="{{rp_fra_onSubject}}" style="background: #fff; border-color: #e5e7eb;"/>
            </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">核心观点</text>
                <textarea class="textarea data-v-6c9a4f44" placeholder="【主要论点】" value="{{rp_fra_coreArg}}" bindinput="{{rp_fra_onCoreArg}}" style="height: 160rpx; background: #fff; border-color: #e5e7eb;"></textarea>
            </view>
        </view>

        <!-- Research Type Selection -->
        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">研究类型 (单选)</text>
             <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; flex-wrap: wrap; margin-top: 16rpx;">
                <view class="pill-item {{rp_fra_type=='实证研究'?'active':''}}" bindtap="{{rp_fra_setType}}" data-val="实证研究" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_fra_type=='实证研究'?'#0d9488':'#f3f4f6'}}; color: {{rp_fra_type=='实证研究'?'#fff':'#374151'}}; font-size: 26rpx;">实证研究</view>
                <view class="pill-item {{rp_fra_type=='理论研究'?'active':''}}" bindtap="{{rp_fra_setType}}" data-val="理论研究" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_fra_type=='理论研究'?'#0d9488':'#f3f4f6'}}; color: {{rp_fra_type=='理论研究'?'#fff':'#374151'}}; font-size: 26rpx;">理论研究</view>
                <view class="pill-item {{rp_fra_type=='案例研究'?'active':''}}" bindtap="{{rp_fra_setType}}" data-val="案例研究" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_fra_type=='案例研究'?'#0d9488':'#f3f4f6'}}; color: {{rp_fra_type=='案例研究'?'#fff':'#374151'}}; font-size: 26rpx;">案例研究</view>
                <view class="pill-item {{rp_fra_type=='调查研究'?'active':''}}" bindtap="{{rp_fra_setType}}" data-val="调查研究" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_fra_type=='调查研究'?'#0d9488':'#f3f4f6'}}; color: {{rp_fra_type=='调查研究'?'#fff':'#374151'}}; font-size: 26rpx;">调查研究</view>
             </view>
        </view>

         <!-- Target Journal Selection -->
        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">目标期刊 (单选)</text>
             <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;">
                <view class="pill-item {{rp_fra_journal=='校刊'?'active':''}}" bindtap="{{rp_fra_setJournal}}" data-val="校刊" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_fra_journal=='校刊'?'#0d9488':'#f3f4f6'}}; color: {{rp_fra_journal=='校刊'?'#fff':'#374151'}}; font-size: 26rpx;">校刊</view>
                <view class="pill-item {{rp_fra_journal=='省级期刊'?'active':''}}" bindtap="{{rp_fra_setJournal}}" data-val="省级期刊" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_fra_journal=='省级期刊'?'#0d9488':'#f3f4f6'}}; color: {{rp_fra_journal=='省级期刊'?'#fff':'#374151'}}; font-size: 26rpx;">省级期刊</view>
                <view class="pill-item {{rp_fra_journal=='核心期刊'?'active':''}}" bindtap="{{rp_fra_setJournal}}" data-val="核心期刊" style="padding: 16rpx 32rpx; border-radius: 32rpx; background: {{rp_fra_journal=='核心期刊'?'#0d9488':'#f3f4f6'}}; color: {{rp_fra_journal=='核心期刊'?'#fff':'#374151'}}; font-size: 26rpx;">核心期刊</view>
             </view>
        </view>

        <!-- Footer Action -->
        <view class="footer-action data-v-6c9a4f44" style="padding: 32rpx;">
            <button class="btn-primary data-v-6c9a4f44" bindtap="{{rp_fra_generate}}" style="background-color: #0d9488;">生成框架</button>
        </view>
        <view style="height: 120rpx;"></view>
    </scroll-view>
</view>
    <view wx:if="{{T}}" class="stage-container bg-white data-v-6c9a4f44">
        <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
            <text class="page-head-title data-v-6c9a4f44">{{isBatchVoice ? '批量语音录入' : '💬 输入学生信息'}}</text>

            <view class="manual-input data-v-6c9a4f44" wx:if="{{!isBatchVoice}}">
                <view class="input-divider data-v-6c9a4f44"><text class="divider-text data-v-6c9a4f44">或者手动填写</text></view>
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">学生姓名</text>
                    <input class="input data-v-6c9a4f44" placeholder="例如：小明" value="{{aa}}" bindinput="{{ab}}"/>
                </view>
                <view class="input-wrap mt-4 data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">表现 / 关键词</text>
                    <block wx:if="{{r0}}">
                        <textarea class="textarea data-v-6c9a4f44" placeholder="例如：数学进步明显，从70分提高到85分..." value="{{ac}}" bindinput="{{ad}}"/>
                    </block>
                </view>
            </view>
        </scroll-view>
        <view class="fixed-footer data-v-6c9a4f44" wx:if="{{!isBatchVoice}}">
            <button class="{{['data-v-6c9a4f44', af ? 'btn-green-disabled' : 'btn-green-full']}}" bindtap="{{ae}}" disabled="{{af}}" loading="{{ag}}">{{ag ? '处理中...' : '快速生成评语'}}</button>
        </view>
    </view>


    <view wx:if="{{ao}}" class="stage-container bg-gray data-v-6c9a4f44" style="background-color: #f9fafb; padding: 24rpx;">
        <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
            <!-- Header -->
            <view class="header-section data-v-6c9a4f44" style="padding: 24rpx 12rpx;">
                <text class="header-title data-v-6c9a4f44" style="font-size: 36rpx; font-weight: 700; color: #111827; display: block; margin-bottom: 12rpx;">上传学生信息</text>
                <view style="display: flex; align-items: center; gap: 8rpx;">
                    <text style="font-size: 28rpx;">💡</text>
                    <text style="font-size: 26rpx; color: #6b7280;">选一个最便捷的方式输入信息，小树都支持</text>
                </view>
            </view>

            <!-- Cards Container -->
            <view class="cards-container data-v-6c9a4f44" style="display: flex; flex-direction: column; gap: 24rpx; padding: 0 12rpx;">
                
                <!-- Camera Card -->
                <view class="action-card data-v-6c9a4f44" bindtap="{{camera}}" style="background: #fff; border-radius: 24rpx; padding: 40rpx 32rpx; position: relative; border: 2rpx solid #22c55e; box-shadow: 0 4rpx 12rpx rgba(34, 197, 94, 0.1);">
                    <!-- Tag -->
                    <view style="position: absolute; top: 0; right: 0; background: #22c55e; color: #fff; font-size: 22rpx; padding: 8rpx 20rpx; border-bottom-left-radius: 24rpx; border-top-right-radius: 24rpx; font-weight: 600;">🌟 最快</view>
                    
                    <view style="display: flex; align-items: center; justify-content: space-between;">
                        <view style="display: flex; align-items: center; gap: 24rpx;">
                            <view style="width: 88rpx; height: 88rpx; background: #f0fdf4; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                <text style="font-size: 44rpx;">📸</text>
                            </view>
                            <view>
                                <text style="display: block; font-size: 32rpx; font-weight: 700; color: #111827; margin-bottom: 8rpx;">拍照上传</text>
                                <text style="display: block; font-size: 24rpx; color: #6b7280;">直接拍纸质表格、手写笔记</text>
                                <text style="font-size: 24rpx; color: #22c55e; font-weight: 600; margin-top: 12rpx; display: inline-block;">打开相机 ></text>
                            </view>
                        </view>
                    </view>
                </view>

                <!-- File Card -->
                <view class="action-card data-v-6c9a4f44" bindtap="{{file}}" style="background: #fff; border-radius: 24rpx; padding: 32rpx; box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05);">
                    <view style="display: flex; align-items: center; justify-content: space-between;">
                        <view style="display: flex; align-items: center; gap: 24rpx;">
                            <view style="width: 80rpx; height: 80rpx; background: #eff6ff; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                <text style="font-size: 40rpx;">📄</text>
                            </view>
                            <view>
                                <text style="display: block; font-size: 30rpx; font-weight: 700; color: #111827; margin-bottom: 4rpx;">上传文件</text>
                                <text style="display: block; font-size: 24rpx; color: #9ca3af;">支持 Excel / Word / PDF</text>
                            </view>
                        </view>
                        <text style="color: #cbd5e1; font-size: 32rpx;">></text>
                    </view>
                </view>


            </view>

            <!-- Manual Link Footer -->
            <view class="footer-link-section data-v-6c9a4f44" style="margin-top: 48rpx; text-align: center; padding-bottom: 60rpx;">
                <view style="display: flex; align-items: center; justify-content: center; gap: 12rpx; margin-bottom: 24rpx;">
                    <text class="divider-line" style="width: 40rpx; height: 1px; background: #e5e7eb;"></text>
                    <text style="font-size: 24rpx; color: #9ca3af;" bindtap="{{manual}}">或者 <text style="text-decoration: underline; color: #6b7280;">手动输入学生信息</text></text>
                    <text class="divider-line" style="width: 40rpx; height: 1px; background: #e5e7eb;"></text>
                </view>
                
                <view class="tips-box" style="background: #f3f4f6; padding: 16rpx; border-radius: 12rpx; display: inline-block;">
                    <text style="font-size: 22rpx; color: #6b7280;">💡 小树说：大多数老师直接拍照，我能识别手写字~</text>
                </view>
            </view>
        </scroll-view>
    </view>
    <view wx:if="{{ocrRes}}" class="stage-container bg-gray data-v-6c9a4f44">
        <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
            <view class="result-card data-v-6c9a4f44" style="margin-bottom: 32rpx;" wx:if="{{!isManual}}">
                <view class="row-center data-v-6c9a4f44">
                    <text class="icon-file-text data-v-6c9a4f44" style="font-size: 80rpx;">🎉</text>
                    <view class="col-left data-v-6c9a4f44">
                        <text class="card-head data-v-6c9a4f44" style="font-size: 40rpx;">识别完成!</text>
                        <text class="card-desc-gray data-v-6c9a4f44">共识别出 {{ocrList.length}} 个学生信息</text>
                    </view>
                </view>
            </view>
            <text class="section-title-sm data-v-6c9a4f44" style="margin-bottom: 24rpx;" wx:if="{{!isManual}}">请确认识别结果:</text>
            <view class="card-list data-v-6c9a4f44">
                <view wx:for="{{ocrList}}" wx:key="index" class="ocr-item data-v-6c9a4f44" style="background: #fff; padding: 32rpx; border-radius: 24rpx; margin-bottom: 24rpx; display: flex; gap: 24rpx; align-items: flex-start;">
                    <text class="check-icon data-v-6c9a4f44" style="color: #22c55e; font-size: 32rpx; margin-top: 12rpx;">✅</text>
                    <view class="ocr-content data-v-6c9a4f44" style="flex: 1;">
                        <view class="row-center data-v-6c9a4f44" style="margin-bottom: 12rpx; display: flex; align-items: center;">
                            <text class="student-id data-v-6c9a4f44" style="color: #9ca3af; font-size: 24rpx; margin-right: 16rpx;">{{index + 1}}</text>
                            <input class="student-name data-v-6c9a4f44" style="font-weight: 700; font-size: 30rpx; flex: 1; border-bottom: 1px dashed #e5e7eb; padding-bottom: 4rpx;" value="{{item.name}}" bindinput="{{handleOCRNameChange}}" data-index="{{index}}" placeholder="学生姓名" />
                            <view class="delete-icon data-v-6c9a4f44" bindtap="{{deleteStudent}}" data-index="{{index}}" style="padding: 8rpx; margin-left: 16rpx;">
                                <text style="color: #ef4444; font-size: 32rpx;">🗑️</text>
                            </view>
                        </view>
                        <textarea class="ocr-text data-v-6c9a4f44" style="color: #4b5563; font-size: 28rpx; width: 100%; min-height: 120rpx; line-height: 1.5; border: 1px solid #f3f4f6; border-radius: 12rpx; padding: 16rpx; box-sizing: border-box;" value="{{item.text}}" bindinput="{{handleOCRTextChange}}" data-index="{{index}}" placeholder="学生表现 / 关键词..." auto-height maxlength="-1" />
                    </view>
                </view>
            </view>
            <view wx:if="{{isManual}}" class="add-btn data-v-6c9a4f44" bindtap="{{addStudent}}" style="text-align: center; padding: 24rpx; background: #fff; border-radius: 24rpx; margin-bottom: 24rpx; border: 2rpx dashed #e5e7eb; color: #22c55e; font-weight: 500;">
                + 添加下一个学生
            </view>
        </scroll-view>
        <view class="fixed-footer data-v-6c9a4f44">
            <button class="btn-primary data-v-6c9a4f44" bindtap="{{confirm}}">确认无误，下一步</button>
            <view class="footer-link data-v-6c9a4f44" bindtap="{{retry}}">
                <text class="link-gray-ul data-v-6c9a4f44">重新上传</text>
            </view>
        </view>
    </view>
<view wx:if="{{batchParams}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827;">定制评语参数</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 26rpx; color: #6b7280; margin-top: 8rpx; display: block;">基于 R-T-C-F 模型生成专业评语</text>
        </view>

        <!-- R (Role) -->
        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">您的身份</text>
            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 16rpx;">
                <input class="input data-v-6c9a4f44" placeholder="高中 [学科名称 或 班主任] 教师" value="{{batchRole}}" bindinput="{{bindRole}}" />
            </view>
        </view>

        <!-- T (Task) -->
        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">评语类型 (单选)</text>
            <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 24rpx; margin-top: 16rpx;">
                <view class="pill-option data-v-6c9a4f44 {{batchType=='期末'?'pill-active':'pill-std'}}" bindtap="{{setBatchType}}" data-val="期末" style="flex:1; text-align:center; padding:16rpx; border-radius:16rpx; font-size:26rpx;">期末</view>
                <view class="pill-option data-v-6c9a4f44 {{batchType=='期中'?'pill-active':'pill-std'}}" bindtap="{{setBatchType}}" data-val="期中" style="flex:1; text-align:center; padding:16rpx; border-radius:16rpx; font-size:26rpx;">期中</view>
                <view class="pill-option data-v-6c9a4f44 {{batchType=='月度'?'pill-active':'pill-std'}}" bindtap="{{setBatchType}}" data-val="月度" style="flex:1; text-align:center; padding:16rpx; border-radius:16rpx; font-size:26rpx;">月度</view>
                <view class="pill-option data-v-6c9a4f44 {{batchType=='学科专项'?'pill-active':'pill-std'}}" bindtap="{{setBatchType}}" data-val="学科专项" style="flex:1; text-align:center; padding:16rpx; border-radius:16rpx; font-size:26rpx;">学科专项</view>
            </view>
        </view>

        <!-- C (Constraints) -->
        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">教育风格 (单选)</text>
            <view class="pills-row data-v-6c9a4f44" style="display: flex; flex-wrap: wrap; gap: 16rpx; margin-top: 16rpx;">
                <view class="pill-option data-v-6c9a4f44 {{currStyle=='成长型思维'?'pill-active':'pill-std'}}" bindtap="{{setStyle}}" data-val="成长型思维" style="padding:12rpx 32rpx; border-radius:32rpx; font-size:26rpx;">成长型思维</view>
                <view class="pill-option data-v-6c9a4f44 {{currStyle=='鼓励式教育'?'pill-active':'pill-std'}}" bindtap="{{setStyle}}" data-val="鼓励式教育" style="padding:12rpx 32rpx; border-radius:32rpx; font-size:26rpx;">鼓励式教育</view>
                <view class="pill-option data-v-6c9a4f44 {{currStyle=='激励性语言'?'pill-active':'pill-std'}}" bindtap="{{setStyle}}" data-val="激励性语言" style="padding:12rpx 32rpx; border-radius:32rpx; font-size:26rpx;">激励性语言</view>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">字数与建议</text>
            <view class="row-2 data-v-6c9a4f44" style="margin-top: 16rpx;">
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44" style="font-size: 24rpx; color: #6b7280; margin-bottom: 8rpx;">字数限制</text>
                    <view style="display: flex; gap: 12rpx;">
                        <view class="pill-option data-v-6c9a4f44 {{currWord==120?'pill-active':'pill-std'}}" bindtap="{{setWord}}" data-val="120" style="flex:1; text-align:center; padding:12rpx; border-radius:12rpx; font-size:24rpx;">120字内</view>
                        <view class="pill-option data-v-6c9a4f44 {{currWord==150?'pill-active':'pill-std'}}" bindtap="{{setWord}}" data-val="150" style="flex:1; text-align:center; padding:12rpx; border-radius:12rpx; font-size:24rpx;">150字内</view>
                    </view>
                </view>
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44" style="font-size: 24rpx; color: #6b7280; margin-bottom: 8rpx;">改进建议数</text>
                    <view style="display: flex; gap: 12rpx;">
                        <view class="pill-option data-v-6c9a4f44 {{batchActionCount==1?'pill-active':'pill-std'}}" bindtap="{{setActionCount}}" data-val="1" style="flex:1; text-align:center; padding:12rpx; border-radius:12rpx; font-size:24rpx;">1个</view>
                        <view class="pill-option data-v-6c9a4f44 {{batchActionCount==2?'pill-active':'pill-std'}}" bindtap="{{setActionCount}}" data-val="2" style="flex:1; text-align:center; padding:12rpx; border-radius:12rpx; font-size:24rpx;">2个</view>
                    </view>
                </view>
            </view>
        </view>

         <view style="height: 120rpx;"></view>
    </scroll-view>
     <view class="fixed-footer data-v-6c9a4f44">
        <button class="btn-primary data-v-6c9a4f44" bindtap="{{generate}}">开始批量生成</button>
    </view>
</view>
<view wx:if="{{batchResult}}" class="stage-container bg-gray data-v-6c9a4f44">
    <view class="nav-bar-custom data-v-6c9a4f44" style="padding: 24rpx; background: #fff; display: flex; justify-content: flex-end;">
        <text class="text-green data-v-6c9a4f44" bindtap="{{finish}}" style="color: #22c55e; font-size: 28rpx; font-weight: 500;">导出全部</text>
    </view>
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44" style="padding: 32rpx; padding-bottom: 220rpx; flex-direction: column;">
        <view wx:for="{{batchResults}}" wx:for-item="item" wx:key="name" class="result-card data-v-6c9a4f44" style="background: #fff; padding: 32rpx; border-radius: 24rpx; margin-bottom: 24rpx; box-shadow: 0 4rpx 16rpx rgba(0,0,0,0.08);">
            <view class="card-header data-v-6c9a4f44" style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 24rpx;">
                <text class="student-name data-v-6c9a4f44" style="font-size: 36rpx; font-weight: 700; color: #111827;">{{item.name}}</text>
                <view class="actions data-v-6c9a4f44" style="display: flex; gap: 32rpx;">
                    <view class="icon-wrap data-v-6c9a4f44" bindtap="{{item.onCopy}}" data-content="{{item.content}}" style="padding: 16rpx;">
                        <text class="uni-icon uni-icon-paperclip data-v-6c9a4f44" style="font-size: 40rpx; color: #9ca3af;"></text>
                    </view>
                    <view class="icon-wrap data-v-6c9a4f44" bindtap="{{item.onRegen}}" data-index="{{index}}" style="padding: 16rpx;">
                        <text class="uni-icon uni-icon-refresh data-v-6c9a4f44" style="font-size: 40rpx; color: #9ca3af;"></text>
                    </view>
                </view>
            </view>
            <text class="card-body data-v-6c9a4f44" style="font-size: 28rpx; color: #4b5563; line-height: 1.6; display: block;" user-select>{{item.content}}</text>
        </view>
    </scroll-view>
    <view class="fixed-footer row data-v-6c9a4f44" style="padding: 24rpx; background: #fff;">
        <button class="btn-outline flex-1 data-v-6c9a4f44" bindtap="{{tweak}}" style="background: #fff; border: 2rpx solid #22c55e; color: #22c55e; border-radius: 16rpx; margin-right: 24rpx;">一键微调</button>
        <button class="btn-primary flex-2 data-v-6c9a4f44" bindtap="{{finish}}" style="background: #22c55e; color: #fff; border-radius: 16rpx; flex: 2; border: 0;">全部复制 / 导出</button>
    </view>
</view><view wx:if="{{aq}}" class="stage-container bg-black center-xy data-v-6c9a4f44"><text class="icon-lg-green pulse data-v-6c9a4f44">📸</text><text class="white-title data-v-6c9a4f44">拍照小贴士</text><view class="tips-box-dark data-v-6c9a4f44"><text class="white-item data-v-6c9a4f44">✓ 光线充足，文字清晰</text><text class="white-item data-v-6c9a4f44">✓ 表格完整，不要切边</text></view><button class="btn-green-full width-80 data-v-6c9a4f44" bindtap="{{ar}}">我知道了，开始拍</button></view><view wx:if="{{as}}" class="stage-container bg-white center-xy data-v-6c9a4f44"><text class="spin icon-xl data-v-6c9a4f44">✨</text><text class="title-md data-v-6c9a4f44">小树正在奋笔疾书...</text><text class="desc-sm data-v-6c9a4f44">正在为同学们生成专属评语</text></view><view wx:if="{{at}}" class="stage-container bg-gray data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view wx:for="{{av}}" wx:for-item="r" wx:key="c" class="result-card mb-4 data-v-6c9a4f44"><text class="bold data-v-6c9a4f44">{{r.a}}</text><text class="text-sm mt-2 block data-v-6c9a4f44">{{r.b}}</text></view></scroll-view><view class="fixed-footer row data-v-6c9a4f44"><button class="btn-outline flex-1 data-v-6c9a4f44">一键微调</button><button class="btn-primary flex-2 data-v-6c9a4f44">全部复制 / 导出</button></view></view><view wx:if="{{PBL_INPUT}}" class="stage-container bg-white data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;"><text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">项目式学习 (PBL)</text><text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #9ca3af; margin-top: 8rpx; display: block;">R-T-C-F 模型驱动 | 蓝图设计</text></view><text class="section-title data-v-6c9a4f44">✍️ 填写项目关键信息</text><view class="form-group data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">学科名称</text><input class="input data-v-6c9a4f44" placeholder="我是哪科老师？如：生物" value="{{pb_subject}}" bindinput="{{pb_onSubject}}"/></view><view class="row-2 data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">年级</text><input class="input data-v-6c9a4f44" placeholder="如：初二" value="{{pb_grade}}" bindinput="{{pb_onGrade}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">项目时长</text><input class="input data-v-6c9a4f44" placeholder="如：4周" value="{{pb_duration}}" bindinput="{{pb_onDuration}}"/></view></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">C - 课程约束</text><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">项目主题 (核心)</text><input class="input data-v-6c9a4f44" placeholder="确定的方向，如：校园植物志" value="{{pb_theme}}" bindinput="{{pb_onTheme}}"/></view><view class="row-2 data-v-6c9a4f44" style="margin-top:20rpx"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">核心学科</text><input class="input data-v-6c9a4f44" placeholder="1-2个" value="{{pb_core}}" bindinput="{{pb_onCore}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">融合学科</text><input class="input data-v-6c9a4f44" placeholder="2-3个" value="{{pb_integ}}" bindinput="{{pb_onInteg}}"/></view></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">学生情况</text><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">已掌握知识</text><input class="input data-v-6c9a4f44" placeholder="3-5项已学知识点" value="{{pb_mastered}}" bindinput="{{pb_onMastered}}"/></view><view class="row-2 data-v-6c9a4f44" style="margin-top:20rpx"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">薄弱点</text><input class="input data-v-6c9a4f44" placeholder="主要困难" value="{{pb_weakness}}" bindinput="{{pb_onWeakness}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">需提升能力</text><input class="input data-v-6c9a4f44" placeholder="重点能力" value="{{pb_skills}}" bindinput="{{pb_onSkills}}"/></view></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">资源与支持</text><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">可用资源</text><input class="input data-v-6c9a4f44" placeholder="如：多媒体教室、社区..." value="{{pb_resources}}" bindinput="{{pb_onResources}}"/></view><view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx"><text class="label data-v-6c9a4f44">协同支持</text><input class="input data-v-6c9a4f44" placeholder="如：其他学科教师、家长..." value="{{pb_support}}" bindinput="{{pb_onSupport}}"/></view><view class="row-2 data-v-6c9a4f44" style="margin-top:20rpx"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">课内课时/周</text><input class="input data-v-6c9a4f44" placeholder="如: 2" value="{{pb_inClass}}" bindinput="{{pb_onInClass}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">课外投入/周</text><input class="input data-v-6c9a4f44" placeholder="如: 1" value="{{pb_outClass}}" bindinput="{{pb_onOutClass}}"/></view></view></view></scroll-view><view class="fixed-footer data-v-6c9a4f44"><button class="btn-primary data-v-6c9a4f44" style="background-color: #2563eb;" bindtap="{{pb_generate}}">生成项目式学习方案</button></view></view>
<view wx:if="{{CLUB_INPUT}}" class="stage-container bg-white data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;"><text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">社团课程设计</text><text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #9ca3af; margin-top: 8rpx; display: block;">兴趣导向 | 活动方案 | 评估机制</text></view><text class="section-title data-v-6c9a4f44">✍️ 填写社团相关信息</text><view class="form-group data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">为哪个社团设计方案?</text><input class="input data-v-6c9a4f44" placeholder="如: 文学创作社、编程社、古筝社" value="{{cl_name}}" bindinput="{{cl_onName}}"/></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">C - 约束条件</text><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">社团类型</text><input class="input data-v-6c9a4f44" placeholder="如: 艺术类、科技类" value="{{cl_type}}" bindinput="{{cl_onType}}"/></view><view class="row-2 data-v-6c9a4f44" style="margin-top:20rpx"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">年级规模</text><input class="input data-v-6c9a4f44" placeholder="如: 高一20人" value="{{cl_scale}}" bindinput="{{cl_onScale}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">课时安排</text><input class="input data-v-6c9a4f44" placeholder="如: 16周, 每周1课时" value="{{cl_schedule}}" bindinput="{{cl_onSchedule}}"/></view></view><view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx"><text class="label data-v-6c9a4f44">基础条件</text><input class="input data-v-6c9a4f44" placeholder="如: 普通教室, 多媒体教室" value="{{cl_facilities}}" bindinput="{{cl_onFacilities}}"/></view><view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx"><text class="label data-v-6c9a4f44">成果形式</text><input class="input data-v-6c9a4f44" placeholder="如: 期末展示、汇报演出" value="{{cl_outcome}}" bindinput="{{cl_onOutcome}}"/></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">培养重点 (保留1-2项)</text><view class="tags-row data-v-6c9a4f44" style="margin-top: 24rpx; display: flex; gap: 16rpx; flex-wrap: wrap;"><view wx:for="{{cl_focusOptions}}" wx:key="index" class="tag-option data-v-6c9a4f44" bindtap="{{cl_toggleFocus}}" data-val="{{item}}" style="padding: 16rpx 32rpx; border-radius: 99rpx; font-size: 26rpx; font-weight: 500; {{utils.includes(cl_focusTags, item) ? 'background: #ea580c; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">{{item}}</view></view></view></scroll-view><view class="fixed-footer data-v-6c9a4f44"><button class="btn-primary data-v-6c9a4f44" style="background-color: #ea580c;" bindtap="{{cl_generate}}">生成社团活动方案</button></view></view>
<view wx:if="{{SELECTION_INPUT}}" class="stage-container bg-white data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;"><text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">学生选科指导</text><text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #9ca3af; margin-top: 8rpx; display: block;">优势分析 | 科学决策 | 赋分最大化</text></view><text class="section-title data-v-6c9a4f44" style="color: #9333ea;">✍️ 基础信息填写</text><view class="form-group data-v-6c9a4f44"><view class="row-2 data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">所在省份</text><input class="input data-v-6c9a4f44" placeholder="如: 浙江" value="{{sl_province}}" bindinput="{{sl_onProvince}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">学校名称/类型</text><input class="input data-v-6c9a4f44" placeholder="如: 省重点" value="{{sl_school}}" bindinput="{{sl_onSchool}}"/></view></view><view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx"><text class="label data-v-6c9a4f44">学生姓名/代号</text><input class="input data-v-6c9a4f44" placeholder="如: S01李同学" value="{{sl_name}}" bindinput="{{sl_onName}}"/></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">学生基本情况</text><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">目前年级</text><input class="input data-v-6c9a4f44" placeholder="如: 高一上学期" value="{{sl_grade}}" bindinput="{{sl_onGrade}}"/></view><view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx"><text class="label data-v-6c9a4f44">各科成绩/排名</text><textarea class="textarea data-v-6c9a4f44" style="height: 120rpx;" placeholder="例如：语文110，数学125(年级前10%)，英语105，物理85..." value="{{sl_scores}}" bindinput="{{sl_onScores}}"/></view><view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx"><text class="label data-v-6c9a4f44">目标专业方向</text><input class="input data-v-6c9a4f44" placeholder="如: 偏理工、不确定" value="{{sl_major}}" bindinput="{{sl_onMajor}}"/></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">提供选科方案数量</text><view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 24rpx; margin-top: 24rpx;"><view class="pill-option data-v-6c9a4f44" bindtap="{{sl_setCount}}" data-val="2" style="flex: 1; text-align: center; padding: 20rpx 0; border-radius: 12rpx; font-weight: 500; font-size: 28rpx; {{sl_count==2 ? 'background: #9333ea; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">2种</view><view class="pill-option data-v-6c9a4f44" bindtap="{{sl_setCount}}" data-val="3" style="flex: 1; text-align: center; padding: 20rpx 0; border-radius: 12rpx; font-weight: 500; font-size: 28rpx; {{sl_count==3 ? 'background: #9333ea; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">3种</view><view class="pill-option data-v-6c9a4f44" bindtap="{{sl_setCount}}" data-val="4" style="flex: 1; text-align: center; padding: 20rpx 0; border-radius: 12rpx; font-weight: 500; font-size: 28rpx; {{sl_count==4 ? 'background: #9333ea; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">4种</view><view class="pill-option data-v-6c9a4f44" bindtap="{{sl_setCount}}" data-val="5" style="flex: 1; text-align: center; padding: 20rpx 0; border-radius: 12rpx; font-weight: 500; font-size: 28rpx; {{sl_count==5 ? 'background: #9333ea; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">5种</view></view></view><view class="advanced-section data-v-6c9a4f44"><view class="toggle-btn data-v-6c9a4f44" bindtap="{{sl_toggle}}"><text class="data-v-6c9a4f44" style="color: #9333ea;">{{sl_expandText}}</text><text class="{{['data-v-6c9a4f44', 'arrow', sl_arrow]}}" style="color: #9333ea;">▼</text></view><view wx:if="{{sl_isOpen}}" class="advanced-content fade-in data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">目标院校层次</text><input class="input data-v-6c9a4f44" placeholder="如: 冲985, 稳211" value="{{sl_college}}" bindinput="{{sl_onCollege}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">兴趣特长</text><input class="input data-v-6c9a4f44" placeholder="如: 喜欢编程, 对历史感兴趣" value="{{sl_interest}}" bindinput="{{sl_onInterest}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">性格特点</text><input class="input data-v-6c9a4f44" placeholder="如: 沉稳、逻辑强" value="{{sl_personality}}" bindinput="{{sl_onPersonality}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">职业倾向</text><input class="input data-v-6c9a4f44" placeholder="如: 软件工程师、医生" value="{{sl_career}}" bindinput="{{sl_onCareer}}"/></view></view></view></scroll-view><view class="fixed-footer data-v-6c9a4f44"><button class="btn-primary data-v-6c9a4f44" style="background-color: #9333ea;" bindtap="{{sl_generate}}">生成选科建议方案</button></view></view><view wx:if="{{PSYCH_INPUT}}" class="stage-container bg-white data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;"><text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">学生心理疏导</text><text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #db2777; margin-top: 8rpx; display: block;">共情沟通 | 辅导策略 | 家校联动</text></view><text class="section-title data-v-6c9a4f44" style="color: #db2777;">✍️ 填写学生信息</text><view class="form-group data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">基本情况</text><input class="input data-v-6c9a4f44" placeholder="如: S03李同学，平时比较内向" value="{{py_student}}" bindinput="{{py_onStudent}}"/></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">核心问题</text><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">问题类型</text><view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; flex-wrap: wrap; margin-top: 16rpx;"><view class="pill-option data-v-6c9a4f44" bindtap="{{py_setType}}" data-val="考试焦虑" style="padding: 12rpx 24rpx; border-radius: 99rpx; font-size: 24rpx; {{py_type=='考试焦虑' ? 'background: #db2777; color: #fff;' : 'background: #fce7f3; color: #831843;'}}">考试焦虑</view><view class="pill-option data-v-6c9a4f44" bindtap="{{py_setType}}" data-val="人际冲突" style="padding: 12rpx 24rpx; border-radius: 99rpx; font-size: 24rpx; {{py_type=='人际冲突' ? 'background: #db2777; color: #fff;' : 'background: #fce7f3; color: #831843;'}}">人际冲突</view><view class="pill-option data-v-6c9a4f44" bindtap="{{py_setType}}" data-val="情绪低落" style="padding: 12rpx 24rpx; border-radius: 99rpx; font-size: 24rpx; {{py_type=='情绪低落' ? 'background: #db2777; color: #fff;' : 'background: #fce7f3; color: #831843;'}}">情绪低落</view><view class="pill-option data-v-6c9a4f44" bindtap="{{py_setType}}" data-val="其他" style="padding: 12rpx 24rpx; border-radius: 99rpx; font-size: 24rpx; {{py_type=='其他' ? 'background: #db2777; color: #fff;' : 'background: #fce7f3; color: #831843;'}}">其他</view></view></view><view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx"><text class="label data-v-6c9a4f44">问题表现</text><input class="input data-v-6c9a4f44" placeholder="如: 每次大考前失眠，与同学冷战..." value="{{py_mani}}" bindinput="{{py_onMani}}"/></view><view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx"><text class="label data-v-6c9a4f44">持续时间</text><input class="input data-v-6c9a4f44" placeholder="如: 已持续3周" value="{{py_duration}}" bindinput="{{py_onDuration}}"/></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">风险等级评估 (单选)</text><view class="pills-column data-v-6c9a4f44" style="display: flex; flex-direction: column; gap: 16rpx; margin-top: 16rpx;"><view class="pill-option data-v-6c9a4f44" bindtap="{{py_setRisk}}" data-val="低风险" style="padding: 24rpx; border-radius: 16rpx; font-size: 26rpx; border: 2rpx solid transparent; {{py_risk=='低风险' ? 'background: #fdf2f8; border-color: #db2777; color: #831843;' : 'background: #f9fafb; color: #4b5563;'}}"><text class="bold data-v-6c9a4f44">低风险</text><text class="block data-v-6c9a4f44" style="font-size: 22rpx; opacity: 0.8; margin-top: 4rpx;">情绪困扰，但能正常学习生活</text></view><view class="pill-option data-v-6c9a4f44" bindtap="{{py_setRisk}}" data-val="中风险" style="padding: 24rpx; border-radius: 16rpx; font-size: 26rpx; border: 2rpx solid transparent; {{py_risk=='中风险' ? 'background: #fdf2f8; border-color: #db2777; color: #831843;' : 'background: #f9fafb; color: #4b5563;'}}"><text class="bold data-v-6c9a4f44">中风险</text><text class="block data-v-6c9a4f44" style="font-size: 22rpx; opacity: 0.8; margin-top: 4rpx;">影响日常功能，如失眠、食欲下降</text></view><view class="pill-option data-v-6c9a4f44" bindtap="{{py_setRisk}}" data-val="高风险" style="padding: 24rpx; border-radius: 16rpx; font-size: 26rpx; border: 2rpx solid transparent; {{py_risk=='高风险' ? 'background: #fdf2f8; border-color: #db2777; color: #831843;' : 'background: #f9fafb; color: #4b5563;'}}"><text class="bold data-v-6c9a4f44">高风险</text><text class="block data-v-6c9a4f44" style="font-size: 22rpx; opacity: 0.8; margin-top: 4rpx;">自伤计划 / 严重社交隔离 / 强度≥8分</text></view></view></view><view class="advanced-section data-v-6c9a4f44"><view class="toggle-btn data-v-6c9a4f44" bindtap="{{py_toggle}}"><text class="data-v-6c9a4f44" style="color: #db2777;">{{py_expandText}}</text><text class="{{['data-v-6c9a4f44', 'arrow', py_arrow]}}" style="color: #db2777;">▼</text></view><view wx:if="{{py_isOpen}}" class="advanced-content fade-in data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">触发因素</text><input class="input data-v-6c9a4f44" placeholder="如: 期中考试成绩下滑" value="{{py_trigger}}" bindinput="{{py_onTrigger}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">情绪强度 (0-10)</text><input class="input data-v-6c9a4f44" placeholder="如: 7分 - 明显影响日常" value="{{py_intensity}}" bindinput="{{py_onIntensity}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">学生性格</text><input class="input data-v-6c9a4f44" placeholder="如: 内向、不善表达" value="{{py_personality}}" bindinput="{{py_onPersonality}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">支持系统</text><input class="input data-v-6c9a4f44" placeholder="如: 父母和睦，有2-3个好友" value="{{py_support}}" bindinput="{{py_onSupport}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">已尝试方法</text><input class="input data-v-6c9a4f44" placeholder="如: 试过深呼吸，效果不明显" value="{{py_tried}}" bindinput="{{py_onTried}}"/></view></view></view></scroll-view><view class="fixed-footer data-v-6c9a4f44"><button class="btn-primary data-v-6c9a4f44" style="background-color: #db2777;" bindtap="{{py_generate}}">生成心理辅导策略</button></view></view><view wx:if="{{CONFLICT_INPUT}}" class="stage-container bg-white data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;"><text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">处理学生矛盾</text><text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #2563eb; margin-top: 8rpx; display: block;">基于非暴力沟通的调解方案</text></view><text class="section-title data-v-6c9a4f44" style="color: #2563eb;">✍️ 矛盾基本信息</text><view class="form-group data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">涉及学生及年级</text><input class="input data-v-6c9a4f44" placeholder="用A同学、B同学代称" value="{{cf_students}}" bindinput="{{cf_onStudents}}"/></view><view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx"><text class="label data-v-6c9a4f44">时间地点</text><input class="input data-v-6c9a4f44" placeholder="简要描述时间和地点" value="{{cf_time}}" bindinput="{{cf_onTime}}"/></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">C (约束) : 矛盾详情</text><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">矛盾类型</text><view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; flex-wrap: wrap; margin-top: 16rpx;"><view class="pill-option data-v-6c9a4f44" bindtap="{{cf_setType}}" data-val="打架" style="padding: 12rpx 24rpx; border-radius: 99rpx; font-size: 24rpx; {{cf_type=='打架' ? 'background: #2563eb; color: #fff;' : 'background: #eff6ff; color: #1e40af;'}}">打架</view><view class="pill-option data-v-6c9a4f44" bindtap="{{cf_setType}}" data-val="早恋" style="padding: 12rpx 24rpx; border-radius: 99rpx; font-size: 24rpx; {{cf_type=='早恋' ? 'background: #2563eb; color: #fff;' : 'background: #eff6ff; color: #1e40af;'}}">早恋</view><view class="pill-option data-v-6c9a4f44" bindtap="{{cf_setType}}" data-val="欺凌" style="padding: 12rpx 24rpx; border-radius: 99rpx; font-size: 24rpx; {{cf_type=='欺凌' ? 'background: #2563eb; color: #fff;' : 'background: #eff6ff; color: #1e40af;'}}">欺凌</view><view class="pill-option data-v-6c9a4f44" bindtap="{{cf_setType}}" data-val="网暴" style="padding: 12rpx 24rpx; border-radius: 99rpx; font-size: 24rpx; {{cf_type=='网暴' ? 'background: #2563eb; color: #fff;' : 'background: #eff6ff; color: #1e40af;'}}">网暴</view><view class="pill-option data-v-6c9a4f44" bindtap="{{cf_setType}}" data-val="其他" style="padding: 12rpx 24rpx; border-radius: 99rpx; font-size: 24rpx; {{cf_type=='其他' ? 'background: #2563eb; color: #fff;' : 'background: #eff6ff; color: #1e40af;'}}">其他</view></view></view><view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx"><text class="label data-v-6c9a4f44">核心冲突</text><input class="input data-v-6c9a4f44" placeholder="一句话概括" value="{{cf_content}}" bindinput="{{cf_onContent}}"/></view></view><view class="advanced-section data-v-6c9a4f44"><view class="toggle-btn data-v-6c9a4f44" bindtap="{{cf_toggle}}"><text class="data-v-6c9a4f44" style="color: #2563eb;">{{cf_expandText}}</text><text class="{{['data-v-6c9a4f44', 'arrow', cf_arrow]}}" style="color: #2563eb;">▼</text></view><view wx:if="{{cf_isOpen}}" class="advanced-content fade-in data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">目击者描述</text><input class="input data-v-6c9a4f44" placeholder="选填" value="{{cf_witness}}" bindinput="{{cf_onWitness}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">已采取措施</text><input class="input data-v-6c9a4f44" placeholder="选填" value="{{cf_actions}}" bindinput="{{cf_onActions}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">家长态度</text><input class="input data-v-6c9a4f44" placeholder="选填" value="{{cf_parent}}" bindinput="{{cf_onParent}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">当事人平时表现</text><input class="input data-v-6c9a4f44" placeholder="选填" value="{{cf_behavior}}" bindinput="{{cf_onBehavior}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">处理基调</text><view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;"><view class="pill-option data-v-6c9a4f44" bindtap="{{cf_setTone}}" data-val="以调解为主" style="flex: 1; text-align: center; padding: 12rpx 0; border-radius: 12rpx; font-size: 24rpx; {{cf_tone=='以调解为主' ? 'background: #2563eb; color: #fff;' : 'background: #eff6ff; color: #1e40af;'}}">以调解为主</view><view class="pill-option data-v-6c9a4f44" bindtap="{{cf_setTone}}" data-val="以严肃纪律为主" style="flex: 1; text-align: center; padding: 12rpx 0; border-radius: 12rpx; font-size: 24rpx; {{cf_tone=='以严肃纪律为主' ? 'background: #2563eb; color: #fff;' : 'background: #eff6ff; color: #1e40af;'}}">以严肃纪律为主</view></view></view></view></view></scroll-view><view class="fixed-footer data-v-6c9a4f44"><button class="btn-primary data-v-6c9a4f44" style="background-color: #2563eb;" bindtap="{{cf_generate}}">生成调解方案</button></view></view><view wx:if="{{QUIZ_INPUT}}" class="stage-container bg-white data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;"><text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">快速课堂出题</text><text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #9ca3af; margin-top: 8rpx; display: block;">智能生成 | 个性化定制 | 即时可用</text></view><text class="section-title data-v-6c9a4f44" style="color: #9333ea;">✍️ 基础信息</text><view class="form-group data-v-6c9a4f44"><view class="row-2 data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">学科</text><input class="input data-v-6c9a4f44" placeholder="如: 数学" value="{{qz_subject}}" bindinput="{{qz_onSubject}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">年级</text><input class="input data-v-6c9a4f44" placeholder="如: 初二" value="{{qz_grade}}" bindinput="{{qz_onGrade}}"/></view></view><view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx"><text class="label data-v-6c9a4f44">知识点/课题</text><input class="input data-v-6c9a4f44" placeholder="如: 勾股定理" value="{{qz_topic}}" bindinput="{{qz_onTopic}}"/></view><view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx"><text class="label data-v-6c9a4f44">出题数量</text><input class="input data-v-6c9a4f44" placeholder="如: 5" value="{{qz_count}}" bindinput="{{qz_onCount}}"/></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">C (约束)</text><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">学生易错点 (选填)</text><input class="input data-v-6c9a4f44" placeholder="如: 分不清..." value="{{qz_misconceptions}}" bindinput="{{qz_onMisconceptions}}"/></view><view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx"><text class="label data-v-6c9a4f44">特别说明 (选填)</text><input class="input data-v-6c9a4f44" placeholder="如: 不要太综合..." value="{{qz_instructions}}" bindinput="{{qz_onInstructions}}"/></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">使用目的 (单选)</text><view class="pills-column data-v-6c9a4f44" style="display: flex; flex-direction: column; gap: 16rpx; margin-top: 16rpx;"><view class="pill-option data-v-6c9a4f44" bindtap="{{qz_setPurpose}}" data-val="基础巩固" style="padding: 24rpx; border-radius: 16rpx; font-size: 26rpx; border: 2rpx solid transparent; {{qz_purpose=='基础巩固' ? 'background: #f3e8ff; border-color: #9333ea; color: #7e22ce;' : 'background: #f9fafb; color: #4b5563;'}}"><text class="bold data-v-6c9a4f44">基础巩固</text><text class="block data-v-6c9a4f44" style="font-size: 22rpx; opacity: 0.8; margin-top: 4rpx;">重点考查记忆、理解</text></view><view class="pill-option data-v-6c9a4f44" bindtap="{{qz_setPurpose}}" data-val="能力提升" style="padding: 24rpx; border-radius: 16rpx; font-size: 26rpx; border: 2rpx solid transparent; {{qz_purpose=='能力提升' ? 'background: #f3e8ff; border-color: #9333ea; color: #7e22ce;' : 'background: #f9fafb; color: #4b5563;'}}"><text class="bold data-v-6c9a4f44">能力提升</text><text class="block data-v-6c9a4f44" style="font-size: 22rpx; opacity: 0.8; margin-top: 4rpx;">重点考查应用、分析</text></view><view class="pill-option data-v-6c9a4f44" bindtap="{{qz_setPurpose}}" data-val="综合拔高" style="padding: 24rpx; border-radius: 16rpx; font-size: 26rpx; border: 2rpx solid transparent; {{qz_purpose=='综合拔高' ? 'background: #f3e8ff; border-color: #9333ea; color: #7e22ce;' : 'background: #f9fafb; color: #4b5563;'}}"><text class="bold data-v-6c9a4f44">综合拔高</text><text class="block data-v-6c9a4f44" style="font-size: 22rpx; opacity: 0.8; margin-top: 4rpx;">重点考查评价、创造</text></view></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">班级水平 (单选)</text><view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;"><view class="pill-option data-v-6c9a4f44" bindtap="{{qz_setLevel}}" data-val="基础较弱" style="flex: 1; text-align: center; padding: 16rpx 0; border-radius: 12rpx; font-size: 24rpx; {{qz_level=='基础较弱' ? 'background: #9333ea; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">基础较弱</view><view class="pill-option data-v-6c9a4f44" bindtap="{{qz_setLevel}}" data-val="中等水平" style="flex: 1; text-align: center; padding: 16rpx 0; border-radius: 12rpx; font-size: 24rpx; {{qz_level=='中等水平' ? 'background: #9333ea; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">中等水平</view><view class="pill-option data-v-6c9a4f44" bindtap="{{qz_setLevel}}" data-val="基础较好" style="flex: 1; text-align: center; padding: 16rpx 0; border-radius: 12rpx; font-size: 24rpx; {{qz_level=='基础较好' ? 'background: #9333ea; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">基础较好</view></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">学生差异 (单选)</text><view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;"><view class="pill-option data-v-6c9a4f44" bindtap="{{qz_setDiff}}" data-val="差异较大" style="flex: 1; text-align: center; padding: 16rpx 0; border-radius: 12rpx; font-size: 24rpx; {{qz_diff=='差异较大' ? 'background: #9333ea; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">差异较大</view><view class="pill-option data-v-6c9a4f44" bindtap="{{qz_setDiff}}" data-val="相对均衡" style="flex: 1; text-align: center; padding: 16rpx 0; border-radius: 12rpx; font-size: 24rpx; {{qz_diff=='相对均衡' ? 'background: #9333ea; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">相对均衡</view></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">设备条件 (单选)</text><view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;"><view class="pill-option data-v-6c9a4f44" bindtap="{{qz_setEquip}}" data-val="可投影" style="flex: 1; text-align: center; padding: 16rpx 0; border-radius: 12rpx; font-size: 24rpx; {{qz_equip=='可投影' ? 'background: #9333ea; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">可投影</view><view class="pill-option data-v-6c9a4f44" bindtap="{{qz_setEquip}}" data-val="仅黑板" style="flex: 1; text-align: center; padding: 16rpx 0; border-radius: 12rpx; font-size: 24rpx; {{qz_equip=='仅黑板' ? 'background: #9333ea; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">仅黑板</view></view></view></scroll-view><view class="fixed-footer data-v-6c9a4f44"><button class="btn-primary data-v-6c9a4f44" style="background-color: #9333ea;" bindtap="{{qz_generate}}">生成课堂练习</button></view></view>
<view wx:if="{{PAPER_ASSESS}}" class="stage-container bg-white data-v-6c9a4f44"><scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44"><view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;"><text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">试卷质量评估</text><text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #9333ea; margin-top: 8rpx; display: block;">智能分析 | 质量诊断 | 改进建议</text></view><text class="section-title data-v-6c9a4f44" style="color: #9333ea;">✍️ 基础信息</text><view class="form-group data-v-6c9a4f44"><view class="row-2 data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">学科</text><input class="input data-v-6c9a4f44" placeholder="如: 数学" value="{{pp_subject}}" bindinput="{{pp_onSubject}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">年级</text><input class="input data-v-6c9a4f44" placeholder="如: 初三" value="{{pp_grade}}" bindinput="{{pp_onGrade}}"/></view></view><view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx"><text class="label data-v-6c9a4f44">试卷名称</text><input class="input data-v-6c9a4f44" placeholder="如: 期中模拟卷" value="{{pp_name}}" bindinput="{{pp_onName}}"/></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">考试参数</text><view class="row-2 data-v-6c9a4f44"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">考试时长(分钟)</text><input class="input data-v-6c9a4f44" placeholder="如: 120" value="{{pp_duration}}" bindinput="{{pp_onDuration}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">卷面总分</text><input class="input data-v-6c9a4f44" placeholder="如: 120" value="{{pp_totalScore}}" bindinput="{{pp_onTotalScore}}"/></view></view><view class="row-2 data-v-6c9a4f44" style="margin-top: 20rpx;"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">班级平均分</text><input class="input data-v-6c9a4f44" placeholder="如: 95" value="{{pp_classAvg}}" bindinput="{{pp_onClassAvg}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">预期平均分</text><input class="input data-v-6c9a4f44" placeholder="如: 100" value="{{pp_expectedAvg}}" bindinput="{{pp_onExpectedAvg}}"/></view></view><view class="row-2 data-v-6c9a4f44" style="margin-top: 20rpx;"><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">及格率(%)</text><input class="input data-v-6c9a4f44" placeholder="如: 85" value="{{pp_passRate}}" bindinput="{{pp_onPassRate}}"/></view><view class="input-wrap data-v-6c9a4f44"><text class="label data-v-6c9a4f44">优秀率(%)</text><input class="input data-v-6c9a4f44" placeholder="如: 30" value="{{pp_excRate}}" bindinput="{{pp_onExcRate}}"/></view></view><view class="input-wrap data-v-6c9a4f44" style="margin-top:20rpx"><text class="label data-v-6c9a4f44">班级学情特征 (选填)</text><input class="input data-v-6c9a4f44" placeholder="如: 基础较好但计算易错..." value="{{pp_classFeatures}}" bindinput="{{pp_onClassFeatures}}"/></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">评估重点 (多选)</text><view class="tags-row data-v-6c9a4f44" style="margin-top: 24rpx; display: flex; gap: 16rpx; flex-wrap: wrap;"><view wx:for="{{pp_focusOptions}}" wx:key="index" class="tag-option data-v-6c9a4f44" bindtap="{{pp_toggleFocus}}" data-val="{{item}}" style="padding: 16rpx 32rpx; border-radius: 99rpx; font-size: 26rpx; font-weight: 500; {{utils.includes(pp_focusTags, item) ? 'background: #9333ea; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">{{item}}</view></view></view><view class="divider-box data-v-6c9a4f44"><text class="divider-label data-v-6c9a4f44">试卷内容来源</text><view class="content-toggle-row data-v-6c9a4f44" style="display: flex; gap: 24rpx; margin-top: 24rpx; margin-bottom: 24rpx;"><view class="toggle-option data-v-6c9a4f44" bindtap="{{pp_setType}}" data-val="file" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{pp_contentType=='file' ? '#9333ea' : '#e5e7eb'}}; background: {{pp_contentType=='file' ? '#f3e8ff' : '#fff'}};"><text class="icon data-v-6c9a4f44">📄</text><text class="text data-v-6c9a4f44">上传文件</text></view><view class="toggle-option data-v-6c9a4f44" bindtap="{{pp_setType}}" data-val="manual" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{pp_contentType=='manual' ? '#9333ea' : '#e5e7eb'}}; background: {{pp_contentType=='manual' ? '#f3e8ff' : '#fff'}};"> <text class="icon data-v-6c9a4f44">✍️</text><text class="text data-v-6c9a4f44">手动输入</text></view></view><view wx:if="{{pp_contentType=='file'}}" class="upload-area data-v-6c9a4f44" bindtap="{{pp_upload}}" style="border: 2rpx dashed #d8b4fe; border-radius: 16rpx; padding: 48rpx; text-align: center; background: #faf5ff;"><text class="icon-lg data-v-6c9a4f44" style="font-size: 64rpx; display: block; margin-bottom: 16rpx;">{{utils.includes(pp_content, '[已上传文件]') ? '✅' : '☁️'}}</text><text class="upload-title data-v-6c9a4f44" style="color: #6b21a8; font-weight: 500;">{{utils.includes(pp_content, '[已上传文件]') ? pp_content : '点击上传试卷/题目文件'}}</text><text wx:if="{{!utils.includes(pp_content, '[已上传文件]')}}" class="upload-sub data-v-6c9a4f44" style="color: #9ca3af; font-size: 24rpx; margin-top: 8rpx; display: block;">支持 Word / PDF / 图片</text></view><view wx:if="{{pp_contentType=='manual'}}" class="manual-area data-v-6c9a4f44"><textarea class="textarea data-v-6c9a4f44" style="height: 300rpx;" placeholder="请粘贴题目内容，或直接输入题目..." value="{{pp_content}}" bindinput="{{pp_onContent}}"/></view></view><view style="height: 120rpx;"></view></scroll-view><view class="fixed-footer data-v-6c9a4f44"><button class="btn-primary data-v-6c9a4f44" style="background-color: #9333ea;" bindtap="{{pp_generate}}">生成评估报告</button></view></view>
<view wx:if="{{ADAPT_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">题目改编优化</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #4f46e5; margin-top: 8rpx; display: block;">智能改编 | 多维优化 | 精准定制</text>
        </view>
        <text class="section-title data-v-6c9a4f44" style="color: #4f46e5;">✍️ 基础信息</text>
        <view class="form-group data-v-6c9a4f44">
            <view class="row-2 data-v-6c9a4f44">
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">学科</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 初中数学" value="{{ad_subject}}" bindinput="{{ad_onSubject}}"/>
                </view>
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">目标年级</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 九年级" value="{{ad_grade}}" bindinput="{{ad_onGrade}}"/>
                </view>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">原题详情</text>
            <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">原题内容 <text class="red data-v-6c9a4f44">*</text></text>
                <textarea class="textarea data-v-6c9a4f44" style="height: 240rpx;" placeholder="粘贴完整题目..." value="{{ad_content}}" bindinput="{{ad_onContent}}"/>
            </view>
            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">原题答案 (可选)</text>
                <textarea class="textarea data-v-6c9a4f44" style="height: 120rpx;" placeholder="如有请粘贴，无则标注'无答案'" value="{{ad_answer}}" bindinput="{{ad_onAnswer}}"/>
            </view>
            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">核心考点</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 二次函数图像平移" value="{{ad_corePoint}}" bindinput="{{ad_onCorePoint}}"/>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
            <view bindtap="{{ad_toggleAdv}}" class="toggle-header" style="display: flex; justify-content: space-between; align-items: center; padding: 12rpx 0;">
                <text class="divider-label data-v-6c9a4f44" style="margin-bottom:0;">改编创新需求 (选填)</text>
                 <text class="uni-icon data-v-6c9a4f44" style="font-size: 24rpx; color: #6b7280; transform: rotate({{ad_isAdv?180:0}}deg); transition: all 0.3s;">▼</text>
            </view>
            
            <view wx:if="{{ad_isAdv}}" class="advanced-area data-v-6c9a4f44" style="margin-top: 16rpx;">
                <!-- 1. Textbook -->
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44" style="font-size: 26rpx; color: #374151;">1. 教材适配 (原版本 ➔ 目标版本)</text>
                    <view style="display: flex; gap: 16rpx; margin-top: 12rpx;">
                        <input class="input data-v-6c9a4f44" style="flex:1" placeholder="如: 人教版" value="{{ad_tbOrigin}}" bindinput="{{ad_onTbOrigin}}"/>
                         <text style="align-self:center; color:#9ca3af;">➔</text>
                        <input class="input data-v-6c9a4f44" style="flex:1" placeholder="如: 北师大版" value="{{ad_tbTarget}}" bindinput="{{ad_onTbTarget}}"/>
                    </view>
                </view>

                <!-- 2. Context -->
                 <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                    <text class="label data-v-6c9a4f44" style="font-size: 26rpx; color: #374151;">2. 情境本土化 (外地 ➔ 本地 / 国外 ➔ 国内)</text>
                    <input class="input data-v-6c9a4f44" style="margin-top: 12rpx;" placeholder="如: 将背景改为杭州西湖" value="{{ad_context}}" bindinput="{{ad_onContext}}"/>
                </view>

                <!-- 3. Modernize -->
                 <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                    <text class="label data-v-6c9a4f44" style="font-size: 26rpx; color: #374151;">3. 内容时代化 (更新数据 / 加入前沿元素)</text>
                    <input class="input data-v-6c9a4f44" style="margin-top: 12rpx;" placeholder="如: 加入人工智能相关背景" value="{{ad_modernize}}" bindinput="{{ad_onModernize}}"/>
                </view>

                 <!-- 4. Difficulty -->
                <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                    <text class="label data-v-6c9a4f44" style="font-size: 26rpx; color: #374151;">4. 难度调整</text>
                    <view class="segmented-control data-v-6c9a4f44" style="display: flex; background: #f3f4f6; border-radius: 12rpx; padding: 6rpx; margin-top: 12rpx;">
                        <view bindtap="{{ad_setDiff}}" data-val="lower" style="flex: 1; text-align: center; padding: 12rpx; font-size: 26rpx; border-radius: 10rpx; transition: all 0.2s; {{ad_diff=='lower'?'background:#fff;box-shadow:0 2rpx 4rpx rgba(0,0,0,0.05);color:#4f46e5;font-weight:500;':'color:#6b7280;'}}">降低</view>
                        <view bindtap="{{ad_setDiff}}" data-val="maintain" style="flex: 1; text-align: center; padding: 12rpx; font-size: 26rpx; border-radius: 10rpx; transition: all 0.2s; {{ad_diff=='maintain'?'background:#fff;box-shadow:0 2rpx 4rpx rgba(0,0,0,0.05);color:#4f46e5;font-weight:500;':'color:#6b7280;'}}">保持</view>
                        <view bindtap="{{ad_setDiff}}" data-val="higher" style="flex: 1; text-align: center; padding: 12rpx; font-size: 26rpx; border-radius: 10rpx; transition: all 0.2s; {{ad_diff=='higher'?'background:#fff;box-shadow:0 2rpx 4rpx rgba(0,0,0,0.05);color:#4f46e5;font-weight:500;':'color:#6b7280;'}}">提高</view>
                    </view>
                </view>

                 <!-- 5. Answer -->
                <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                    <text class="label data-v-6c9a4f44" style="font-size: 26rpx; color: #374151;">5. 答案完善 (可选)</text>
                    <view class="segmented-control data-v-6c9a4f44" style="display: flex; background: #f3f4f6; border-radius: 12rpx; padding: 6rpx; margin-top: 12rpx;">
                         <view bindtap="{{ad_setAnsReq}}" data-val="" style="flex: 1; text-align: center; padding: 12rpx; font-size: 26rpx; border-radius: 10rpx; transition: all 0.2s; {{ad_ansReq==''?'background:#fff;box-shadow:0 2rpx 4rpx rgba(0,0,0,0.05);color:#4f46e5;font-weight:500;':'color:#6b7280;'}}">不选</view>
                        <view bindtap="{{ad_setAnsReq}}" data-val="generate" style="flex: 1; text-align: center; padding: 12rpx; font-size: 26rpx; border-radius: 10rpx; transition: all 0.2s; {{ad_ansReq=='generate'?'background:#fff;box-shadow:0 2rpx 4rpx rgba(0,0,0,0.05);color:#4f46e5;font-weight:500;':'color:#6b7280;'}}">需生成</view>
                        <view bindtap="{{ad_setAnsReq}}" data-val="explain" style="flex: 1; text-align: center; padding: 12rpx; font-size: 26rpx; border-radius: 10rpx; transition: all 0.2s; {{ad_ansReq=='explain'?'background:#fff;box-shadow:0 2rpx 4rpx rgba(0,0,0,0.05);color:#4f46e5;font-weight:500;':'color:#6b7280;'}}">需详解</view>
                    </view>
                </view>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">风格与要求</text>
             <view class="style-row data-v-6c9a4f44" style="margin-top: 16rpx; display: flex; gap: 32rpx;">
                <view bindtap="{{ad_setStyle}}" data-val="maintain" style="display: flex; align-items: center; gap: 12rpx;">
                    <view style="width: 32rpx; height: 32rpx; border-radius: 50%; border: 2rpx solid {{ad_style=='maintain'?'#4f46e5':'#d1d5db'}}; display: flex; align-items: center; justify-content: center;">
                        <view wx:if="{{ad_style=='maintain'}}" style="width: 16rpx; height: 16rpx; background: #4f46e5; border-radius: 50%;"></view>
                    </view>
                    <text style="font-size: 28rpx; color: #374151;">保持原风格</text>
                </view>
                <view bindtap="{{ad_setStyle}}" data-val="context" style="display: flex; align-items: center; gap: 12rpx;">
                     <view style="width: 32rpx; height: 32rpx; border-radius: 50%; border: 2rpx solid {{ad_style=='context'?'#4f46e5':'#d1d5db'}}; display: flex; align-items: center; justify-content: center;">
                        <view wx:if="{{ad_style=='context'}}" style="width: 16rpx; height: 16rpx; background: #4f46e5; border-radius: 50%;"></view>
                    </view>
                    <text style="font-size: 28rpx; color: #374151;">增加背景情境</text>
                </view>
             </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">特别要求 (可选)</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 必须避免出现的知识点..." value="{{ad_special}}" bindinput="{{ad_onSpecial}}"/>
             </view>
        </view>

        <view style="height: 120rpx;"></view>
    </scroll-view>
    <view class="fixed-footer data-v-6c9a4f44">
        <button class="btn-primary data-v-6c9a4f44" style="background-color: #4f46e5;" bindtap="{{ad_generate}}">开始改编优化</button>
    </view>
</view>

<view wx:if="{{MISTAKE_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">错题强化训练</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #d97706; margin-top: 8rpx; display: block;">智能诊断 | 精准补救 | 举一反三</text>
        </view>
        <text class="section-title data-v-6c9a4f44" style="color: #d97706;">✍️ 基础信息</text>
        <view class="form-group data-v-6c9a4f44">
            <view class="row-2 data-v-6c9a4f44">
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">学科</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 初二物理" value="{{mt_subject}}" bindinput="{{mt_onSubject}}"/>
                </view>
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">生成题目数量</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 3" value="{{mt_count}}" bindinput="{{mt_onCount}}"/>
                </view>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">错题详情</text>
             <view class="row-2 data-v-6c9a4f44">
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">年级</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 八年级" value="{{mt_grade}}" bindinput="{{mt_onGrade}}"/>
                </view>
                 <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">班级统计</text>
                     <view style="display: flex; gap: 12rpx;">
                         <input class="input data-v-6c9a4f44" style="flex:1" placeholder="做对人数" value="{{mt_total}}" bindinput="{{mt_onTotal}}"/>
                         <input class="input data-v-6c9a4f44" style="flex:1" placeholder="做错人数" value="{{mt_error}}" bindinput="{{mt_onError}}"/>
                     </view>
                </view>
            </view>
            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">错题内容 (含答案) <text class="red data-v-6c9a4f44">*</text></text>
                <textarea class="textarea data-v-6c9a4f44" style="height: 240rpx;" placeholder="粘贴题目及标准答案..." value="{{mt_content}}" bindinput="{{mt_onContent}}"/>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">诊断分析</text>
            <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">错误类型 (单选)</text>
                <view class="tags-row data-v-6c9a4f44" style="margin-top: 16rpx; display: flex; gap: 16rpx; flex-wrap: wrap;">
                    <view class="tag-option data-v-6c9a4f44" bindtap="{{mt_setType}}" data-val="概念理解偏差" style="padding: 16rpx 32rpx; border-radius: 99rpx; font-size: 26rpx; {{mt_type=='概念理解偏差'?'background:#d97706;color:#fff;':'background:#fff7ed;color:#9a3412;'}}">概念理解偏差</view>
                    <view class="tag-option data-v-6c9a4f44" bindtap="{{mt_setType}}" data-val="方法运用不当" style="padding: 16rpx 32rpx; border-radius: 99rpx; font-size: 26rpx; {{mt_type=='方法运用不当'?'background:#d97706;color:#fff;':'background:#fff7ed;color:#9a3412;'}}">方法运用不当</view>
                    <view class="tag-option data-v-6c9a4f44" bindtap="{{mt_setType}}" data-val="审题失误" style="padding: 16rpx 32rpx; border-radius: 99rpx; font-size: 26rpx; {{mt_type=='审题失误'?'background:#d97706;color:#fff;':'background:#fff7ed;color:#9a3412;'}}">审题失误</view>
                    <view class="tag-option data-v-6c9a4f44" bindtap="{{mt_setType}}" data-val="计算出错" style="padding: 16rpx 32rpx; border-radius: 99rpx; font-size: 26rpx; {{mt_type=='计算出错'?'background:#d97706;color:#fff;':'background:#fff7ed;color:#9a3412;'}}">计算出错</view>
                     <view class="tag-option data-v-6c9a4f44" bindtap="{{mt_setType}}" data-val="表达不规范" style="padding: 16rpx 32rpx; border-radius: 99rpx; font-size: 26rpx; {{mt_type=='表达不规范'?'background:#d97706;color:#fff;':'background:#fff7ed;color:#9a3412;'}}">表达不规范</view>
                </view>
            </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">学生典型错误 (可选)</text>
                <input class="input data-v-6c9a4f44" placeholder="举1-2个具体例子..." value="{{mt_typical}}" bindinput="{{mt_onTypical}}"/>
             </view>
        </view>

         <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">强化目标与场景</text>
             <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">强化目标 (可选)</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 厘清xx概念" value="{{mt_goal}}" bindinput="{{mt_onGoal}}"/>
             </view>
              <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">使用场景 (单选)</text>
                <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;">
                    <view class="pill-option data-v-6c9a4f44" bindtap="{{mt_setScene}}" data-val="课堂即练" style="flex: 1; text-align: center; padding: 16rpx 0; border-radius: 12rpx; font-size: 24rpx; {{mt_scene=='课堂即练' ? 'background: #d97706; color: #fff;' : 'background: #fff7ed; color: #9a3412;'}}">课堂即练</view>
                    <view class="pill-option data-v-6c9a4f44" bindtap="{{mt_setScene}}" data-val="课后作业" style="flex: 1; text-align: center; padding: 16rpx 0; border-radius: 12rpx; font-size: 24rpx; {{mt_scene=='课后作业' ? 'background: #d97706; color: #fff;' : 'background: #fff7ed; color: #9a3412;'}}">课后作业</view>
                    <view class="pill-option data-v-6c9a4f44" bindtap="{{mt_setScene}}" data-val="专项辅导" style="flex: 1; text-align: center; padding: 16rpx 0; border-radius: 12rpx; font-size: 24rpx; {{mt_scene=='专项辅导' ? 'background: #d97706; color: #fff;' : 'background: #fff7ed; color: #9a3412;'}}">专项辅导</view>
                </view>
            </view>
        </view>

        <view style="height: 120rpx;"></view>
    </scroll-view>
     <view class="fixed-footer data-v-6c9a4f44">
        <button class="btn-primary data-v-6c9a4f44" style="background-color: #d97706;" bindtap="{{mt_generate}}">生成强化训练题</button>
    </view>
</view>

<view wx:if="{{KEY_POINTS_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
         <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">关键点与易错点</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #f59e0b; margin-top: 8rpx; display: block;">标注考点，预警常见错误</text>
        </view>
        <text class="section-title data-v-6c9a4f44" style="color: #f59e0b;">✍️ 输入题目信息</text>
        
        <view class="form-group data-v-6c9a4f44">
            <view class="input-wrap data-v-6c9a4f44">
                 <text class="label data-v-6c9a4f44">题目内容来源 <text class="red data-v-6c9a4f44">*</text></text>
                 <view class="content-toggle-row data-v-6c9a4f44" style="display: flex; gap: 24rpx; margin-top: 24rpx; margin-bottom: 24rpx;">
                    <view class="toggle-option data-v-6c9a4f44" bindtap="{{kp_setType}}" data-val="upload" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{kp_inputType=='upload' ? '#f59e0b' : '#e5e7eb'}}; background: {{kp_inputType=='upload' ? '#fef3c7' : '#fff'}}; transition: all 0.3s;">
                        <text class="icon data-v-6c9a4f44">📄</text>
                        <text class="text data-v-6c9a4f44" style="margin-left:8rpx; font-weight:500; color:{{kp_inputType=='upload' ? '#b45309' : '#374151'}}">文件上传</text>
                    </view>
                    <view class="toggle-option data-v-6c9a4f44" bindtap="{{kp_setType}}" data-val="manual" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{kp_inputType=='manual' ? '#f59e0b' : '#e5e7eb'}}; background: {{kp_inputType=='manual' ? '#fef3c7' : '#fff'}}; transition: all 0.3s;">
                        <text class="icon data-v-6c9a4f44">✍️</text>
                        <text class="text data-v-6c9a4f44" style="margin-left:8rpx; font-weight:500; color:{{kp_inputType=='manual' ? '#b45309' : '#374151'}}">手动输入</text>
                    </view>
                 </view>
                 
                 <view wx:if="{{kp_inputType=='upload'}}" class="upload-area data-v-6c9a4f44" bindtap="{{kp_upload}}" style="border: 4rpx dashed #fcd34d; border-radius: 16rpx; padding: 48rpx; text-align: center; background: #fffbeb; margin-bottom: 24rpx;">
                    <text class="icon-lg data-v-6c9a4f44" style="font-size: 64rpx; display: block; margin-bottom: 16rpx;">{{utils.includes(kp_content, '[已上传文件]') ? '✅' : '☁️'}}</text>
                    <text class="upload-title data-v-6c9a4f44" style="color: #b45309; font-weight: 700; font-size: 28rpx;">{{utils.includes(kp_content, '[已上传文件]') ? kp_content : '点击上传教材照片 / PDF / Word'}}</text>
                 </view>

                 <view wx:if="{{kp_inputType=='manual'}}" class="manual-area data-v-6c9a4f44">
                    <textarea class="textarea data-v-6c9a4f44" style="height: 300rpx; border-color: #fcd34d;" placeholder="粘贴或上传题目..." value="{{kp_content}}" bindinput="{{kp_onContent}}"/>
                 </view>
            </view>

             <view class="divider-box data-v-6c9a4f44" style="margin-top: 32rpx; border-top: 2rpx dashed #e5e7eb; padding-top: 32rpx;">
                <text class="divider-label data-v-6c9a4f44" style="background: #fef3c7; color: #b45309; padding: 4rpx 12rpx; border-radius: 8rpx; font-size: 24rpx; font-weight: 600;">C (约束)</text>
                
                <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                    <text class="label data-v-6c9a4f44">1. 学生困惑或典型错误</text>
                    <view class="sub-input-box data-v-6c9a4f44" style="background: #f9fafb; padding: 24rpx; border-radius: 16rpx;">
                        <view class="row-center data-v-6c9a4f44" style="margin-bottom: 16rpx;">
                            <text class="icon data-v-6c9a4f44">📝</text>
                            <text class="sub-label data-v-6c9a4f44" style="font-size: 26rpx; font-weight: 500; color: #4b5563; margin-left: 8rpx;">已知具体困惑:</text>
                        </view>
                        <textarea class="textarea-sm data-v-6c9a4f44" style="height: 160rpx; font-size: 28rpx;" placeholder="如: 不知道为什么要用能量守恒而不是牛顿定律" value="{{kp_confusion}}" bindinput="{{kp_onConfusion}}"/>
                    </view>
                </view>
             </view>

        </view>
    </scroll-view>
    <view class="fixed-footer data-v-6c9a4f44">
        <button class="btn-primary-orange data-v-6c9a4f44" style="background: #f59e0b; color: white;" bindtap="{{kp_generate}}">开始分析考点</button>
    </view>
</view>

<view wx:if="{{MULTI_SOL_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
         <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">多种解法探索</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #8b5cf6; margin-top: 8rpx; display: block;">提供不同思路，拓展思维</text>
        </view>
        <text class="section-title data-v-6c9a4f44" style="color: #8b5cf6;">✍️ 输入题目信息</text>
        
        <view class="form-group data-v-6c9a4f44">
            <view class="input-wrap data-v-6c9a4f44">
                 <text class="label data-v-6c9a4f44">题目原文 <text class="red data-v-6c9a4f44">*</text></text>
                 <view class="content-toggle-row data-v-6c9a4f44" style="display: flex; gap: 24rpx; margin-top: 24rpx; margin-bottom: 24rpx;">
                    <view class="toggle-option data-v-6c9a4f44" bindtap="{{ms_setType}}" data-val="upload" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{ms_inputType=='upload' ? '#8b5cf6' : '#e5e7eb'}}; background: {{ms_inputType=='upload' ? '#f3e8ff' : '#fff'}}; transition: all 0.3s;">
                        <text class="icon data-v-6c9a4f44">📄</text>
                        <text class="text data-v-6c9a4f44" style="margin-left:8rpx; font-weight:500; color:{{ms_inputType=='upload' ? '#6d28d9' : '#374151'}}">文件上传</text>
                    </view>
                    <view class="toggle-option data-v-6c9a4f44" bindtap="{{ms_setType}}" data-val="manual" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{ms_inputType=='manual' ? '#8b5cf6' : '#e5e7eb'}}; background: {{ms_inputType=='manual' ? '#f3e8ff' : '#fff'}}; transition: all 0.3s;">
                        <text class="icon data-v-6c9a4f44">✍️</text>
                        <text class="text data-v-6c9a4f44" style="margin-left:8rpx; font-weight:500; color:{{ms_inputType=='manual' ? '#6d28d9' : '#374151'}}">手动输入</text>
                    </view>
                 </view>
                 
                 <view wx:if="{{ms_inputType=='upload'}}" class="upload-area data-v-6c9a4f44" bindtap="{{ms_upload}}" style="border: 4rpx dashed #c4b5fd; border-radius: 16rpx; padding: 48rpx; text-align: center; background: #f5f3ff; margin-bottom: 24rpx;">
                    <text class="icon-lg data-v-6c9a4f44" style="font-size: 64rpx; display: block; margin-bottom: 16rpx;">{{utils.includes(ms_content, '[已上传文件]') ? '✅' : '☁️'}}</text>
                    <text class="upload-title data-v-6c9a4f44" style="color: #6d28d9; font-weight: 700; font-size: 28rpx;">{{utils.includes(ms_content, '[已上传文件]') ? ms_content : '点击上传题目图片 / PDF'}}</text>
                 </view>

                 <view wx:if="{{ms_inputType=='manual'}}" class="manual-area data-v-6c9a4f44">
                    <textarea class="textarea data-v-6c9a4f44" style="height: 240rpx; border-color: #c4b5fd;" placeholder="已知二次函数y=x²-4x+3，求该函数的最小值" value="{{ms_content}}" bindinput="{{ms_onContent}}"/>
                 </view>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">年级学科</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 高二物理 / 三年级数学" value="{{ms_gs}}" bindinput="{{ms_onGs}}" style="border-color: #e5e7eb;"/>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 32rpx;">
                <text class="label data-v-6c9a4f44">班级情况 (单选)</text> 
                <view class="pills-column data-v-6c9a4f44" style="display: flex; flex-direction: column; gap: 16rpx; margin-top: 16rpx;">
                     <view bindtap="{{ms_setSituation}}" data-val="visual" class="pill-item {{ms_situation=='visual'?'active':''}}" style="padding: 24rpx; border-radius: 16rpx; background: {{ms_situation=='visual'?'#ddd6fe':'#f3f4f6'}}; color: {{ms_situation=='visual'?'#5b21b6':'#374151'}}; border: {{ms_situation=='visual'?'2rpx solid #8b5cf6':'2rpx solid transparent'}};">直观理解型 (喜欢图像、模型)</view>
                     <view bindtap="{{ms_setSituation}}" data-val="logic" class="pill-item {{ms_situation=='logic'?'active':''}}" style="padding: 24rpx; border-radius: 16rpx; background: {{ms_situation=='logic'?'#ddd6fe':'#f3f4f6'}}; color: {{ms_situation=='logic'?'#5b21b6':'#374151'}}; border: {{ms_situation=='logic'?'2rpx solid #8b5cf6':'2rpx solid transparent'}};">逻辑推理型 (喜欢公式、推导)</view>
                     <view bindtap="{{ms_setSituation}}" data-val="program" class="pill-item {{ms_situation=='program'?'active':''}}" style="padding: 24rpx; border-radius: 16rpx; background: {{ms_situation=='program'?'#ddd6fe':'#f3f4f6'}}; color: {{ms_situation=='program'?'#5b21b6':'#374151'}}; border: {{ms_situation=='program'?'2rpx solid #8b5cf6':'2rpx solid transparent'}};">程序记忆型 (喜欢步骤、口诀)</view>
                     <view bindtap="{{ms_setSituation}}" data-val="mixed" class="pill-item {{ms_situation=='mixed'?'active':''}}" style="padding: 24rpx; border-radius: 16rpx; background: {{ms_situation=='mixed'?'#ddd6fe':'#f3f4f6'}}; color: {{ms_situation=='mixed'?'#5b21b6':'#374151'}}; border: {{ms_situation=='mixed'?'2rpx solid #8b5cf6':'2rpx solid transparent'}};">水平分化 (各类型都有)</view>
                     <view bindtap="{{ms_setSituation}}" data-val="weak" class="pill-item {{ms_situation=='weak'?'active':''}}" style="padding: 24rpx; border-radius: 16rpx; background: {{ms_situation=='weak'?'#ddd6fe':'#f3f4f6'}}; color: {{ms_situation=='weak'?'#5b21b6':'#374151'}}; border: {{ms_situation=='weak'?'2rpx solid #8b5cf6':'2rpx solid transparent'}};">基础普遍薄弱</view>
                     <view class="custom-pill-row data-v-6c9a4f44" style="display:flex; gap:16rpx;">
                        <view bindtap="{{ms_setSituation}}" data-val="custom" class="pill-item {{ms_situation=='custom'?'active':''}}" style="padding: 24rpx; border-radius: 16rpx; background: {{ms_situation=='custom'?'#ddd6fe':'#f3f4f6'}}; color: {{ms_situation=='custom'?'#5b21b6':'#374151'}}; border: {{ms_situation=='custom'?'2rpx solid #8b5cf6':'2rpx solid transparent'}}; white-space: nowrap;">自定义</view>
                        <input wx:if="{{ms_situation=='custom'}}" class="input data-v-6c9a4f44" placeholder="如: 大部分偏好程序化..." value="{{ms_custom}}" bindinput="{{ms_onCustom}}" style="flex:1; font-size: 28rpx;"/>
                     </view>
                </view>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 32rpx;">
                <text class="label data-v-6c9a4f44">我需要 (单选)</text>
                <view class="pills-column data-v-6c9a4f44" style="display: flex; flex-direction: column; gap: 16rpx; margin-top: 16rpx;">
                     <view bindtap="{{ms_setNeed}}" data-val="recommend" class="pill-item {{ms_need=='recommend'?'active':''}}" style="padding: 24rpx; border-radius: 16rpx; background: {{ms_need=='recommend'?'#ddd6fe':'#f3f4f6'}}; color: {{ms_need=='recommend'?'#5b21b6':'#374151'}}; border: {{ms_need=='recommend'?'2rpx solid #8b5cf6':'2rpx solid transparent'}};">推荐 1 种最适合的方法 (说明为什么)</view>
                     <view bindtap="{{ms_setNeed}}" data-val="compare" class="pill-item {{ms_need=='compare'?'active':''}}" style="padding: 24rpx; border-radius: 16rpx; background: {{ms_need=='compare'?'#ddd6fe':'#f3f4f6'}}; color: {{ms_need=='compare'?'#5b21b6':'#374151'}}; border: {{ms_need=='compare'?'2rpx solid #8b5cf6':'2rpx solid transparent'}};">给 2 种方法 (基础+进阶，帮我判断该讲哪个)</view>
                     <view bindtap="{{ms_setNeed}}" data-val="all" class="pill-item {{ms_need=='all'?'active':''}}" style="padding: 24rpx; border-radius: 16rpx; background: {{ms_need=='all'?'#ddd6fe':'#f3f4f6'}}; color: {{ms_need=='all'?'#5b21b6':'#374151'}}; border: {{ms_need=='all'?'2rpx solid #8b5cf6':'2rpx solid transparent'}};">给 3 种方法 (全覆盖，排序优先级)</view>
                </view>
            </view>

        </view>
    </scroll-view>
    <view class="fixed-footer data-v-6c9a4f44">
        <button class="btn-primary-purple data-v-6c9a4f44" style="background: #8b5cf6; color: white;" bindtap="{{ms_generate}}">开始探索解法</button>
    </view>
</view>

<view wx:if="{{VARIATION_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
         <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">变式题扩展</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #3b82f6; margin-top: 8rpx; display: block;">举一反三，生成同类练习</text>
        </view>
        <text class="section-title data-v-6c9a4f44" style="color: #3b82f6;">✍️ 输入题目信息</text>
        
        <view class="form-group data-v-6c9a4f44">
            <view class="input-wrap data-v-6c9a4f44">
                 <text class="label data-v-6c9a4f44">题目原文</text>
                 <view class="content-toggle-row data-v-6c9a4f44" style="display: flex; gap: 24rpx; margin-top: 24rpx; margin-bottom: 24rpx;">
                    <view class="toggle-option data-v-6c9a4f44" bindtap="{{vr_setType}}" data-val="upload" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{vr_inputType=='upload' ? '#3b82f6' : '#e5e7eb'}}; background: {{vr_inputType=='upload' ? '#eff6ff' : '#fff'}}; transition: all 0.3s;">
                        <text class="icon data-v-6c9a4f44">📄</text>
                        <text class="text data-v-6c9a4f44" style="margin-left:8rpx; font-weight:500; color:{{vr_inputType=='upload' ? '#2563eb' : '#374151'}}">文件上传</text>
                    </view>
                    <view class="toggle-option data-v-6c9a4f44" bindtap="{{vr_setType}}" data-val="manual" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{vr_inputType=='manual' ? '#3b82f6' : '#e5e7eb'}}; background: {{vr_inputType=='manual' ? '#eff6ff' : '#fff'}}; transition: all 0.3s;">
                        <text class="icon data-v-6c9a4f44">✍️</text>
                        <text class="text data-v-6c9a4f44" style="margin-left:8rpx; font-weight:500; color:{{vr_inputType=='manual' ? '#2563eb' : '#374151'}}">手动输入</text>
                    </view>
                 </view>
                 
                 <view wx:if="{{vr_inputType=='upload'}}" class="upload-area data-v-6c9a4f44" bindtap="{{vr_upload}}" style="border: 4rpx dashed #93c5fd; border-radius: 16rpx; padding: 48rpx; text-align: center; background: #eff6ff; margin-bottom: 24rpx;">
                    <text class="icon-lg data-v-6c9a4f44" style="font-size: 64rpx; display: block; margin-bottom: 16rpx;">{{utils.includes(vr_content, '[已上传文件]') ? '✅' : '☁️'}}</text>
                    <text class="upload-title data-v-6c9a4f44" style="color: #2563eb; font-weight: 700; font-size: 28rpx;">{{utils.includes(vr_content, '[已上传文件]') ? vr_content : '点击上传题目图片 / PDF'}}</text>
                 </view>

                 <view wx:if="{{vr_inputType=='manual'}}" class="manual-area data-v-6c9a4f44">
                    <textarea class="textarea data-v-6c9a4f44" style="height: 240rpx; border-color: #93c5fd;" placeholder="粘贴或输入原题内容" value="{{vr_content}}" bindinput="{{vr_onContent}}"/>
                 </view>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">年级学科</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 高二物理 / 三年级数学" value="{{vr_gs}}" bindinput="{{vr_onGs}}" style="border-color: #e5e7eb;"/>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 32rpx;">
                <text class="label data-v-6c9a4f44">训练目的</text> 
                <view class="detail-input-group data-v-6c9a4f44" style="background: #f8fafc; padding: 24rpx; border-radius: 16rpx; margin-top: 16rpx;">
                     <view class="row-v-center data-v-6c9a4f44" style="margin-bottom: 16rpx;">
                        <text class="sub-label data-v-6c9a4f44" style="width: 180rpx; font-size: 26rpx; color: #64748b;">让学生意识到:</text>
                        <input class="input-sm data-v-6c9a4f44" style="flex:1; font-size: 26rpx; background: #fff;" placeholder="如: 同一原理在不同情境的应用" value="{{vr_realize}}" bindinput="{{vr_onRealize}}"/>
                     </view>
                     <view class="row-v-center data-v-6c9a4f44" style="margin-bottom: 16rpx;">
                        <text class="sub-label data-v-6c9a4f44" style="width: 180rpx; font-size: 26rpx; color: #64748b;">防止学生出现:</text>
                        <input class="input-sm data-v-6c9a4f44" style="flex:1; font-size: 26rpx; background: #fff;" placeholder="如: 机械套用公式，不看条件" value="{{vr_prevent}}" bindinput="{{vr_onPrevent}}"/>
                     </view>
                     <view class="row-v-center data-v-6c9a4f44">
                        <text class="sub-label data-v-6c9a4f44" style="width: 180rpx; font-size: 26rpx; color: #64748b;">最终达到:</text>
                        <input class="input-sm data-v-6c9a4f44" style="flex:1; font-size: 26rpx; background: #fff;" placeholder="如: 能灵活判断用什么方法" value="{{vr_achieve}}" bindinput="{{vr_onAchieve}}"/>
                     </view>
                </view>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 32rpx;">
                <text class="label data-v-6c9a4f44">题目需求 (单选)</text>
                <view class="pills-column data-v-6c9a4f44" style="display: flex; flex-direction: column; gap: 16rpx; margin-top: 16rpx;">
                     <view bindtap="{{vr_setReq}}" data-val="progressive" class="pill-item {{vr_req=='progressive'?'active':''}}" style="padding: 24rpx; border-radius: 16rpx; background: {{vr_req=='progressive'?'#eff6ff':'#f3f4f6'}}; color: {{vr_req=='progressive'?'#2563eb':'#374151'}}; border: {{vr_req=='progressive'?'2rpx solid #3b82f6':'2rpx solid transparent'}};">
                        <text style="font-weight: 600; display: block; margin-bottom: 8rpx;">3 道递进式</text>
                        <text style="font-size: 22rpx; opacity: 0.8;">70%原题难度 → 85% → 100%</text>
                     </view>
                     <view bindtap="{{vr_setReq}}" data-val="consolidation" class="pill-item {{vr_req=='consolidation'?'active':''}}" style="padding: 24rpx; border-radius: 16rpx; background: {{vr_req=='consolidation'?'#eff6ff':'#f3f4f6'}}; color: {{vr_req=='consolidation'?'#2563eb':'#374151'}}; border: {{vr_req=='consolidation'?'2rpx solid #3b82f6':'2rpx solid transparent'}};">
                        <text style="font-weight: 600; display: block; margin-bottom: 8rpx;">3 道巩固式</text>
                        <text style="font-size: 22rpx; opacity: 0.8;">都是 70-80% 难度，强化基础</text>
                     </view>
                     <view bindtap="{{vr_setReq}}" data-val="systematic" class="pill-item {{vr_req=='systematic'?'active':''}}" style="padding: 24rpx; border-radius: 16rpx; background: {{vr_req=='systematic'?'#eff6ff':'#f3f4f6'}}; color: {{vr_req=='systematic'?'#2563eb':'#374151'}}; border: {{vr_req=='systematic'?'2rpx solid #3b82f6':'2rpx solid transparent'}};">
                        <text style="font-weight: 600; display: block; margin-bottom: 8rpx;">5 道系统式</text>
                        <text style="font-size: 22rpx; opacity: 0.8;">2道巩固 + 2道提升 + 1道综合</text>
                     </view>
                </view>
            </view>

        </view>
    </scroll-view>
    <view class="fixed-footer data-v-6c9a4f44">
        <button class="btn-primary-blue data-v-6c9a4f44" style="background: #3b82f6; color: white;" bindtap="{{vr_generate}}">生成变式题</button>
    </view>
</view>



<view wx:if="{{OFFICIAL_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
         <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">学校公众号文案撰写</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #3b82f6; margin-top: 8rpx; display: block;">输入活动信息，生成吸睛推文</text>
        </view>
        <text class="section-title data-v-6c9a4f44" style="color: #3b82f6;">✍️ 核心信息</text>
        <view class="form-group data-v-6c9a4f44">
            <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">活动名称</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 高考冲刺动员大会" value="{{off_name}}" bindinput="{{off_onName}}" style="border-color: #e5e7eb;"/>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">时间地点</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 2024年10月15日下午2:30, 学校报告厅" value="{{off_time}}" bindinput="{{off_onTime}}" style="border-color: #e5e7eb;"/>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">参与人员</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 高三520名学生、800位家长、5位校领导" value="{{off_part}}" bindinput="{{off_onPart}}" style="border-color: #e5e7eb;"/>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">活动亮点 (2-3个)</text>
                <textarea class="textarea data-v-6c9a4f44" style="height: 160rpx; border-color: #e5e7eb;" placeholder="特色环节或创新做法" value="{{off_high}}" bindinput="{{off_onHigh}}"/>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">现场细节</text>
                 <textarea class="textarea data-v-6c9a4f44" style="height: 120rpx; border-color: #e5e7eb;" placeholder="如: 学生们在提问环节很踊跃" value="{{off_detail}}" bindinput="{{off_onDetail}}"/>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">真实反馈</text>
                 <textarea class="textarea data-v-6c9a4f44" style="height: 120rpx; border-color: #e5e7eb;" placeholder='如: 李同学说"想起了高一时"' value="{{off_access}}" bindinput="{{off_onAccess}}"/>
            </view>
            
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">典型成效 (选填)</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 3个班级完成了作品展示" value="{{off_achieve}}" bindinput="{{off_onAchieve}}" style="border-color: #e5e7eb;"/>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 32rpx;">
                <text class="label data-v-6c9a4f44">推文用途 (单选)</text>
                <view class="pills-column data-v-6c9a4f44" style="display: flex; flex-direction: column; gap: 16rpx; margin-top: 16rpx;">
                     <view bindtap="{{off_setUsage}}" data-val="report" class="pill-item {{off_usage=='report'?'active':''}}" style="padding: 24rpx; border-radius: 16rpx; background: {{off_usage=='report'?'#eff6ff':'#f3f4f6'}}; color: {{off_usage=='report'?'#2563eb':'#374151'}}; border: {{off_usage=='report'?'2rpx solid #3b82f6':'2rpx solid transparent'}};">
                        <text style="font-weight: 600; display: block; margin-bottom: 8rpx;">A. 活动报道</text>
                        <text style="font-size: 22rpx; opacity: 0.8;">展示精彩瞬间，回顾流程</text>
                     </view>
                     <view bindtap="{{off_setUsage}}" data-val="interaction" class="pill-item {{off_usage=='interaction'?'active':''}}" style="padding: 24rpx; border-radius: 16rpx; background: {{off_usage=='interaction'?'#eff6ff':'#f3f4f6'}}; color: {{off_usage=='interaction'?'#2563eb':'#374151'}}; border: {{off_usage=='interaction'?'2rpx solid #3b82f6':'2rpx solid transparent'}};">
                        <text style="font-weight: 600; display: block; margin-bottom: 8rpx;">B. 家校互动</text>
                        <text style="font-size: 22rpx; opacity: 0.8;">让未到场的家长了解情况</text>
                     </view>
                     <view bindtap="{{off_setUsage}}" data-val="sharing" class="pill-item {{off_usage=='sharing'?'active':''}}" style="padding: 24rpx; border-radius: 16rpx; background: {{off_usage=='sharing'?'#eff6ff':'#f3f4f6'}}; color: {{off_usage=='sharing'?'#2563eb':'#374151'}}; border: {{off_usage=='sharing'?'2rpx solid #3b82f6':'2rpx solid transparent'}};">
                        <text style="font-weight: 600; display: block; margin-bottom: 8rpx;">C. 经验分享</text>
                        <text style="font-size: 22rpx; opacity: 0.8;">总结亮点，供同行参考</text>
                     </view>
                     <view bindtap="{{off_setUsage}}" data-val="warm" class="pill-item {{off_usage=='warm'?'active':''}}" style="padding: 24rpx; border-radius: 16rpx; background: {{off_usage=='warm'?'#eff6ff':'#f3f4f6'}}; color: {{off_usage=='warm'?'#2563eb':'#374151'}}; border: {{off_usage=='warm'?'2rpx solid #3b82f6':'2rpx solid transparent'}};">
                        <text style="font-weight: 600; display: block; margin-bottom: 8rpx;">D. 温情记录</text>
                        <text style="font-size: 22rpx; opacity: 0.8;">侧重情感，记录感人瞬间</text>
                     </view>
                </view>
            </view>

        </view>
    </scroll-view>
    <view class="fixed-footer data-v-6c9a4f44">
        <button class="btn-primary-blue data-v-6c9a4f44" style="background: #3b82f6; color: white;" bindtap="{{off_generate}}">生成推文</button>
    </view>
</view>

<view wx:if="{{STD_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
         <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">标准答案生成</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #10b981; margin-top: 8rpx; display: block;">精准生成</text>
        </view>
        <text class="section-title data-v-6c9a4f44" style="color: #10b981;">✍️ 填写题目信息</text>
        
        <view class="form-group data-v-6c9a4f44">
            <view class="input-wrap data-v-6c9a4f44">
                 <text class="label data-v-6c9a4f44">题目内容来源 <text class="red data-v-6c9a4f44">*</text></text>
                 <view class="content-toggle-row data-v-6c9a4f44" style="display: flex; gap: 24rpx; margin-top: 24rpx; margin-bottom: 24rpx;">
                    <view class="toggle-option data-v-6c9a4f44" bindtap="{{sa_setType}}" data-val="upload" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{sa_inputType=='upload' ? '#10b981' : '#e5e7eb'}}; background: {{sa_inputType=='upload' ? '#d1fae5' : '#fff'}}; transition: all 0.3s;">
                        <text class="icon data-v-6c9a4f44">📄</text>
                        <text class="text data-v-6c9a4f44" style="margin-left:8rpx; font-weight:500; color:{{sa_inputType=='upload' ? '#047857' : '#374151'}}">文件上传</text>
                    </view>
                    <view class="toggle-option data-v-6c9a4f44" bindtap="{{sa_setType}}" data-val="manual" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{sa_inputType=='manual' ? '#10b981' : '#e5e7eb'}}; background: {{sa_inputType=='manual' ? '#d1fae5' : '#fff'}}; transition: all 0.3s;">
                        <text class="icon data-v-6c9a4f44">✍️</text>
                        <text class="text data-v-6c9a4f44" style="margin-left:8rpx; font-weight:500; color:{{sa_inputType=='manual' ? '#047857' : '#374151'}}">手动输入</text>
                    </view>
                 </view>
                 
                 <view wx:if="{{sa_inputType=='upload'}}" class="upload-area data-v-6c9a4f44" bindtap="{{sa_upload}}" style="border: 4rpx dashed #6ee7b7; border-radius: 16rpx; padding: 48rpx; text-align: center; background: #f0fdf4; margin-bottom: 24rpx;">
                    <text class="icon-lg data-v-6c9a4f44" style="font-size: 64rpx; display: block; margin-bottom: 16rpx;">{{utils.includes(sa_content, '[已上传文件]') ? '✅' : '☁️'}}</text>
                    <text class="upload-title data-v-6c9a4f44" style="color: #059669; font-weight: 700; font-size: 28rpx;">{{utils.includes(sa_content, '[已上传文件]') ? sa_content : '点击上传教材照片 / PDF / Word'}}</text>
                 </view>

                 <view wx:if="{{sa_inputType=='manual'}}" class="manual-area data-v-6c9a4f44">
                    <textarea class="textarea data-v-6c9a4f44" style="height: 300rpx; border-color: #d1fae5;" placeholder="粘贴或上传题目..." value="{{sa_content}}" bindinput="{{sa_onContent}}"/>
                 </view>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">年级学科</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 高二数学" value="{{sa_gs}}" bindinput="{{sa_onGs}}"/>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">学生水平 (单选)</text>
                <view class="pills-column data-v-6c9a4f44" style="display: flex; flex-direction: column; gap: 16rpx; margin-top: 16rpx;">
                     <view bindtap="{{sa_setLevel}}" data-val="basics" class="pill-item {{sa_level=='basics'?'active':''}}" style="padding: 20rpx; border-radius: 16rpx; background: {{sa_level=='basics'?'#10b981':'#f3f4f6'}}; color: {{sa_level=='basics'?'#fff':'#374151'}}; font-size: 28rpx;">刚学完基础 (概念理解但计算不熟练)</view>
                     <view bindtap="{{sa_setLevel}}" data-val="practice" class="pill-item {{sa_level=='practice'?'active':''}}" style="padding: 20rpx; border-radius: 16rpx; background: {{sa_level=='practice'?'#10b981':'#f3f4f6'}}; color: {{sa_level=='practice'?'#fff':'#374151'}}; font-size: 28rpx;">有一定练习基础 (见过类似题型)</view>
                     <view bindtap="{{sa_setLevel}}" data-val="solid" class="pill-item {{sa_level=='solid'?'active':''}}" style="padding: 20rpx; border-radius: 16rpx; background: {{sa_level=='solid'?'#10b981':'#f3f4f6'}}; color: {{sa_level=='solid'?'#fff':'#374151'}}; font-size: 28rpx;">基础扎实 (能独立分析复杂问题)</view>
                </view>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">使用场景 (单选)</text>
                <view class="pills-column data-v-6c9a4f44" style="display: flex; flex-direction: column; gap: 16rpx; margin-top: 16rpx;">
                     <view bindtap="{{sa_setScene}}" data-val="board" class="pill-item {{sa_scene=='board'?'active':''}}" style="padding: 20rpx; border-radius: 16rpx; background: {{sa_scene=='board'?'#10b981':'#f3f4f6'}}; color: {{sa_scene=='board'?'#fff':'#374151'}}; font-size: 28rpx;">课堂板书讲解 (需详细演示)</view>
                     <view bindtap="{{sa_setScene}}" data-val="homework" class="pill-item {{sa_scene=='homework'?'active':''}}" style="padding: 20rpx; border-radius: 16rpx; background: {{sa_scene=='homework'?'#10b981':'#f3f4f6'}}; color: {{sa_scene=='homework'?'#fff':'#374151'}}; font-size: 28rpx;">作业批改参考 (需标注评分点)</view>
                     <view bindtap="{{sa_setScene}}" data-val="exam" class="pill-item {{sa_scene=='exam'?'active':''}}" style="padding: 20rpx; border-radius: 16rpx; background: {{sa_scene=='exam'?'#10b981':'#f3f4f6'}}; color: {{sa_scene=='exam'?'#fff':'#374151'}}; font-size: 28rpx;">考试试卷讲评 (需强调易错点)</view>
                </view>
            </view>
        </view>
        <view style="height: 120rpx;"></view>
    </scroll-view>
     <view class="fixed-footer data-v-6c9a4f44">
        <button class="btn-primary data-v-6c9a4f44" style="background-color: #10b981;" bindtap="{{sa_generate}}">生成标准解答</button>
    </view>
</view>

<view wx:if="{{PL_DESIGN_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">公开课/比赛课设计</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #ec4899; margin-top: 8rpx; display: block;">打造高互动、有深度的金课</text>
        </view>
        <text class="section-title data-v-6c9a4f44" style="color: #ec4899;">✍️ 课程基础信息</text>
        
        <view class="form-group data-v-6c9a4f44">
            <view class="row-2 data-v-6c9a4f44">
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">学科</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 高中语文" value="{{pl_subject}}" bindinput="{{pl_onSubject}}"/>
                </view>
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">年级</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 高一" value="{{pl_grade}}" bindinput="{{pl_onGrade}}"/>
                </view>
            </view>
            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">课题名称 <text class="red data-v-6c9a4f44">*</text></text>
                <input class="input data-v-6c9a4f44" placeholder="如: 《荷塘月色》" value="{{pl_topic}}" bindinput="{{pl_onTopic}}"/>
            </view>
            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">教材版本</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 人教版必修上册" value="{{pl_version}}" bindinput="{{pl_onVersion}}"/>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44" style="color:#ec4899; background:#fce7f3;">设计要求</text>
            
            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 20rpx;">
                <text class="label data-v-6c9a4f44">比赛/公开课要求</text>
                <textarea class="textarea data-v-6c9a4f44" style="height: 120rpx; border-color: #fbcfe8;" placeholder="如: 突出大单元教学，师生互动多" value="{{pl_compReq}}" bindinput="{{pl_onCompReq}}"/>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 20rpx;">
                <text class="label data-v-6c9a4f44">教学理念 (可选)</text>
                <input class="input data-v-6c9a4f44" placeholder="如: PBL项目式学习" value="{{pl_philosophy}}" bindinput="{{pl_onPhilosophy}}" style="border-color: #e5e7eb;"/>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 20rpx;">
                <text class="label data-v-6c9a4f44">预设亮点 (可选)</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 创设穿越情境" value="{{pl_highlights}}" bindinput="{{pl_onHighlights}}" style="border-color: #e5e7eb;"/>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">课时时长 (单选)</text>
                <view style="display: flex; gap: 24rpx; margin-top: 16rpx;">
                     <view bindtap="{{pl_setDuration}}" data-val="40分钟" class="pill-item {{pl_duration=='40分钟'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 99rpx; font-size: 26rpx; {{pl_duration=='40分钟'?'background:#ec4899;color:#fff;':'background:#fce7f3;color:#831843;'}}">40分钟</view>
                     <view bindtap="{{pl_setDuration}}" data-val="45分钟" class="pill-item {{pl_duration=='45分钟'?'active':''}}" style="padding: 16rpx 32rpx; border-radius: 99rpx; font-size: 26rpx; {{pl_duration=='45分钟'?'background:#ec4899;color:#fff;':'background:#fce7f3;color:#831843;'}}">45分钟</view>
                </view>
            </view>
        </view>
        <view style="height: 120rpx;"></view>
    </scroll-view>
     <view class="fixed-footer data-v-6c9a4f44">
        <button class="btn-primary-purple data-v-6c9a4f44" style="background-color: #ec4899; color: white;" bindtap="{{pl_generate}}">生成比赛教案</button>
    </view>
</view>

<view wx:if="{{PL_LECTURE_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">说课文稿生成</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #8b5cf6; margin-top: 8rpx; display: block;">获奖级说课稿 | 涵盖教材学情与教法</text>
        </view>
        <text class="section-title data-v-6c9a4f44" style="color: #8b5cf6;">✍️ 说课基础信息</text>
        
        <view class="form-group data-v-6c9a4f44">
            <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">课题名称 <text class="red data-v-6c9a4f44">*</text></text>
                <input class="input data-v-6c9a4f44" placeholder="如: 《常用逻辑用语》" value="{{lec_topic}}" bindinput="{{lec_onTopic}}"/>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">核心亮点 (可选)</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 基于PBL真实情境创设" value="{{lec_highlights}}" bindinput="{{lec_onHighlights}}"/>
            </view>
            
            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                 <text class="label data-v-6c9a4f44">教学设计内容 <text class="red data-v-6c9a4f44">*</text></text>
                 <view class="content-toggle-row data-v-6c9a4f44" style="display: flex; gap: 24rpx; margin-top: 24rpx; margin-bottom: 24rpx;">
                    <view class="toggle-option data-v-6c9a4f44" bindtap="{{lec_setType}}" data-val="upload" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{lec_contentType=='upload' ? '#8b5cf6' : '#e5e7eb'}}; background: {{lec_contentType=='upload' ? '#f3e8ff' : '#fff'}}; transition: all 0.3s;">
                        <text class="icon data-v-6c9a4f44">📄</text>
                        <text class="text data-v-6c9a4f44" style="margin-left:8rpx; font-weight:500; color:{{lec_contentType=='upload' ? '#7c3aed' : '#374151'}}">上传教案</text>
                    </view>
                    <view class="toggle-option data-v-6c9a4f44" bindtap="{{lec_setType}}" data-val="manual" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{lec_contentType=='manual' ? '#8b5cf6' : '#e5e7eb'}}; background: {{lec_contentType=='manual' ? '#f3e8ff' : '#fff'}}; transition: all 0.3s;">
                        <text class="icon data-v-6c9a4f44">✍️</text>
                        <text class="text data-v-6c9a4f44" style="margin-left:8rpx; font-weight:500; color:{{lec_contentType=='manual' ? '#7c3aed' : '#374151'}}">手动输入</text>
                    </view>
                 </view>
                 
                 <view wx:if="{{lec_contentType=='upload'}}" class="upload-area data-v-6c9a4f44" bindtap="{{lec_upload}}" style="border: 4rpx dashed #c4b5fd; border-radius: 16rpx; padding: 48rpx; text-align: center; background: #f5f3ff; margin-bottom: 24rpx;">
                    <text class="icon-lg data-v-6c9a4f44" style="font-size: 64rpx; display: block; margin-bottom: 16rpx;">{{utils.includes(lec_content, '[已上传文件]') ? '✅' : '☁️'}}</text>
                    <text class="upload-title data-v-6c9a4f44" style="color: #7c3aed; font-weight: 700; font-size: 28rpx;">{{utils.includes(lec_content, '[已上传文件]') ? lec_content : '点击上传教案文档'}}</text>
                 </view>

                 <view wx:if="{{lec_contentType=='manual'}}" class="manual-area data-v-6c9a4f44">
                    <textarea class="textarea data-v-6c9a4f44" style="height: 300rpx; border-color: #c4b5fd;" placeholder="粘贴教学设计核心内容..." value="{{lec_content}}" bindinput="{{lec_onContent}}"/>
                 </view>
            </view>
        </view>
        <view style="height: 120rpx;"></view>
    </scroll-view>
     <view class="fixed-footer data-v-6c9a4f44">
        <button class="btn-primary-purple data-v-6c9a4f44" style="background-color: #8b5cf6; color: white;" bindtap="{{lec_generate}}">生成说课文稿</button>
    </view>

</view>

<view wx:if="{{ANALYSIS_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">教学内容深度剖析</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #059669; margin-top: 8rpx; display: block;">深度解读教材 | 明确教学重难点</text>
        </view>
        <text class="section-title data-v-6c9a4f44" style="color: #059669;">✍️ 输入教材信息</text>
        
        <view class="form-group data-v-6c9a4f44">
            <view class="row-2 data-v-6c9a4f44">
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">学科名称</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 初中生物" value="{{ana_subject}}" bindinput="{{ana_onSubject}}"/>
                </view>
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">教材版本+章节</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 人教版八年级上册第五单元" value="{{ana_textbook}}" bindinput="{{ana_onTextbook}}"/>
                </view>
            </view>

            <view class="divider-box data-v-6c9a4f44">
                <!-- Content -->
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">教材内容来源 <text class="red data-v-6c9a4f44">*</text></text>
                    <view class="content-toggle-row data-v-6c9a4f44" style="display: flex; gap: 24rpx; margin-top: 24rpx; margin-bottom: 24rpx;">
                        <view class="toggle-option data-v-6c9a4f44" bindtap="{{ana_setType}}" data-val="upload" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{ana_inputType=='upload' ? '#059669' : '#e5e7eb'}}; background: {{ana_inputType=='upload' ? '#d1fae5' : '#fff'}}; transition: all 0.3s;">
                            <text class="icon data-v-6c9a4f44">📄</text>
                            <text class="text data-v-6c9a4f44" style="margin-left:8rpx; font-weight:500; color:{{ana_inputType=='upload' ? '#047857' : '#374151'}}">文件上传</text>
                        </view>
                        <view class="toggle-option data-v-6c9a4f44" bindtap="{{ana_setType}}" data-val="manual" style="flex: 1; padding: 24rpx; border-radius: 16rpx; text-align: center; border: 2rpx solid {{ana_inputType=='manual' ? '#059669' : '#e5e7eb'}}; background: {{ana_inputType=='manual' ? '#d1fae5' : '#fff'}}; transition: all 0.3s;">
                            <text class="icon data-v-6c9a4f44">✍️</text>
                             <text class="text data-v-6c9a4f44" style="margin-left:8rpx; font-weight:500; color:{{ana_inputType=='manual' ? '#047857' : '#374151'}}">手动输入</text>
                        </view>
                    </view>

                    <view wx:if="{{ana_inputType=='upload'}}" class="upload-area data-v-6c9a4f44" style="border: 4rpx dashed #d1fae5; border-radius: 16rpx; padding: 48rpx; text-align: center; background: #fff;">
                         <text class="icon-lg data-v-6c9a4f44" style="font-size: 48rpx; display: block; margin-bottom: 16rpx;">⬆️</text>
                         <text class="upload-title data-v-6c9a4f44" style="color: #6b7280; font-size: 28rpx;">点击上传教材照片 / PDF / Word</text>
                    </view>

                    <view wx:if="{{ana_inputType=='manual'}}" class="manual-area data-v-6c9a4f44">
                        <textarea class="textarea data-v-6c9a4f44" style="height: 300rpx; border-color: #d1fae5;" placeholder="请粘贴教材内容..." value="{{ana_content}}" bindinput="{{ana_onContent}}"/>
                    </view>
                </view>

                <!-- Standards (Constrained) -->
                <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                    <text class="label data-v-6c9a4f44">课程标准要求</text>
                    <textarea class="textarea data-v-6c9a4f44" style="height: 120rpx;" placeholder="如: 能够说明..." value="{{ana_standard}}" bindinput="{{ana_onStandard}}"/>
                    <text class="hint-gray data-v-6c9a4f44" style="font-size: 22rpx; margin-top: 8rpx; display: block;">* 若不清楚可不填，AI将基于新课标自动匹配</text>
                </view>

                <!-- Students (Background) -->
                <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                    <text class="label data-v-6c9a4f44">学情简述</text>
                    <textarea class="textarea data-v-6c9a4f44" style="height: 120rpx;" placeholder="如: 学生对该话题感兴趣，但缺乏系统认知..." value="{{ana_student}}" bindinput="{{ana_onStudent}}"/>
                </view>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44" style="padding: 0 32rpx; margin-top: 0;">
            <text class="divider-label data-v-6c9a4f44">剖析维度选择 (多选)</text>
            <view class="tags-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; flex-wrap: wrap; margin-top: 16rpx;">
                <view wx:for="{{ana_dimOpts}}" wx:key="id" class="tag-option data-v-6c9a4f44" bindtap="{{ana_toggleDim}}" data-id="{{item.id}}" style="padding: 16rpx 24rpx; border-radius: 99rpx; font-size: 24rpx; border: 2rpx solid transparent; {{utils.includes(ana_dims, item.id) ? 'background: #059669; color: #fff;' : 'background: #f3f4f6; color: #4b5563;'}}">
                    {{item.label}}
                </view>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44" style="padding: 0 32rpx; margin-bottom: 200rpx;">
            <text class="divider-label data-v-6c9a4f44">教学场景设定 (单选)</text>
            <view class="scene-list data-v-6c9a4f44" style="display: flex; flex-wrap: wrap; gap: 16rpx; margin-top: 16rpx;">
                <view wx:for="{{ana_sceneOpts}}" wx:key="*this" class="scene-card data-v-6c9a4f44" bindtap="{{ana_setScene}}" data-val="{{item}}" style="padding: 24rpx; border-radius: 16rpx; border: 2rpx solid {{ana_scene == item ? '#059669' : '#e5e7eb'}}; background: {{ana_scene == item ? '#ecfdf5' : '#fff'}}; width: 48%; box-sizing: border-box;">
                    <text style="color: {{ana_scene == item ? '#047857' : '#374151'}}; font-size: 26rpx; font-weight: 500;">{{item}}</text>
                </view>
            </view>
        </view>

        <view style="height: 120rpx;"></view>
    </scroll-view>
    <view class="fixed-footer data-v-6c9a4f44">
        <button class="btn-primary data-v-6c9a4f44" style="background-color: #059669;" bindtap="{{ana_generate}}">开始深度剖析</button>
    </view>
</view>



<!-- PPT Production Input -->
<view wx:if="{{PPT_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">课件制作美化</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #7c3aed; margin-top: 8rpx; display: block;">专业审美 | 逻辑清晰 | 创新呈现</text>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">基本信息</text>
             <view class="row-2 data-v-6c9a4f44">
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">学科</text>
                    <input class="input data-v-6c9a4f44" placeholder="学科" value="{{pptData.subject}}" bindinput="{{onPPTSubjectInput}}"/>
                </view>
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">年级</text>
                    <input class="input data-v-6c9a4f44" placeholder="年级" value="{{pptData.grade}}" bindinput="{{onPPTGradeInput}}"/>
                </view>
             </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">课题名称</text>
                <input class="input data-v-6c9a4f44" placeholder="本课课题" value="{{pptData.topic}}" bindinput="{{onPPTTopicInput}}"/>
            </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">页数要求</text>
                <input type="number" class="input data-v-6c9a4f44" placeholder="预计页数" value="{{pptData.pages}}" bindinput="{{onPPTPagesInput}}"/>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">教学内容</text>
            <textarea class="textarea data-v-6c9a4f44" style="height: 160rpx;" placeholder="本课主要内容简述..." value="{{pptData.content}}" bindinput="{{onPPTContentInput}}"/>
        </view>

        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">设计要点</text>
            <view class="input-wrap data-v-6c9a4f44" style="margin-bottom: 24rpx;">
                <text class="label data-v-6c9a4f44">封面/导入页思路</text>
                <input class="input data-v-6c9a4f44" placeholder="例如：使用生活场景图片导入" value="{{pptData.cover}}" bindinput="{{onPPTCoverInput}}"/>
            </view>
            <view class="input-wrap data-v-6c9a4f44" style="margin-bottom: 24rpx;">
                <text class="label data-v-6c9a4f44">重难点页面布局</text>
                <input class="input data-v-6c9a4f44" placeholder="例如：左右分栏，左图右文" value="{{pptData.keyPoints}}" bindinput="{{onPPTKeyPointsInput}}"/>
            </view>
            <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">互动/练习环节</text>
                <input class="input data-v-6c9a4f44" placeholder="例如：随堂测试小游戏" value="{{pptData.interaction}}" bindinput="{{onPPTInteractInput}}"/>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">内容创新 (2-3点)</text>
            <input class="input data-v-6c9a4f44" placeholder="创新点1 (如: 类比法)" value="{{pptData.innovations[0]}}" bindinput="{{onPPTInnovationInput}}" data-idx="0" style="margin-bottom: 16rpx;"/>
            <input class="input data-v-6c9a4f44" placeholder="创新点2" value="{{pptData.innovations[1]}}" bindinput="{{onPPTInnovationInput}}" data-idx="1" style="margin-bottom: 16rpx;"/>
            <input class="input data-v-6c9a4f44" placeholder="创新点3" value="{{pptData.innovations[2]}}" bindinput="{{onPPTInnovationInput}}" data-idx="2"/>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">呈现方式</text>
             <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; flex-wrap: wrap; margin-top: 16rpx;">
                 <view bindtap="{{handlePPTPresentation}}" data-val="多媒体为主+板书辅助" class="pill-item {{pptData.presentationMode=='多媒体为主+板书辅助'?'active':''}}" style="padding: 16rpx 24rpx; border-radius: 32rpx; background: {{pptData.presentationMode=='多媒体为主+板书辅助'?'#7c3aed':'#f3f4f6'}}; color: {{pptData.presentationMode=='多媒体为主+板书辅助'?'#fff':'#374151'}}; font-size: 26rpx;">多媒体为主</view>
                 <view bindtap="{{handlePPTPresentation}}" data-val="板书为主+多媒体辅助" class="pill-item {{pptData.presentationMode=='板书为主+多媒体辅助'?'active':''}}" style="padding: 16rpx 24rpx; border-radius: 32rpx; background: {{pptData.presentationMode=='板书为主+多媒体辅助'?'#7c3aed':'#f3f4f6'}}; color: {{pptData.presentationMode=='板书为主+多媒体辅助'?'#fff':'#374151'}}; font-size: 26rpx;">板书为主</view>
                 <view bindtap="{{handlePPTPresentation}}" data-val="纯板书设计" class="pill-item {{pptData.presentationMode=='纯板书设计'?'active':''}}" style="padding: 16rpx 24rpx; border-radius: 32rpx; background: {{pptData.presentationMode=='纯板书设计'?'#7c3aed':'#f3f4f6'}}; color: {{pptData.presentationMode=='纯板书设计'?'#fff':'#374151'}}; font-size: 26rpx;">纯板书</view>
             </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">风格</text>
             <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; flex-wrap: wrap; margin-top: 16rpx;">
                 <view bindtap="{{handlePPTStyle}}" data-val="简洁大方" class="pill-item {{pptData.style=='简洁大方'?'active':''}}" style="padding: 16rpx 24rpx; border-radius: 32rpx; background: {{pptData.style=='简洁大方'?'#7c3aed':'#f3f4f6'}}; color: {{pptData.style=='简洁大方'?'#fff':'#374151'}}; font-size: 26rpx;">简洁大方</view>
                 <view bindtap="{{handlePPTStyle}}" data-val="活泼生动" class="pill-item {{pptData.style=='活泼生动'?'active':''}}" style="padding: 16rpx 24rpx; border-radius: 32rpx; background: {{pptData.style=='活泼生动'?'#7c3aed':'#f3f4f6'}}; color: {{pptData.style=='活泼生动'?'#fff':'#374151'}}; font-size: 26rpx;">活泼生动</view>
                 <view bindtap="{{handlePPTStyle}}" data-val="学术严谨" class="pill-item {{pptData.style=='学术严谨'?'active':''}}" style="padding: 16rpx 24rpx; border-radius: 32rpx; background: {{pptData.style=='学术严谨'?'#7c3aed':'#f3f4f6'}}; color: {{pptData.style=='学术严谨'?'#fff':'#374151'}}; font-size: 26rpx;">学术严谨</view>
             </view>
        </view>

        <view class="footer-action data-v-6c9a4f44" style="padding: 32rpx;">
            <button class="btn-primary data-v-6c9a4f44" bindtap="{{handlePPTGenerate}}" style="background-color: #7c3aed;">生成课件方案</button>
        </view>
        <view style="height: 120rpx;"></view>
    </scroll-view>
</view>

<!-- Lesson Plan Input -->
<view wx:if="{{LESSON_PLAN_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">教案撰写与完善</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #059669; margin-top: 8rpx; display: block;">规范严谨 | 环节详实 | 重难点突出</text>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">基本信息</text>
             <view class="row-2 data-v-6c9a4f44">
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">学科</text>
                    <input class="input data-v-6c9a4f44" placeholder="学科" value="{{lessonPlanData.subject}}" bindinput="{{onLessonPlanSubject}}"/>
                </view>
                <view class="input-wrap data-v-6c9a4f44">
                    <text class="label data-v-6c9a4f44">年级班级</text>
                    <input class="input data-v-6c9a4f44" placeholder="如: 高一3班" value="{{lessonPlanData.gradeClass}}" bindinput="{{onLessonPlanGradeClass}}"/>
                </view>
             </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">课题名称</text>
                <input class="input data-v-6c9a4f44" placeholder="本课课题" value="{{lessonPlanData.topic}}" bindinput="{{onLessonPlanTopic}}"/>
            </view>
             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                <text class="label data-v-6c9a4f44">教学时长 (分钟)</text>
                <input type="number" class="input data-v-6c9a4f44" placeholder="如: 40" value="{{lessonPlanData.duration}}" bindinput="{{onLessonPlanDuration}}"/>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44">教学设计要点</text>
            <textarea class="textarea data-v-6c9a4f44" style="height: 160rpx;" placeholder="简述本课重点和难点..." value="{{lessonPlanData.designKeyPoints}}" bindinput="{{onLessonPlanPoints}}"/>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">课型 (单选)</text>
             <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; flex-wrap: wrap; margin-top: 16rpx;">
                 <view wx:for="{{['新授课','复习课','练习课','实验课','活动课']}}" wx:key="*this" bindtap="{{onLessonPlanType}}" data-val="{{item}}" class="pill-item {{lessonPlanData.lessonType==item?'active':''}}" style="padding: 16rpx 24rpx; border-radius: 32rpx; background: {{lessonPlanData.lessonType==item?'#059669':'#f3f4f6'}}; color: {{lessonPlanData.lessonType==item?'#fff':'#374151'}}; font-size: 26rpx;">{{item}}</view>
             </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">教案格式</text>
             <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;">
                 <view bindtap="{{onLessonPlanFormat}}" data-val="表格式" class="pill-item {{lessonPlanData.format=='表格式'?'active':''}}" style="padding: 16rpx 24rpx; border-radius: 32rpx; background: {{lessonPlanData.format=='表格式'?'#059669':'#f3f4f6'}}; color: {{lessonPlanData.format=='表格式'?'#fff':'#374151'}}; font-size: 26rpx;">表格式</view>
                 <view bindtap="{{onLessonPlanFormat}}" data-val="文本式" class="pill-item {{lessonPlanData.format=='文本式'?'active':''}}" style="padding: 16rpx 24rpx; border-radius: 32rpx; background: {{lessonPlanData.format=='文本式'?'#059669':'#f3f4f6'}}; color: {{lessonPlanData.format=='文本式'?'#fff':'#374151'}}; font-size: 26rpx;">文本式</view>
             </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">板书输出</text>
             <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;">
                 <view bindtap="{{onLessonPlanBlackboard}}" data-val="板书设计" class="pill-item {{lessonPlanData.blackboard=='板书设计'?'active':''}}" style="padding: 16rpx 24rpx; border-radius: 32rpx; background: {{lessonPlanData.blackboard=='板书设计'?'#059669':'#f3f4f6'}}; color: {{lessonPlanData.blackboard=='板书设计'?'#fff':'#374151'}}; font-size: 26rpx;">板书设计</view>
                 <view bindtap="{{onLessonPlanBlackboard}}" data-val="思维导图" class="pill-item {{lessonPlanData.blackboard=='思维导图'?'active':''}}" style="padding: 16rpx 24rpx; border-radius: 32rpx; background: {{lessonPlanData.blackboard=='思维导图'?'#059669':'#f3f4f6'}}; color: {{lessonPlanData.blackboard=='思维导图'?'#fff':'#374151'}}; font-size: 26rpx;">思维导图</view>
             </view>
        </view>

         <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">作业类型</text>
             <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;">
                 <view bindtap="{{onLessonPlanHomework}}" data-val="作业布置" class="pill-item {{lessonPlanData.homework=='作业布置'?'active':''}}" style="padding: 16rpx 24rpx; border-radius: 32rpx; background: {{lessonPlanData.homework=='作业布置'?'#059669':'#f3f4f6'}}; color: {{lessonPlanData.homework=='作业布置'?'#fff':'#374151'}}; font-size: 26rpx;">作业布置</view>
                 <view bindtap="{{onLessonPlanHomework}}" data-val="拓展活动" class="pill-item {{lessonPlanData.homework=='拓展活动'?'active':''}}" style="padding: 16rpx 24rpx; border-radius: 32rpx; background: {{lessonPlanData.homework=='拓展活动'?'#059669':'#f3f4f6'}}; color: {{lessonPlanData.homework=='拓展活动'?'#fff':'#374151'}}; font-size: 26rpx;">拓展活动</view>
             </view>
        </view>

         <view class="divider-box data-v-6c9a4f44">
             <text class="divider-label data-v-6c9a4f44">语言风格</text>
             <view class="pills-row data-v-6c9a4f44" style="display: flex; gap: 16rpx; margin-top: 16rpx;">
                 <view bindtap="{{onLessonPlanStyle}}" data-val="规范严谨" class="pill-item {{lessonPlanData.style=='规范严谨'?'active':''}}" style="padding: 16rpx 24rpx; border-radius: 32rpx; background: {{lessonPlanData.style=='规范严谨'?'#059669':'#f3f4f6'}}; color: {{lessonPlanData.style=='规范严谨'?'#fff':'#374151'}}; font-size: 26rpx;">规范严谨</view>
                 <view bindtap="{{onLessonPlanStyle}}" data-val="生动活泼" class="pill-item {{lessonPlanData.style=='生动活泼'?'active':''}}" style="padding: 16rpx 24rpx; border-radius: 32rpx; background: {{lessonPlanData.style=='生动活泼'?'#059669':'#f3f4f6'}}; color: {{lessonPlanData.style=='生动活泼'?'#fff':'#374151'}}; font-size: 26rpx;">生动活泼</view>
             </view>
        </view>

        <view class="footer-action data-v-6c9a4f44" style="padding: 32rpx;">
            <button class="btn-primary data-v-6c9a4f44" bindtap="{{handleLessonPlanGenerate}}" style="background-color: #059669;">生成教案</button>
        </view>
        <view style="height: 120rpx;"></view>
    </scroll-view>
</view>

<view wx:if="{{DESIGN_INPUT}}" class="stage-container bg-white data-v-6c9a4f44">
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44">
        <view class="header-section data-v-6c9a4f44" style="padding: 32rpx 32rpx 0;">
            <text class="header-title data-v-6c9a4f44" style="font-size: 40rpx; font-weight: 700; color: #111827; display: block;">教学目标与方法设计</text>
            <text class="header-sub data-v-6c9a4f44" style="font-size: 24rpx; color: #059669; margin-top: 8rpx; display: block;">基于学情 | 目标导向 | 方法匹配</text>
        </view>
        
        <text class="section-title data-v-6c9a4f44" style="color: #059669;">✍️ 输入教学信息</text>
        <view class="form-group data-v-6c9a4f44">
            <view class="input-wrap data-v-6c9a4f44">
                <text class="label data-v-6c9a4f44">基于学情，为【课时名称】设计教学方案</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 勾股定理第一课时" value="{{designData.lessonName}}" bindinput="onDesignNameInput"/>
            </view>
        </view>

        <view class="divider-box data-v-6c9a4f44">
            <text class="divider-label data-v-6c9a4f44" style="color:#059669; background:#ecfdf5;">C (约束)</text>
            
            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 20rpx;">
                <text class="label data-v-6c9a4f44">学情</text>
                <input class="input data-v-6c9a4f44" placeholder="示例: 班级30人，1/3学生基础薄弱" value="{{designData.studentInfo}}" bindinput="onDesignStudentInput"/>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 20rpx;">
                <text class="label data-v-6c9a4f44">课时</text>
                <input class="input data-v-6c9a4f44" placeholder="如: 1课时x45分钟" value="{{designData.lessonHours}}" bindinput="onDesignHoursInput"/>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 24rpx;">
                 <text class="label data-v-6c9a4f44">重难点分析</text>
                 <view class="analysis-card data-v-6c9a4f44" style="background: #f9fafb; border-radius: 16rpx; padding: 24rpx; border: 2rpx solid #f3f4f6;">
                    <view class="card-header data-v-6c9a4f44" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24rpx;">
                        <text class="card-title data-v-6c9a4f44" style="font-size: 28rpx; color: #374151; font-weight: 500;">已完成步骤1分析?</text>
                        <button class="btn-xs-outline data-v-6c9a4f44" style="color: #059669; border-color: #d1fae5; background: #fff; margin: 0; font-size: 24rpx; padding: 8rpx 24rpx; line-height: 1.5;" bindtap="handleViewHistory" data-field="design_kp">🔍 查看步骤1结果</button>
                    </view>
                    <textarea class="textarea data-v-6c9a4f44" style="height: 240rpx; background: #fff; border-color: #e5e7eb; width: 100%; box-sizing: border-box; padding: 20rpx;" placeholder="简述重难点，或点击上方按钮复制步骤1的结果..." value="{{designData.kpContent}}" bindinput="onDesignKpContentInput"/>
                 </view>
            </view>

            <view class="input-wrap data-v-6c9a4f44" style="margin-top: 20rpx;">
                <text class="label data-v-6c9a4f44">教材内容 (可选): 【粘贴课文原文】</text>
                <textarea class="textarea data-v-6c9a4f44" style="height: 160rpx;" placeholder="粘贴教材内容..." value="{{designData.textbookContent}}" bindinput="onDesignTbContentInput"/>
            </view>

             <view class="input-wrap data-v-6c9a4f44" style="margin-top: 20rpx;">
                <text class="label data-v-6c9a4f44">教学条件（单选）</text>
                <view class="pills-column data-v-6c9a4f44" style="display: flex; flex-direction: column; gap: 16rpx; margin-top: 16rpx;">
                    <view class="pill-option data-v-6c9a4f44" bindtap="onDesignConditionSet" data-val="学生能预习+多媒体齐全" style="padding: 24rpx; border-radius: 16rpx; font-size: 26rpx; border: 2rpx solid transparent; {{designData.condition=='学生能预习+多媒体齐全' ? 'background: #ecfdf5; border-color: #059669; color: #047857;' : 'background: #f9fafb; color: #4b5563;'}}">
                        <text class="bold data-v-6c9a4f44">学生能预习+多媒体齐全</text>
                    </view>
                    <view class="pill-option data-v-6c9a4f44" bindtap="onDesignConditionSet" data-val="需督促预习+仅黑板" style="padding: 24rpx; border-radius: 16rpx; font-size: 26rpx; border: 2rpx solid transparent; {{designData.condition=='需督促预习+仅黑板' ? 'background: #ecfdf5; border-color: #059669; color: #047857;' : 'background: #f9fafb; color: #4b5563;'}}">
                        <text class="bold data-v-6c9a4f44">需督促预习+仅黑板</text>
                    </view>
                    <view class="pill-option data-v-6c9a4f44" bindtap="onDesignConditionSet" data-val="基本无预习+基础设备" style="padding: 24rpx; border-radius: 16rpx; font-size: 26rpx; border: 2rpx solid transparent; {{designData.condition=='基本无预习+基础设备' ? 'background: #ecfdf5; border-color: #059669; color: #047857;' : 'background: #f9fafb; color: #4b5563;'}}">
                        <text class="bold data-v-6c9a4f44">基本无预习+基础设备</text>
                    </view>
                </view>
            </view>
        </view>
        <view style="height: 120rpx;"></view>
    </scroll-view>
    <view class="fixed-footer data-v-6c9a4f44">
        <button class="btn-primary data-v-6c9a4f44" style="background-color: #059669;" bindtap="handleDesignGenerate">开始设计教学</button>
    </view>


</view>
            <!-- Analysis History Modal -->
            <view wx:if="{{showAnalysisModal}}" class="modal-backdrop data-v-6c9a4f44" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.5); z-index: 999; display: flex; align-items: center; justify-content: center;">
                <view class="modal-content data-v-6c9a4f44" style="width: 90vw; height: 80vh; background: #fff; border-radius: 24rpx; display: flex; flex-direction: column; overflow: hidden;">
                    <!-- Modal Header -->
                    <view class="modal-header data-v-6c9a4f44" style="padding: 24rpx; border-bottom: 2rpx solid #f3f4f6; display: flex; justify-content: space-between; align-items: center;">
                        <text class="modal-title data-v-6c9a4f44" style="font-size: 32rpx; font-weight: 700; color: #111827;">{{isHistoryMode ? '历史记录' : '步骤1: 内容剖析结果'}}</text>
                        <view style="display: flex; align-items: center;">
                            <text wx:if="{{!isHistoryMode}}" bindtap="{{handleSwitchToHistory}}" style="font-size: 24rpx; color: #059669; background: #ecfdf5; padding: 8rpx 16rpx; border-radius: 8rpx; margin-right: 24rpx;">查看更多历史结果</text>
                             <text bindtap="{{handleCloseModal}}" style="font-size: 40rpx; color: #9ca3af; padding: 0 16rpx;">×</text>
                        </view>
                    </view>

                    <!-- Modal Body -->
                    <scroll-view scroll-y enable-flex class="modal-body data-v-6c9a4f44" style="flex: 1; padding: 24rpx; box-sizing: border-box;">
                        
                        <!-- Specific Result View -->
                        <view wx:if="{{!isHistoryMode}}">
                             <view class="tip-box data-v-6c9a4f44" style="background: #fffbeb; border: 2rpx solid #fcd34d; padding: 16rpx; border-radius: 12rpx; display: flex; align-items: center; margin-bottom: 24rpx;">
                                <text style="font-size: 24rpx; margin-right: 12rpx;">💡</text>
                                <text style="font-size: 24rpx; color: #92400e;">长按文字即可复制，复制后关闭窗口粘贴</text>
                             </view>

                             <view class="result-content data-v-6c9a4f44">
                                <block wx:if="{{modalTriggerField === 'rp_topic'}}">
                                    <text user-select="{{true}}" selectable="{{true}}" style="font-size: 36rpx; font-weight: 700; color: #111827; display: block; margin-bottom: 24rpx;">步骤1: 课题思路生成结果</text>
                                    <view style="background: #f9fafb; padding: 24rpx; border-radius: 16rpx; margin-bottom: 24rpx;">
                                        <view style="margin-bottom: 16rpx;"><text style="color: #6b7280; font-size: 26rpx;">研究主题：</text><text style="color: #111827; font-weight: 600; font-size: 28rpx;">{{rpTopicData.topic || '暂无主题'}}</text></view>
                                        <view style="margin-bottom: 16rpx;"><text style="color: #6b7280; font-size: 26rpx;">学科背景：</text><text style="color: #374151; font-size: 28rpx;">{{rpTopicData.subject || '-'}}</text></view>
                                        <view style="margin-bottom: 16rpx;"><text style="color: #6b7280; font-size: 26rpx;">研究时长：</text><text style="color: #374151; font-size: 28rpx;">{{rpTopicData.duration || '-'}}</text></view>
                                        <view wx:if="{{rpTopicData.angles && rpTopicData.angles.length > 0}}">
                                            <text style="color: #6b7280; font-size: 26rpx; display: block; margin-bottom: 8rpx;">切入角度：</text>
                                            <view style="display: flex; flex-wrap: wrap; gap: 12rpx;">
                                                <view wx:for="{{rpTopicData.angles}}" wx:key="index" style="background: #e0f2fe; color: #0284c7; padding: 4rpx 16rpx; border-radius: 8rpx; font-size: 24rpx;">{{item}}</view>
                                            </view>
                                        </view>
                                    </view>
                                </block>
                                <block wx:else>
                                    <text user-select="{{true}}" selectable="{{true}}" style="font-size: 36rpx; font-weight: 700; color: #111827; display: block; margin-bottom: 24rpx;">1 - 微积分 教学内容深度剖析</text>
                                
                                <view style="margin-bottom: 24rpx;">
                                    <text style="display: inline-block; background: #ecfdf5; color: #059669; padding: 4rpx 12rpx; border-radius: 8rpx; font-size: 24rpx; font-weight: 700; margin-right: 12rpx;">1</text>
                                    <text style="font-size: 30rpx; font-weight: 700; color: #374151;">核心概念与原理</text>
                                </view>
                                <text user-select="{{true}}" selectable="{{true}}" style="font-size: 28rpx; color: #4b5563; line-height: 1.6; display: block; margin-bottom: 24rpx;">本节课的核心在于建立"集合"这一数学语言基础，它是现代数学的基石。\n\n• 集合的确定性：给定一个集合，任给一个元素，该元素属于或者不属于该集合，二者必居其一。\n• 集合的互异性：一个给定的集合中的元素是互不相同的。\n• 集合的无序性：集合中的元素是平等的，没有先后顺序。</text>

                                 <view style="margin-bottom: 24rpx;">
                                    <text style="display: inline-block; background: #ecfdf5; color: #059669; padding: 4rpx 12rpx; border-radius: 8rpx; font-size: 24rpx; font-weight: 700; margin-right: 12rpx;">2</text>
                                    <text style="font-size: 30rpx; font-weight: 700; color: #1f2937; margin-bottom: 12rpx; display: block;">2 重点难点突破策略</text>
                                    <view class="highlight-box data-v-6c9a4f44" style="background: #f9fafb; padding: 24rpx; border-left: 8rpx solid #6b7280; border-radius: 8rpx;">
                                        <text style="font-weight: 700; color: #374151;">重点：</text><text style="color: #4b5563;">集合的三大特性。</text>
                                        <text style="display: block; margin-top: 8rpx; color: #6b7280; font-size: 26rpx;">突破策略：通过反例（如“班上的好学生”）来强调确定性。</text>
                                    </view>
                                    <view class="highlight-box data-v-6c9a4f44" style="background: #f9fafb; padding: 24rpx; border-left: 8rpx solid #6b7280; border-radius: 8rpx; margin-top: 16rpx;">
                                        <text style="font-weight: 700; color: #374151;">难点：</text><text style="color: #4b5563;">用集合语言描述数学对象。</text>
                                    </view>
                                </view>
                                </block>
                            </view>
                        </view>

                        <!-- History List View -->
                        <view wx:if="{{isHistoryMode}}">
                             <block wx:for="{{analysisHistory}}" wx:key="id">
                                <view bindtap="{{handleSelectHistoryItem}}" data-id="{{item.id}}" class="history-card data-v-6c9a4f44" style="padding: 24rpx; border-radius: 16rpx; border: 2rpx solid {{item.isCurrent ? '#059669' : '#e5e7eb'}}; background: {{item.isCurrent ? '#ecfdf5' : '#fff'}}; margin-bottom: 20rpx; position: relative; overflow: hidden;">
                                    <view style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12rpx;">
                                        <text style="font-size: 30rpx; font-weight: 700; color: #111827;">{{item.title}}</text>
                                        <text wx:if="{{item.isCurrent}}" style="font-size: 20rpx; color: #fff; background: #059669; padding: 4rpx 12rpx; border-radius: 20rpx;">当前展示</text>
                                         <text wx:else style="color: #9ca3af;">></text>
                                    </view>
                                    <text style="font-size: 24rpx; color: #6b7280;">{{item.date}}</text>
                                </view>
                             </block>
                        </view>
                    </scroll-view>

                     <!-- Modal Footer (Only for Result View) -->
                     <view wx:if="{{!isHistoryMode}}" style="padding: 24rpx; border-top: 2rpx solid #f3f4f6; background: #fff;">
                         <button style="width: 100%; background: #059669; color: #fff; border-radius: 40rpx; font-weight: 600;" bindtap="{{handleCloseModal}}">开始运用此文案</button>
                     </view>
                </view>
            </view>
</view>




<!-- LOADING PAGE -->
<view wx:if="{{LOADING_PAGE}}" class="stage-container bg-white data-v-6c9a4f44" style="position: fixed; top: 0; left: 0; width: 100%; height: 100vh; background: #fff; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 9999;">
    <view class="loading-spinner data-v-6c9a4f44" style="width: 80rpx; height: 80rpx; border: 8rpx solid #f3f4f6; border-top: 8rpx solid #0d9488; border-radius: 50%; animation: spin 1s linear infinite;"></view>
    <text style="margin-top: 32rpx; color: #374151; font-size: 32rpx; font-weight: 500;">AI正在生成中...</text>
</view>

<!-- RESULT PAGE -->
<view wx:if="{{RESULT_PAGE}}" class="stage-container bg-white data-v-6c9a4f44" style="position: fixed; top: 0; left: 0; width: 100%; height: 100vh; z-index: 50; display: flex; flex-direction: column; overflow: hidden; background: #fff;">
    <!-- Header -->
    <view class="nav-bar-custom data-v-6c9a4f44" style="padding: 24rpx 32rpx; background: #fff; display: flex; justify-content: space-between; align-items: center; border-bottom: 2rpx solid #f3f4f6;">
        <view class="row-center data-v-6c9a4f44">
             <text class="header-title data-v-6c9a4f44" style="font-size: 34rpx; font-weight: 700; color: #111827;">{{res_title}}</text>
        </view>
        <view class="actions data-v-6c9a4f44" style="display: flex; gap: 32rpx;">
             <!-- Copy Button Removed as per request (feature is now Native Copy in Textarea) -->
             <view bindtap="{{res_export}}"><text style="font-size: 40rpx; color: #6b7280;">⬇️</text></view>
        </view>
    </view>

    <!-- Content Area (Editable) -->
    <scroll-view scroll-y enable-flex class="scroll-area data-v-6c9a4f44" style="flex: 1; height: 0; padding: 32rpx; padding-bottom: 180rpx; flex-direction: column;">
        <text style="font-size: 20rpx; color: #ccc;">Status: {{res_debug}}</text>
        <view class="editable-container" style="width: 100%; min-height: 50vh;">
            <textarea 
                value="{{res_content}}" 
                bindinput="{{onContentChange}}" 
                maxlength="-1" 
                auto-height="{{true}}" 
                placeholder="AI生成内容..." 
                style="width: 100%; font-size: 30rpx; color: #374151; line-height: 1.6; min-height: 400rpx;"
            />
        </view>
    </scroll-view>

    <!-- Footer Actions -->
    <view class="data-v-6c9a4f44" style="background: #fff; padding: 24rpx; border-top: 2rpx solid #f3f4f6; display: block; padding-bottom: calc(24rpx + env(safe-area-inset-bottom));">
         <!-- Quick Tweaks Row -->
         <scroll-view scroll-x style="white-space: nowrap; margin-bottom: 24rpx; display: flex;">
            <view bindtap="{{res_tweak}}" data-val="detailed" style="display: inline-block; padding: 12rpx 32rpx; background: #f3f4f6; border-radius: 32rpx; margin-right: 16rpx; font-size: 26rpx; color: #4b5563;">内容更详细</view>
            <view bindtap="{{res_tweak}}" data-val="concise" style="display: inline-block; padding: 12rpx 32rpx; background: #f3f4f6; border-radius: 32rpx; margin-right: 16rpx; font-size: 26rpx; color: #4b5563;">语言更精炼</view>
            <view bindtap="{{res_tweak}}" data-val="academic" style="display: inline-block; padding: 12rpx 32rpx; background: #f3f4f6; border-radius: 32rpx; margin-right: 16rpx; font-size: 26rpx; color: #4b5563;">突出核心观点</view>
            <view bindtap="{{res_tweak}}" data-val="examples" style="display: inline-block; padding: 12rpx 32rpx; background: #f3f4f6; border-radius: 32rpx; margin-right: 16rpx; font-size: 26rpx; color: #4b5563;">增加生活案例</view>
         </scroll-view>
         
         <!-- Input Row -->
         <view style="display: flex; gap: 16rpx;">
            <input placeholder="对结果不满意？输入修改要求..." value="{{refineQuery}}" bindinput="{{onRefineInput}}" style="flex: 1; background: #f9fafb; padding: 20rpx; border-radius: 16rpx; font-size: 28rpx;"/>
            <button bindtap="{{res_rewrite}}" style="background: #86efac; color: #fff; width: 160rpx; font-size: 28rpx; display: flex; align-items: center; justify-content: center; border-radius: 16rpx;">✨ 改写</button>
         </view>
    </view>
</view>
</view>


